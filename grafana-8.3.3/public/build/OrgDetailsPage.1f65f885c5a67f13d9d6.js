"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[529],{"./public/app/core/components/SharedPreferences/SharedPreferences.tsx":(e,a,t)=>{t.d(a,{v:()=>m,Z:()=>g});var r,n,s=t("../../opt/drone/yarncache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),i=t("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/3/opt/drone/yarncache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),o=t("./packages/grafana-ui/src/index.ts"),d=t("./packages/grafana-e2e-selectors/src/index.ts"),c=t("./public/app/core/services/backend_srv.ts"),l=t("./public/app/core/services/PreferencesService.ts"),h=t("../../opt/drone/yarncache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");function p(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}const u=[{value:"",label:"Default"},{value:"dark",label:"Dark"},{value:"light",label:"Light"}];class m extends s.PureComponent{constructor(e){super(e),p(this,"service",void 0),p(this,"onSubmitForm",(async()=>{const{homeDashboardId:e,theme:a,timezone:t,weekStart:r}=this.state;await this.service.update({homeDashboardId:e,theme:a,timezone:t,weekStart:r}),window.location.reload()})),p(this,"onThemeChanged",(e=>{this.setState({theme:e})})),p(this,"onTimeZoneChanged",(e=>{e&&this.setState({timezone:e})})),p(this,"onWeekStartChanged",(e=>{this.setState({weekStart:e})})),p(this,"onHomeDashboardChanged",(e=>{this.setState({homeDashboardId:e})})),p(this,"getFullDashName",(e=>void 0===e.folderTitle||""===e.folderTitle?e.title:e.folderTitle+" / "+e.title)),this.service=new l.y(e.resourceUri),this.state={homeDashboardId:0,theme:"",timezone:"",weekStart:"",dashboards:[]}}async componentDidMount(){const e=await this.service.load(),a=await c.ae.search({starred:!0});if(e.homeDashboardId>0&&!a.find((a=>a.id===e.homeDashboardId))){const t=await c.ae.search({dashboardIds:[e.homeDashboardId]});t&&t.length>0&&a.push(t[0])}this.setState({homeDashboardId:e.homeDashboardId,theme:e.theme,timezone:e.timezone,weekStart:e.weekStart,dashboards:[{id:0,title:"Default",tags:[],type:"",uid:"",uri:"",url:"",folderId:0,folderTitle:"",folderUid:"",folderUrl:"",isStarred:!1,slug:"",items:[]},...a]})}render(){const{theme:e,timezone:a,weekStart:t,homeDashboardId:s,dashboards:i}=this.state,{disabled:c}=this.props,l=b();return(0,h.jsx)(o.Form,{onSubmit:this.onSubmitForm,children:()=>{var p;return(0,h.jsxs)(o.FieldSet,{label:"Preferences",disabled:c,children:[(0,h.jsx)(o.Field,{label:"UI Theme",children:(0,h.jsx)(o.RadioButtonGroup,{options:u,value:null===(p=u.find((a=>a.value===e)))||void 0===p?void 0:p.value,onChange:this.onThemeChanged})}),(0,h.jsx)(o.Field,{label:(0,h.jsxs)(o.Label,{htmlFor:"home-dashboard-select",children:[(0,h.jsx)("span",{className:l.labelText,children:"Home Dashboard"}),r||(r=(0,h.jsx)(o.Tooltip,{content:"Not finding the dashboard you want? Star it first, then it should appear in this select box.",children:(0,h.jsx)(o.Icon,{name:"info-circle"})}))]}),"data-testid":"User preferences home dashboard drop down",children:(0,h.jsx)(o.Select,{menuShouldPortal:!0,value:i.find((e=>e.id===s)),getOptionValue:e=>e.id,getOptionLabel:this.getFullDashName,onChange:e=>this.onHomeDashboardChanged(e.id),options:i,placeholder:"Choose default dashboard",inputId:"home-dashboard-select"})}),(0,h.jsx)(o.Field,{label:"Timezone","data-testid":d.wl.components.TimeZonePicker.containerV2,children:(0,h.jsx)(o.TimeZonePicker,{includeInternal:!0,value:a,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})}),(0,h.jsx)(o.Field,{label:"Week start","data-testid":d.wl.components.WeekStartPicker.containerV2,children:(0,h.jsx)(o.WeekStartPicker,{value:t,onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})}),n||(n=(0,h.jsx)("div",{className:"gf-form-button-row",children:(0,h.jsx)(o.Button,{variant:"primary","aria-label":"User preferences save button",children:"Save"})}))]})}})}}const g=m,b=(0,o.stylesFactory)((()=>({labelText:i.css`
      margin-right: 6px;
    `})))},"./public/app/features/org/OrgDetailsPage.tsx":(e,a,t)=>{t.r(a),t.d(a,{OrgDetailsPage:()=>x,default:()=>S});var r,n=t("../../opt/drone/yarncache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),s=t("./.yarn/__virtual__/react-redux-virtual-8e30c710ae/3/opt/drone/yarncache/react-redux-npm-7.2.5-cf7e365145-04ac4a4178.zip/node_modules/react-redux/es/index.js"),i=t("./public/app/core/components/Page/Page.tsx"),o=t("./packages/grafana-ui/src/index.ts"),d=t("./public/app/core/core.ts"),c=t("./public/app/types/index.ts"),l=t("../../opt/drone/yarncache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");const h=({onSubmit:e,orgName:a})=>{const t=d.Vt.hasPermission(c.bW.OrgsWrite);return(0,l.jsx)(o.Form,{defaultValues:{orgName:a},onSubmit:({orgName:a})=>e(a),children:({register:e})=>(0,l.jsxs)(o.FieldSet,{label:"Organization profile",disabled:!t,children:[(0,l.jsx)(o.Field,{label:"Organization name",children:(0,l.jsx)(o.Input,Object.assign({id:"org-name-input",type:"text"},e("orgName",{required:!0})))}),r||(r=(0,l.jsx)(o.Button,{type:"submit",children:"Update organization name"}))]})})};var p=t("./public/app/core/components/SharedPreferences/SharedPreferences.tsx"),u=t("./packages/grafana-runtime/src/index.ts"),m=t("./public/app/features/org/state/reducers.ts"),g=t("./public/app/core/actions/index.ts");function b(e={getBackendSrv:u.getBackendSrv}){return async a=>{const t=await e.getBackendSrv().get("/api/org");return a((0,m.jR)(t)),t}}var f=t("./public/app/core/selectors/navModel.ts");class x extends n.PureComponent{constructor(...e){var a,t,r;super(...e),r=e=>{this.props.setOrganizationName(e),this.props.updateOrganization()},(t="onUpdateOrganization")in(a=this)?Object.defineProperty(a,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[t]=r}async componentDidMount(){await this.props.loadOrganization()}render(){const{navModel:e,organization:a}=this.props,t=0===Object.keys(a).length,r=d.Vt.hasPermission(c.bW.OrgsRead),n=d.Vt.hasPermission(c.bW.OrgsPreferencesRead),s=d.Vt.hasPermission(c.bW.OrgsPreferencesWrite);return(0,l.jsx)(i.Z,{navModel:e,children:(0,l.jsx)(i.Z.Contents,{isLoading:t,children:!t&&(0,l.jsxs)(o.VerticalGroup,{spacing:"lg",children:[r&&(0,l.jsx)(h,{onSubmit:this.onUpdateOrganization,orgName:a.name}),n&&(0,l.jsx)(p.Z,{resourceUri:"org",disabled:!s})]})})})}}const v={loadOrganization:b,setOrganizationName:m.xR,updateOrganization:function(e={getBackendSrv:u.getBackendSrv}){return async(a,t)=>{const r=t().organization.organization;await e.getBackendSrv().put("/api/org",{name:r.name}),a((0,g.H7)(r.name)),a(b(e))}}},S=(0,s.connect)((function(e){return{navModel:(0,f.h)(e.navIndex,"org-settings"),organization:e.organization.organization}}),v)(x)}}]);
//# sourceMappingURL=OrgDetailsPage.1f65f885c5a67f13d9d6.js.map