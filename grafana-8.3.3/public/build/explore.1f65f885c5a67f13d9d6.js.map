{"version":3,"file":"explore.1f65f885c5a67f13d9d6.js","mappings":"4uDAcA,QAbkB,SAAUA,EAAUC,GAClC,IAAIC,GAAgB,IAAAC,SAAO,gBAC3B,IAAAC,YAAU,WACNF,EAAcG,QAAUL,MAE5B,IAAAI,YAAU,WACN,GAAc,OAAVH,EAAgB,CAChB,IAAIK,EAAaC,aAAY,WAAc,OAAOL,EAAcG,YAAcJ,GAAS,GACvF,OAAO,WAAc,OAAOO,cAAcF,OAG/C,CAACL,K,kHCHD,MAAMQ,EAAsB,EAAGC,SAAAA,EAAUC,UAAAA,EAAWC,SAAAA,MAClD,iBAAMD,UAAY,gBAAeA,IAAjC,SAA+CE,EAAWH,EAAUE,KAGvEC,EAAa,CAACH,EAAkBE,GAAW,KAC/C,MAAME,EAAYJ,EAAW,IAE7B,IAAKE,EACH,MAAQ,GAAEE,EAAUC,QAAQ,MAG9B,MAAMC,GAAWC,EAAAA,EAAAA,YAAWH,EAAW,WACjCI,EAAQF,EAASE,QACjBC,EAAUH,EAASG,UACnBC,EAAUJ,EAASI,UAEzB,OAAIF,EACM,GAAEA,MAAUC,MAAYC,KAG9BD,EACM,GAAEA,MAAYC,KAGhB,GAAEA,MCrBCC,EAAoC,EAAGC,SAAAA,EAAUV,SAAAA,EAAUD,UAAAA,MACtE,MAAOY,EAASC,IAAcC,EAAAA,EAAAA,UAAS,GAOvC,OAJAC,GAAY,IAAMF,EAAWD,EAZd,YAcfnB,EAAAA,EAAAA,YAAU,IAAMoB,EAAW,IAAI,CAACF,KAEzB,SAACb,EAAD,CAAMC,SAAUa,EAASZ,UAAWA,EAAWC,SAAUA,K,8HC2ClE,MAAMe,UAAiBC,EAAAA,cAIrBC,YAAYC,GACVC,MAAMD,GADkB,oBAHkB,MAGlB,4BAFGE,EAAAA,aAEH,mBAyBdC,IACV,MAAM,SAAEC,EAAF,QAAYC,GAAYC,KAAKN,OAC7B,UAAEO,EAAF,aAAaC,EAAb,aAA2BC,GAAiBN,EAAMO,cAC7BD,GAAgBF,EAAYC,IAC7B,IAAMJ,GAC9BC,OA9BsB,uBAkCX,KACb,MAAM,SAAED,GAAaE,KAAKN,MAC1B,IAAMW,gBAAiBC,EAAe,IAAON,KAAKO,MAKlD,OAJKT,IAEHQ,EAAeA,EAAaE,OAAO,MAE9BF,KAvCPN,KAAKO,MAAQ,CACXF,gBAAiBX,EAAMe,SAII,gCAACC,EAAkBH,GAChD,OAAKG,EAAUZ,SAQN,KAPA,CAILO,gBAAiBK,EAAUD,SA+BjCE,SACE,MAAM,MAAEC,EAAF,SAASC,EAAT,QAAmBd,EAAnB,SAA4Be,EAA5B,SAAsChB,GAAaE,KAAKN,MACxDqB,EAxGSH,CAAAA,IAAD,CAChBI,aAAcC,EAAAA,GAAI;;mBAEDL,EAAMM,WAAWC;iBACnBP,EAAMM,WAAWE,UAAUC;;;;;;;;IAS1CC,YAAaL,EAAAA,GAAI;;aAENL,EAAMW,OAAOC;wBACFC,GAAAA,CAAUb,EAAMW,OAAOG,KAAKC,aAAaC,SAAS,KAAMC;;;;4BAIpDJ,GAAAA,CAAUb,EAAMW,OAAOG,KAAKC,aAAaC,SAAS,KAAMC;;;;;;IAOlFC,kBAAmBb,EAAAA,GAAI;iBACRL,EAAMM,WAAWa,GAAGV;mBAClBT,EAAMoB,QAAQ;;;IAI/BC,OAAQhB,EAAAA,GAAI;oBACML,EAAMoB,QAAQ;IAEhCE,UAAWjB,EAAAA,GAAI;;MAoEEkB,CAAUvB,IACnB,QAAEwB,EAAF,iBAAWC,EAAX,eAA6BC,IAAmBC,EAAAA,EAAAA,iBAAgB3B,GAEtE,OACE,4BACE,kBAAOrC,UAAWwC,EAAOmB,UAAzB,UACE,mBACEM,SAAU1C,OAAW2C,EAAYzC,KAAKwC,SACtCjE,WAAWmE,EAAAA,EAAAA,IAAG,CAAC,YAAa3B,EAAOC,eACnC2B,IAAK3C,KAAK4C,mBAHZ,UAKG5C,KAAKM,eAAeuC,KAAKC,IAEtB,gBAAIvE,WAAWmE,EAAAA,EAAAA,IAAGN,EAASrB,EAAOO,aAAlC,WACE,eAAI/C,WAAWmE,EAAAA,EAAAA,IAAGL,GAAlB,UAAsCU,EAAAA,EAAAA,gBAAeD,EAAIE,YAAa,CAAEnC,SAAAA,OACxE,eAAItC,WAAWmE,EAAAA,EAAAA,IAAGJ,GAAlB,SAAoCQ,EAAIG,SAAU,SAAC,EAAAC,eAAD,CAAgBC,MAAOL,EAAIM,MAAUN,EAAIO,UAFxCP,EAAIQ,QAM7D,eACEX,IAAMY,IAI8B,OAHlCvD,KAAKwD,WAAaD,EAGdvD,KAAKwD,aAAe1D,KACtB,UAAAE,KAAK4C,mBAAmB3E,eAAxB,SAAiCwF,SAAS,EAAGzD,KAAK4C,mBAAmB3E,QAAQkC,wBAMvF,iBAAK5B,UAAWwC,EAAOe,kBAAvB,WACE,UAAC,EAAA4B,OAAD,CAAQC,QAAQ,YAAYC,QAAS9D,EAAWgB,EAAWf,EAASxB,UAAWwC,EAAOkB,OAAtF,WACE,SAAC,EAAA4B,KAAD,CAAMC,KAAMhE,EAAW,OAAS,UADlC,IAGGA,EAAW,SAAW,YAEzB,UAAC,EAAA4D,OAAD,CAAQC,QAAQ,YAAYC,QAAS5D,KAAKN,MAAMqE,SAAUxF,UAAWwC,EAAOkB,OAA5E,iBACE,SAAC,EAAA4B,KAAD,CAAMC,KAAK,eAAeE,KAAK,KAAKC,KAAK,UAD3C,sBAICnE,IACC,oDACsB,SAACb,EAAD,CAAaC,SAAUc,KAAKN,MAAMe,QAASjC,UAAU,IAD3E,iBAUL,MAAM0F,GAAoBC,EAAAA,EAAAA,YAAW5E,G,wQChK5C,MAAM4C,EAAavB,IAAD,CAChBwD,cAAenD,EAAAA,GAAI;;aAERL,EAAMW,OAAOC,KAAK6C;qBACVzD,EAAMoB,QAAQ;;;;IAKjCsC,SAAUrD,EAAAA,GAAI;oBACIL,EAAMoB,QAAQ;kBAChBpB,EAAMoB,QAAQ;;;;;eAKjBpB,EAAMW,OAAOgD,MAAM/C;;IAGhCgD,UAAWvD,EAAAA,GAAI;yBACQL,EAAMoB,QAAQ;iBACtBpB,EAAMM,WAAWE,UAAUC;mBACzBT,EAAMM,WAAWuD;IAElCC,UAAWzD,EAAAA,GAAI;mBACEL,EAAMM,WAAWC;iBACnBP,EAAMM,WAAWE,UAAUC;MAStCsD,GAAeC,EAAAA,EAAAA,OAAK,SAAsBlF,GAC9C,MAAMmF,GAAQC,EAAAA,EAAAA,YAAW3C,IACnB,MAAE4C,EAAF,MAAS5B,GAAUzD,EAEzB,OACE,iBAAKnB,UAAWsG,EAAMP,SAAtB,UACGS,IAAS,kBAAMxG,UAAWsG,EAAML,UAAvB,UAAmCO,EAAnC,QACV,iBAAMxG,UAAWsG,EAAMH,UAAvB,SAAmCvB,UAS5B6B,GAAeJ,EAAAA,EAAAA,OAAK,SAAsBlF,GACrD,MAAMmF,GAAQC,EAAAA,EAAAA,YAAW3C,IACnB,UAAE8C,GAAcvF,EAEtB,OACE,gBAAKnB,UAAWsG,EAAMT,cAAtB,SACGa,EAAUpC,KAAI,CAACqC,EAAMC,KACpB,SAACR,EAAD,CAA6CI,MAAOG,EAAKH,MAAO5B,MAAO+B,EAAK/B,OAAxD,GAAEgC,KAASD,EAAKH,gB,MC7CrC,MAAMK,EAA+BxF,EAAAA,MAC1C,EACEyF,KAAAA,EACAC,cAAAA,EACAC,WAAAA,EACAC,mBAAAA,EACAC,oBAAAA,EACAC,oBAAAA,EACAC,YAAAA,EACAC,iBAAAA,EACAnF,QAAAA,MAEA,MAAMoF,EAAoD,IAAIR,GAuD9D,OApDIC,IAAkBQ,EAAAA,kBAAAA,MACpBD,EAAaE,KAAK,CAChBhB,MAAO,cACP5B,MAAOoC,EACPS,KAAMC,EAAAA,aAAAA,SAINxF,EAAQyF,MAAMC,GAAMA,EAAE9C,MAAM+C,OAASC,EAAAA,KACvCR,EAAaE,KAAK,CAChBhB,MAAO,OACP5B,MAAO,6EACP6C,KAAMC,EAAAA,aAAAA,UAKNT,MAAAA,OAAA,EAAAA,EAAoBY,QAAS,GAC/BP,EAAaE,KACX,CACEhB,MAAO,+BACP5B,MAAOmD,EAAed,EAAoBS,EAAAA,aAAAA,YAE5C,CACElB,MAAO,GACP5B,OACE,SAAC,EAAAO,OAAD,CAAQC,QAAQ,YAAYK,KAAK,KAAKJ,QAAS6B,EAA/C,wCASJC,GACFG,EAAaE,KAAK,CAChBhB,MAAO,mDACP5B,OACE,SAAC,EAAAoD,QAAD,CACEC,QAAQ,4IACRC,UAAU,QAFZ,UAIE,UAAC,EAAA/C,OAAD,CAAQC,QAAQ,YAAYK,KAAK,KAAKJ,QAASgC,EAA/C,WACE,4BAAOD,EAAc,kBAAoB,kBAAzC,OADF,OAEE,SAAC,EAAA9B,KAAD,CAAMC,KAAK,uBAAuBvF,UAAU,QAAQyF,KAAK,gBAQjE,8BACG6B,IACC,SAACb,EAAD,CACEC,UAAWY,EAAahD,KAAKqC,IACpB,CACLH,MAAOG,EAAKH,MACZ5B,MAAO,SAAU+B,EAAOoB,EAAepB,EAAK/B,MAAO+B,EAAKc,MAAQd,EAAK/B,iBAYrF,SAASmD,EAAenD,EAAY6C,GAClC,OAAIA,IAASC,EAAAA,aAAAA,WAET,iBAAM1H,UAAU,yBAAhB,UACE,SAAC,EAAAmI,UAAD,CAAWC,OAAQxD,MAGd6C,IAASC,EAAAA,aAAAA,OACX,iBAAM1H,UAAU,wBAAhB,SAAyC4E,IAE3CA,E,MCnGF,SAASyD,GAAoB,MAClCC,EADkC,iBAElCC,EAFkC,gBAGlCC,EAHkC,SAIlClG,EAJkC,QAKlCmG,EALkC,WAMlCC,IAEA,MAAMxI,EAAcyI,GACV,IAAEnE,EAAAA,EAAAA,gBAAemE,EAAM,CAC7BC,OAAQC,EAAAA,kBAAAA,SAAAA,OACRvG,SAAUA,MAIRwG,EAAoB,CAACC,EAAgBnC,KACzC,GAAI2B,IAAqB3B,GAAS6B,EAChC,cAAO,SAAC,EAAAO,QAAD,KAIT,MAAQ,GAFW9I,EAAWsI,EAAkBO,EAAKE,UAAUC,KAAOH,EAAKE,UAAUE,SAC/DjJ,EAAWsI,EAAkBO,EAAKE,UAAUE,GAAKJ,EAAKE,UAAUC,SAIlF7G,GAAQ+G,EAAAA,EAAAA,aACR5G,EAASoB,EAAUvB,EAAOoG,GAEhC,OACE,SAAC,EAAAY,gBAAD,CAAiBC,UAAQ,EAAzB,UACE,gBAAKtJ,UAAWwC,EAAO+G,aAAc,cAAY,sBAAjD,UACE,gBAAKvJ,UAAWwC,EAAOgH,eAAvB,SACGlB,EAAMhE,KAAI,CAACyE,EAAgBnC,KAC1B,iBACE,cAAc,OAAMA,EAAQ,IAC5B5G,UAAWwC,EAAOuG,KAElB1D,QAAS,KAAOoD,GAAWC,EAAW,CAAEQ,KAAMH,EAAKU,WAAWP,KAAMC,GAAIJ,EAAKU,WAAWN,KAJ1F,WAME,gBAAKnJ,WAAWmE,EAAAA,EAAAA,IAAG3B,EAAOkH,KAAM,CAAEC,WAAYpB,IAAqB3B,OACnE,gBAAK5G,WAAWmE,EAAAA,EAAAA,IAAG3B,EAAOmG,KAAM,CAAEiB,aAAcrB,IAAqB3B,IAArE,SACGkC,EAAkBC,EAAMnC,OALtBmC,EAAKU,WAAWN,YDoDnCtC,EAAYgD,YAAc,cCrC1B,MAAMjG,EAAY,CAACvB,EAAsBoG,KAChC,CACLc,aAAc7G,EAAAA,GAAI;;sBAEAL,EAAMoB,QAAQ;;;;;;;;;YASxBpB,EAAMW,OAAO8G,WAAWC;YACxB1H,EAAMW,OAAO8G,WAAWC;YACxB1H,EAAMW,OAAO8G,WAAWhE;YACxBzD,EAAMW,OAAO8G,WAAWhE;;;;;;MAOhC0D,eAAgB9G,EAAAA,GAAI;;;;MAKpBqG,KAAMrG,EAAAA,GAAI;;gBAEEL,EAAMoB,QAAQ;gBACdgF,EAAU,OAAS;;;sBAGbpG,EAAMW,OAAO+G,QAAQC;;;iBAG1B3H,EAAMW,OAAO+G,QAAQC;;MAGlCN,KAAMhH,EAAAA,GAAI;;;;oBAIML,EAAMW,OAAOC,KAAK6C;MAElC6C,KAAMjG,EAAAA,GAAI;;;mBAGKL,EAAM4H,GAAGtH,WAAW8C,KAAKyE;sBACtB7H,EAAMoB,QAAQ;;;kBC1FpC,SAAS0G,GAAe,cACtBC,EADsB,cAEtBC,EAFsB,SAGtB/H,EAHsB,QAItBmG,EAJsB,aAKtB6B,EALsB,gBAMtBC,EANsB,aAOtBC,EAPsB,QAQtBC,EARsB,WAStBC,EATsB,kBAUtBC,IAEA,MAAOrC,EAAOsC,IAAY9J,EAAAA,EAAAA,UAAqB,KACxCyH,EAAkBsC,IAAuB/J,EAAAA,EAAAA,UAAS,GAGnDgK,GAAqBtL,EAAAA,EAAAA,UACrBuL,GAAmBvL,EAAAA,EAAAA,UAGnBwL,GAAexL,EAAAA,EAAAA,QAAO,GAEtBgJ,EAAkB6B,IAAkBY,EAAAA,cAAAA,UACpCC,EAAc1C,EAAkBD,IAAqBD,EAAMT,OAAS,EAAyB,IAArBU,EACxE4C,EAAa3C,EAAuC,IAArBD,EAAyBA,IAAqBD,EAAMT,OAAS,EAC5FxF,GAAQ+G,EAAAA,EAAAA,aACR5G,EAASoB,EAAUvB,EAAOmG,EAAiBC,IAGjDhJ,EAAAA,EAAAA,YAAU,KACR,MAAM2L,EAAU,CAAEnC,UAAWuB,EAAcf,WAAYW,GACvD,IAAIiB,EAAuB,GAE3B,IAAKC,EAAAA,EAAAA,SAAQP,EAAiBrL,QAAS0K,KAAmBkB,EAAAA,EAAAA,SAAQR,EAAmBpL,QAAS+K,GAMvF,CACLG,GAAUtC,IAER+C,EAAW/C,EAAMiD,QAAQxC,KAAUuC,EAAAA,EAAAA,SAAQF,EAAQ3B,WAAYV,EAAKU,cAEpE4B,EAAW,IAAIA,EAAUD,GAASI,MAAK,CAACC,EAAGC,IAAMC,EAAUF,EAAGC,EAAGrB,KAG1DgB,KAIT,MAAMzE,EAAQyE,EAASO,WAAW7C,GAASA,EAAKU,WAAWN,KAAOiB,EAAcjB,KAChF0B,EAAoBjE,QAlBpB8D,IACAE,EAAS,CAACQ,IACVP,EAAoB,GACpBC,EAAmBpL,QAAU+K,EAC7BO,EAAatL,QAAU0K,EAAcjB,GAAKiB,EAAclB,KAgB1DyB,MACC,CAACH,EAAcJ,EAAeC,EAAeI,EAASC,EAAYC,KAErElL,EAAAA,EAAAA,YAAU,IACD,IAAMiL,KAGZ,IAEH,MAAMhC,EAAa,EAAGQ,KAAAA,EAAMC,GAAAA,MAC1B4B,EAAiBrL,QAAU,CAAEwJ,KAAAA,EAAMC,GAAAA,GACnCmB,EAAa,CAAEpB,KAAAA,EAAMC,GAAAA,KAGjBwC,EAAY,CAACF,EAAaC,EAAarB,IACvCA,IAAkBY,EAAAA,cAAAA,UACbQ,EAAEhC,WAAWN,GAAKuC,EAAEjC,WAAWN,GAAK,GAAK,EAE3CsC,EAAEhC,WAAWN,GAAKuC,EAAEjC,WAAWN,IAAM,EAAI,EAG5C0C,GACJ,SAAC,EAAA1G,OAAD,CACE,cAAY,kBACZnF,UAAWwC,EAAOsJ,UAClB1G,QAAQ,YACRC,QAAS,KAEP,GAAK8F,EAQHzC,EAAW,CAAEQ,KAAMsB,EAAatB,KAAO8B,EAAatL,QAASyJ,GAAIqB,EAAatB,WAR/D,CACf,MAAM6C,EAAcvD,GAAmB,EAAI,EAC3CE,EAAW,CACTQ,KAAMZ,EAAMC,EAAmBwD,GAAatC,WAAWP,KACvDC,GAAIb,EAAMC,EAAmBwD,GAAatC,WAAWN,OAO3D6C,SAAUvD,EAjBZ,UAmBE,iBAAKzI,UAAWwC,EAAOyJ,iBAAvB,UACGxD,EAAU,gBAAC,EAAAO,QAAD,MAAc,SAAC,EAAA1D,KAAD,CAAMC,KAAMiD,EAAkB,WAAa,aAAc/C,KAAK,OADzF,kBAOEyG,GACJ,SAAC,EAAA/G,OAAD,CACE,cAAY,kBACZnF,UAAWwC,EAAOsJ,UAClB1G,QAAQ,YACRC,QAAS,KAEP,IAAK6F,EAAa,CAChB,MAAMa,EAAcvD,EAAkB,GAAK,EAC3CE,EAAW,CACTQ,KAAMZ,EAAMC,EAAmBwD,GAAatC,WAAWP,KACvDC,GAAIb,EAAMC,EAAmBwD,GAAatC,WAAWN,OAK3D6C,SAAUvD,GAAWyC,EAfvB,UAiBE,iBAAKlL,UAAWwC,EAAOyJ,iBAAvB,UACGxD,IAAO,OAAI,SAAC,EAAAO,QAAD,MACXkC,GAAezC,EAAU,MAAO,SAAC,EAAAnD,KAAD,CAAMC,KAAMiD,EAAkB,aAAe,WAAY/C,KAAK,OAC9FyF,EAAc,iBAAmB,kBAKxC,OACE,iBAAKlL,UAAWwC,EAAO2J,aAAvB,UACG3D,EAAkBqD,EAAkBK,GACrC,SAAC7D,EAAD,CACEC,MAAOA,EACPC,iBAAkBA,EAClBC,gBAAiBA,EACjBlG,SAAUA,EACVmG,QAASA,EACTC,WAAYA,IAEbF,EAAkB0D,EAAkBL,GACrC,SAAC,EAAA1G,OAAD,CACE,cAAY,cACZnF,UAAWwC,EAAO4J,kBAClBhH,QAAQ,YACRC,QAASkF,EACT8B,MAAM,gBALR,gBAOE,SAAC,EAAA/G,KAAD,CAAMC,KAAK,WAAWE,KAAK,aAMnC,SAAeY,EAAAA,EAAAA,MAAK8D,GAEdvG,EAAY,CAACvB,EAAsBmG,EAA0BC,KAC1D,CACL0D,aAAczJ,EAAAA,GAAI;;;;yBAIG8F,EAAkB,aAAe;;aAE7CnG,EAAMoB,QAAQ;;MAGvBqI,UAAWpJ,EAAAA,GAAI;;;;;;;;MASfuJ,iBAAkBvJ,EAAAA,GAAI;;;;;;;;MAStB0J,kBAAmB1J,EAAAA,GAAI;;;;;;;oBAOPL,EAAMoB,QAAQ;ogBClK3B,SAAS6I,IAAa,KAC3BC,EAD2B,OAE3BC,EAF2B,MAG3BC,EAH2B,SAI3BnK,EAJ2B,cAK3B8H,EAL2B,aAM3BE,EAN2B,aAO3BoC,EAP2B,YAQ3BC,EAR2B,sBAS3BC,EAT2B,YAU3BC,EAV2B,WAW3BC,EAX2B,mBAY3BC,EAAqBC,EAAAA,GAAAA,SAErB,MAAM3K,GAAQ+G,EAAAA,EAAAA,cACP6D,EAAmBC,IAAwBpM,EAAAA,EAAAA,WAAS,IACpDqM,EAAkBC,IAAuBtM,EAAAA,EAAAA,UAAS,GAEnDuM,GAAeC,EAAAA,GAAAA,GAAYf,GAC3BgB,GAAsB/N,EAAAA,EAAAA,QAAO,GAE/B+M,GAAQc,KAAiBG,EAAAA,EAAAA,oBAAmBH,EAAcd,EAAMkB,EAAAA,6BAClEF,EAAoB7N,UAGtB,MAAMgO,EAAeP,EAAmBI,EAAoB7N,SAErDiO,EAAaC,IAAkB9M,EAAAA,EAAAA,UAA4B,CAChE+M,SAAU,CACRC,MAAO,CACLC,KAAMC,EAAAA,iBAAAA,gBAERC,OAAQ,CACNC,UAAWC,EAAAA,GAAAA,KACXC,YAAa,EACbC,UAAW,IAGfC,UAAW,KAGPhI,GAAQC,EAAAA,EAAAA,YAAW3C,IACnB2K,EAAY,CAChBrF,MAAMsF,EAAAA,EAAAA,UAASpE,EAAclB,MAC7BC,IAAIqF,EAAAA,EAAAA,UAASpE,EAAcjB,IAC3BtE,IAAK,CACHqE,MAAMsF,EAAAA,EAAAA,UAASpE,EAAclB,MAC7BC,IAAIqF,EAAAA,EAAAA,UAASpE,EAAcjB,MAIzBsF,GAAiBC,EAAAA,EAAAA,UAAQ,KAC7B,MAAMC,GAAWC,EAAAA,EAAAA,4BAA0BC,EAAAA,EAAAA,GAAoBC,EAAAA,GAAqB,WAC9EC,ECpGH,SAAyBC,EAAqB1I,GACnD,OAAO2I,EAAAA,GAAAA,IAAQD,GAASE,SACQhL,IAA1BgL,EAAMrB,SAASI,SACjBiB,EAAMrB,SAASI,OAAS,IAG1B,MAAM,OAAEA,GAAWiB,EAAMrB,SAMzB,YAJwB3J,IAApB+J,EAAOkB,WACTlB,EAAOkB,SAAW,CAAEC,MAAO,MAGrB9I,GACN,IAAK,QACH2H,EAAOC,UAAYC,EAAAA,GAAAA,KACnBF,EAAOkB,SAASpB,KAAOsB,EAAAA,GAAAA,KACvBpB,EAAOG,YAAc,EACrB,MACF,IAAK,OACHH,EAAOC,UAAYC,EAAAA,GAAAA,KACnBF,EAAOkB,SAASpB,KAAOsB,EAAAA,GAAAA,KACvBpB,EAAOG,YAAc,IACrB,MACF,IAAK,SACHH,EAAOC,UAAYC,EAAAA,GAAAA,OACnBF,EAAOkB,SAASpB,KAAOsB,EAAAA,GAAAA,KACvBpB,EAAOG,YAAc,EACrB,MACF,IAAK,gBACHH,EAAOC,UAAYC,EAAAA,GAAAA,KACnBF,EAAOkB,SAASpB,KAAOsB,EAAAA,GAAAA,OACvBpB,EAAOG,YAAc,IACrB,MACF,IAAK,eACHH,EAAOC,UAAYC,EAAAA,GAAAA,KACnBF,EAAOkB,SAASpB,KAAOsB,EAAAA,GAAAA,OACvBpB,EAAOG,YAAc,IACrB,MACF,QAME,MAAM,IAAIkB,MAAO,wBADWhJ,SDyDNiJ,CAAgB5B,EAAab,GACvD,OAAO0C,EAAAA,EAAAA,qBAAoB,CACzB7B,YAAaoB,EACbxC,KAAAA,EACAjK,SAAAA,EACAmN,iBAAmB7K,GAAUA,EAC7BvC,MAAAA,EACAqN,oBAAqBf,MAEtB,CAAChB,EAAab,EAAYP,EAAMjK,EAAUD,KAE7C5C,EAAAA,EAAAA,YAAU,KACR,GAAImN,EAAuB,CACzB,MAAM+C,EAAyB,GAC/BlB,EAAemB,SAASC,IACEA,EAAMC,OAAOxL,KAAKyL,IAAD,2BAAWA,EAAMf,cAAjB,iBAAW,EAAcf,cAAzB,iBAAW,EAAsB+B,gBAAjC,aAAW,EAAgCC,OAAKC,MAAMC,EAAAA,WAE7FR,EAAanI,MAAK4I,EAAAA,EAAAA,qBAAoBP,OAG1CjD,EAAsB+C,MAEvB,CAAClB,EAAgB7B,IAEpB,MAAMyD,EAAepD,EAAoBwB,EAAiBA,EAAexM,MAAM,EA9F/C,IAgG1BqO,EAA6B,CACjCC,SAAUC,EAAAA,EACVC,YAAa5D,EACb6D,yBAAyBlK,EAAeuH,GACtCX,GAAqBxF,GAAMA,EAAI,IAC/BgG,GAAe+C,EAAAA,GAAAA,GAA8BnK,EAAOuH,EAAMJ,EAAapB,MAI3E,OACE,UAAC,EAAAqE,qBAAD,CAAsBhM,MAAO0L,EAA7B,UACG7B,EAAe5G,OA3GY,KA2G2BoF,IACrD,iBAAKjN,WAAWmE,EAAAA,EAAAA,IAAG,CAACmC,EAAMuK,uBAA1B,WACE,SAAC,EAAAvL,KAAD,CAAMtF,UAAWsG,EAAMwK,eAAgBvL,KAAK,yBAC1C,iCACF,iBACEvF,WAAWmE,EAAAA,EAAAA,IAAG,CAACmC,EAAM2G,oBACrB5H,QAAS,KACPkI,EAAoB7N,UACpBwN,GAAqB,IAJzB,SAMG,YAAWuB,EAAe5G,eAGjC,SAAC,EAAAkJ,cAAD,CACExE,KAAM,CAAEyE,OAAQX,EAAc9B,UAAAA,EAAWb,aAAAA,EAAc1L,MAAO0K,EAAcC,YAAAA,GAC5EsE,SAAS,aACT5E,MAAM,GACNI,MAAOA,EACPD,OAAQA,EACR0E,kBAAmB5G,EACnBhI,SAAUA,EACV6O,QACE,CACEC,QAAS,CAAErD,KAAMhB,GACjBsE,OAAQ,CAAEC,YAAaC,EAAAA,GAAAA,KAAwBrJ,UAAW,SAAUsJ,MAAO,UAQvF,MAAM5N,GAAavB,IAAD,CAChBwO,qBAAsBnO,EAAAA,GAAI;;;cAGdL,EAAMoB,QAAQ;;qBAEPpB,EAAMoB,QAAQ;;wBAEXpB,EAAMW,OAAO8G,WAAWC;IAE9C+G,eAAgBpO,EAAAA,GAAI;;aAETL,EAAMW,OAAOyO,QAAQzH;oBACd3H,EAAMoB,QAAQ;IAEhCwJ,kBAAmBvK,EAAAA,GAAI;;;aAGZL,EAAMW,OAAOC,KAAKyO;+HE1J/B,MAAMC,GACQ,kCADRA,GAEM,gCAFNA,GAGY,sCAHZA,GAIgB,0CA0CtB,MAAMC,WAAqB3Q,EAAAA,cAA4B,2HAGxC4Q,EAAAA,EAAAA,cAHwC,gBAKtC,CACbC,WAAYC,EAAAA,EAAAA,QAAcJ,IAA0B,GACpDK,SAAUD,EAAAA,EAAAA,QAAcJ,IAAwB,GAChDM,eAAgBF,EAAAA,EAAAA,QAAcJ,IAA8B,GAC5DO,mBAAoBH,EAAAA,EAAAA,QAAcJ,IAAkC,GACpE5K,cAAeQ,EAAAA,kBAAAA,KACf4K,gBAAiB,GACjB9H,cAAe,KACf+H,YAAY,EACZnL,mBAAoB,GACpBG,aAAa,IAfsC,iCA4B7B,KACtB3F,KAAK4Q,SAAS,CAAED,YAAY,IAE5B3Q,KAAK6Q,eAAiBC,OAAOC,YAAW,KACtC/Q,KAAK4Q,UAAUI,GACmB,OAA5BA,EAAUpI,eAA0BoI,EAAUpI,gBAAkBY,EAAAA,cAAAA,WAC3D,CAAEZ,cAAeY,EAAAA,cAAAA,WAEnB,CAAEZ,cAAeY,EAAAA,cAAAA,gBAEzB,GACHxJ,KAAKiR,oBAAsBH,OAAOC,YAAW,IAAM/Q,KAAK4Q,SAAS,CAAED,YAAY,KAAU,QAvCtC,4BA0ClC,KACjB3Q,KAAK4Q,UAAUI,IAAD,CACZrL,aAAcqL,EAAUrL,mBA5CyB,yBAgDpCL,IACftF,KAAK4Q,SAAS,CAAEtL,cAAAA,OAjDmC,0BAoDnCzF,IAChB,MAAM,OAAEqR,GAAWrR,EACnB,GAAIqR,EAAQ,CACV,MAAMb,EAAaa,EAAOC,QAC1BnR,KAAK4Q,SAAS,CACZP,WAAAA,IAEFC,EAAAA,EAAAA,IAAUJ,GAA0BG,OA3Da,wBA+DrCxQ,IACd,MAAM,OAAEqR,GAAWrR,EACnB,GAAIqR,EAAQ,CACV,MAAMX,EAAWW,EAAOC,QACxBnR,KAAK4Q,SAAS,CACZL,SAAAA,IAEFD,EAAAA,EAAAA,IAAUJ,GAAwBK,OAtEe,kCA0E3B1Q,IACxB,MAAM,OAAEqR,GAAWrR,EACnB,GAAIqR,EAAQ,CACV,MAAMV,EAAiBU,EAAOC,QAC9BnR,KAAK4Q,SAAS,CACZJ,eAAAA,IAEFF,EAAAA,EAAAA,IAAUJ,GAA8BM,OAjFS,sCAqFvB3Q,IAC5B,MAAM,OAAEqR,GAAWrR,EACnB,GAAIqR,EAAQ,CACV,MAAMT,EAAqBS,EAAOC,QAClCnR,KAAK4Q,SAAS,CACZH,mBAAAA,IAEFH,EAAAA,EAAAA,IAAUJ,GAAkCO,OA5FK,4BAgGjCW,IAClB,MAAMV,EAAkBU,EAAgBvO,KAAKwO,GAAUC,EAAAA,SAASD,KAChErR,KAAK4Q,SAAS,CAAEF,gBAAAA,OAlGmC,uBAqGtC7Q,IACbA,EAAM0R,iBACFvR,KAAKN,MAAM8R,iBACbxR,KAAKN,MAAM8R,qBAxGsC,2BA4GlC3R,IACjBA,EAAM0R,iBACFvR,KAAKN,MAAM+R,gBACbzR,KAAKN,MAAM+R,oBA/GsC,6BAmHhCC,KAGJ,IAFD1R,KAAKO,MAAMiF,mBAAmBmM,QAAQD,IAGlD1R,KAAK4Q,UAAUrQ,IACN,CACLiF,mBAAoBjF,EAAMiF,mBAAmBoM,OAAOF,UAzHP,6BA+HhCA,IACL1R,KAAKO,MAAMiF,mBAAmBmM,QAAQD,IACvC,GACX1R,KAAK4Q,UAAUrQ,IACN,CACLiF,mBAAoBjF,EAAMiF,mBAAmBsE,QAAQ+H,GAAMH,IAAQG,WApItB,+BA0I/B,KACpB7R,KAAK4Q,UAAUrQ,IACN,CACLiF,mBAAoB,UA7I2B,iCAkJ7BsM,EAAAA,EAAAA,IAAYrR,KACzBA,EAAQyF,MAAMC,GAAMA,EAAET,yBAnJoB,qBAsJzCoM,EAAAA,EAAAA,IAAW,CAACrR,EAAwB6E,KAC9C,MAAMyM,GAAcC,EAAAA,EAAAA,IAAavR,EAAS6E,GACpCC,EAAawM,EAAYE,QAAO,CAACC,EAAKpP,IAASA,EAAIqP,WAAaD,EAAMpP,EAAIqP,WAAaD,GAAM,GACnG,MAAO,CAAEH,YAAAA,EAAaxM,WAAAA,OAzJ6B,sBA4JxCuM,EAAAA,EAAAA,IAAW,CAACrR,EAAwBiQ,KACxC0B,EAAAA,EAAAA,IAAgB3R,EAAS,IAAI4R,IAAI3B,OA7JW,2BAgKnC,4BAAM1Q,KAAKsS,WAAWrU,eAAtB,aAAM,EAAyBsU,oBA9IjDC,uBACMxS,KAAK6Q,gBACPC,OAAO2B,aAAazS,KAAK6Q,gBAGvB7Q,KAAKiR,qBACPH,OAAO2B,aAAazS,KAAKiR,qBA0I7BtQ,SACE,MAAM,MACJqK,EADI,QAEJvK,EAFI,SAGJiS,EAHI,WAIJC,EAJI,aAKJ5J,EALI,QAMJ/B,GAAU,EANN,aAOJiE,EAPI,mBAQJ2H,EARI,sBASJC,EATI,SAUJhS,EAVI,SAWJiS,EAXI,UAYJC,EAZI,kBAaJC,EAbI,cAcJrK,EAdI,aAeJE,EAfI,cAgBJoK,EAhBI,MAiBJrS,EAjBI,YAkBJsS,EAlBI,WAmBJjK,EAnBI,kBAoBJC,GACElJ,KAAKN,OAEH,WACJ2Q,EADI,SAEJE,EAFI,eAGJC,EAHI,mBAIJC,EAJI,cAKJnL,EALI,gBAMJoL,EANI,cAOJ9H,EAPI,WAQJ+H,EARI,mBASJnL,EATI,YAUJG,GACE3F,KAAKO,MAEHQ,EAASoB,GAAUvB,EAAO4P,GAC1B2C,EAAU1S,GAAWA,EAAQ2F,OAAS,EACtCV,EAAsB1F,KAAKoT,sBAAsB3S,GAEjD4S,EAAerT,KAAKsT,WAAW7S,EAASiQ,IACxC,YAAEqB,EAAF,WAAexM,GAAevF,KAAKuT,UAAUF,EAAc/N,GAE3DkO,EAAWT,EAAa,YAAWU,EAAAA,UAAAA,kBAA4BV,KAAe,cAEpF,OACE,gCACGJ,GAAcA,EAAWvM,QACxB,iCACE,gBAAK7H,UAAWwC,EAAO2S,SAAvB,2HAIA,SAAC7I,GAAD,CACEQ,WAAW,QACXP,KAAM6H,EACN5H,OAAQ,IACRC,MAAOA,EACPM,mBAAoBC,EAAAA,GAAAA,MACpB5C,cAAeI,GAAgBJ,EAC/B9H,SAAUA,EACVoK,aAAcA,EACdpC,aAAcA,EACdsC,sBAAuBnL,KAAK2T,2BAG9BlR,GACJ,iBAAKlE,UAAWwC,EAAO6S,WAAYjR,IAAK3C,KAAKsS,WAA7C,WACE,UAAC,EAAAuB,eAAD,YACE,SAAC,EAAAC,YAAD,CAAa/O,MAAM,OAAOpD,aAAW,EAArC,UACE,SAAC,EAAAoS,aAAD,CAAc5Q,MAAOoN,EAAUyD,SAAUhU,KAAK6I,aAAclH,aAAW,EAACsS,GAAG,iBAE7E,SAAC,EAAAH,YAAD,CAAa/O,MAAM,gBAAgBpD,aAAW,EAA9C,UACE,SAAC,EAAAoS,aAAD,CAAc5Q,MAAOkN,EAAY2D,SAAUhU,KAAKkU,eAAgBvS,aAAW,EAACsS,GAAG,qBAEjF,SAAC,EAAAH,YAAD,CAAa/O,MAAM,aAAapD,aAAW,EAA3C,UACE,SAAC,EAAAoS,aAAD,CAAc5Q,MAAOqN,EAAgBwD,SAAUhU,KAAKmU,uBAAwBxS,aAAW,EAACsS,GAAG,kBAE7F,SAAC,EAAAH,YAAD,CAAa/O,MAAM,gBAAgBpD,aAAW,EAA9C,UACE,SAAC,EAAAoS,aAAD,CACE5Q,MAAOsN,EACPuD,SAAUhU,KAAKoU,2BACfzS,aAAW,EACXsS,GAAG,gBAGP,SAAC,EAAAH,YAAD,CAAa/O,MAAM,QAAQpD,aAAW,EAAtC,UACE,SAAC,EAAA0S,iBAAD,CACE3E,QAAS4E,OAAOC,OAAOzO,EAAAA,mBAAmBjD,KAAK2R,IAAD,CAC5CzP,OAAO0P,EAAAA,EAAAA,YAAWD,GAClBrR,MAAOqR,EACPE,YAAaC,EAAAA,qBAAqBH,OAEpCrR,MAAOmC,EACP0O,SAAUhU,KAAK4U,cACfrW,UAAWwC,EAAO8T,qBAIxB,0BACE,SAAC,EAAAnR,OAAD,CACEC,QAAQ,YACR4G,SAAUoG,EACV/F,MAAOhC,IAAkBY,EAAAA,cAAAA,UAA0B,yBAA2B,yBAC9E,aAAW,qBACXjL,UAAWwC,EAAO+T,aAClBlR,QAAS5D,KAAK+U,sBANhB,SAQGpE,EAAa,cAAgB,6BAIpC,SAACvL,EAAD,CACE3E,QAASA,EACT4E,KAAMqN,GAAY,GAClBpN,cAAeA,EACfC,WAAYA,EACZG,oBAAqBA,EACrBC,YAAaA,EACbH,mBAAoBA,EACpBI,iBAAkB5F,KAAK4F,iBACvBH,oBAAqBzF,KAAKyF,uBAE5B,iBAAKlH,UAAWwC,EAAOiU,YAAvB,WACE,gBAAKzW,UAAWwC,EAAON,QAAvB,UACE,SAAC,EAAAwU,QAAD,CACExU,QAASA,EACTyU,iBAAkBnD,EAClBzM,cAAeA,EACf6P,cAAenV,KAAKN,MAAMyV,cAC1BvC,mBAAoBA,EACpBC,sBAAuBA,EACvBG,kBAAmBA,EACnB3C,WAAYA,EACZE,SAAUA,EACV6E,kBAAkB,EAClBzP,YAAaA,EACb6K,eAAgBA,EAChBC,mBAAoBA,EACpB5P,SAAUA,EACVoS,cAAeA,EACfrK,cAAeA,EACfpD,mBAAoBA,EACpB6P,yBAA0BrV,KAAKsV,kBAC/BC,yBAA0BvV,KAAKwV,uBAGnC,SAAC,EAAD,CACE5M,cAAeA,EACfG,aAAcA,MAAAA,EAAAA,EAAgBJ,EAC9BA,cAAeA,EACf9H,SAAUA,EACVgI,aAAcA,EACd7B,QAASA,EACTgC,QAASkK,MAAAA,EAAAA,EAAe,GACxBpK,gBAAiB9I,KAAK8I,gBACtBI,kBAAmBA,EACnBD,WAAYA,QAGdjC,IAAYmM,IAAYL,IACxB,iBAAKvU,UAAWwC,EAAO0U,OAAvB,4BAEE,SAAC,EAAA/R,OAAD,CAAQM,KAAK,KAAK0R,KAAK,OAAO9R,QAAS5D,KAAK2V,YAA5C,oCAMH7C,IACC,iBAAKvU,UAAWwC,EAAO0U,OAAvB,WACE,0BAAOjC,KACP,SAAC,EAAA9P,OAAD,CAAQM,KAAK,KAAK0R,KAAK,OAAO9R,QAAS5D,KAAK4V,gBAA5C,8BAUL,MAAMC,IAAO1R,EAAAA,EAAAA,YAAWgM,IAEzBhO,GAAY,CAACvB,EAAsB4P,KAChC,CACLiF,OAAQxU,EAAAA,GAAI;;;;MAKZ2S,WAAY3S,EAAAA,GAAI;;;;;0BAKML,EAAMW,OAAO8G,WAAWC;iBACjC1H,EAAMoB,QAAQ,EAAG;uBACXpB,EAAMkV,MAAMC;gBACnBnV,EAAMoB,QAAQ,EAAG,EAAG;0BACVpB,EAAMW,OAAOyU,OAAOC;MAE1CnB,aAAc7T,EAAAA,GAAI;gBACNL,EAAMoB,QAAQ,GAAK,EAAG,EAAG;MAErC6S,aAAc5T,EAAAA,GAAI;kBACJL,EAAMoB,QAAQ;MAE5BgT,YAAa/T,EAAAA,GAAI;;;;MAKjBR,QAASQ,EAAAA,GAAI;oBACGuP,EAAiB,QAAU;;;MAI3CkD,SAAUzS,EAAAA,GAAI;mBACCL,EAAMM,WAAW8C,KAAKyE;eAC1B7H,EAAMW,OAAOC,KAAK6C;4NChdjC,MAMMlC,IAAY2P,EAAAA,EAAAA,IAAW,KACpB,CACLoE,UAAWjV,EAAAA,GAAI;;;;;;MAOfkV,gBAAiBlV,EAAAA,GAAI;;;4BAfE,kBAIH;MAgBpBmV,SAAUnV,EAAAA,GAAI;;;;;;MAOdoV,eAAgBpV,EAAAA,GAAI;;;4BA3BG,kBAIH;UAwCjB,SAASqV,GAAwB5W,GACtC,MAAM,QAAE6W,EAAF,SAAWC,GAAa9W,EACxBqB,EAASoB,KACf,OACE,SAACsU,GAAA,EAAD,CACEC,GAAIH,EACJI,cAAc,EACdC,eAAe,EACfC,QAASC,IACTC,WAAY,CACVC,MAAOjW,EAAOmV,UACde,YAAalW,EAAOoV,gBACpBe,KAAMnW,EAAOqV,SACbe,WAAYpW,EAAOsV,gBATvB,SAYGG,ICXA,SAASY,GAAiB1X,GAC/B,MAAM2X,EA5CD,SAA6BC,GAClC,MAAMC,GAAWC,EAAAA,EAAAA,eAEXC,GAAQC,EAAAA,EAAAA,cAAY,KACxBH,GAASI,EAAAA,EAAAA,IAAqB,CAAEL,UAAAA,EAAWxX,UAAU,OACpD,CAACwX,EAAWC,IAETK,GAASF,EAAAA,EAAAA,cAAY,KACzBH,GAASI,EAAAA,EAAAA,IAAqB,CAAEL,UAAAA,EAAWxX,UAAU,OACpD,CAACwX,EAAWC,IAETM,GAAOH,EAAAA,EAAAA,cAAY,KAIvBD,IAIAF,GAASO,EAAAA,EAAAA,IAAsBR,EAAWS,EAAAA,cAAAA,UAAAA,QAC1CR,GAASS,EAAAA,EAAAA,IAAWV,MACnB,CAACA,EAAWC,EAAUE,IAEnBQ,GAAQP,EAAAA,EAAAA,cAAY,KACxBH,GAASO,EAAAA,EAAAA,IAAsBR,EAAWS,EAAAA,cAAAA,WAAAA,UACzC,CAACT,EAAWC,IAEf,MAAO,CACLE,MAAAA,EACAG,OAAAA,EACAC,KAAAA,EACAI,MAAAA,GAaeC,CAAoBxY,EAAM4X,WAC3C,OAAO5X,EAAM8W,SAASa,G,kLCpBxB,MAAMc,WAAsB3Y,EAAAA,cAAkC,sDAC5CmJ,IACd,MAAM,UAAE2O,EAAF,gBAAac,GAAoBpY,KAAKN,MAC5C0Y,EAAgB,CAAEd,UAAAA,EAAW3O,cAAAA,OAH6B,4BAMzC0P,MAAOvV,EAAkB4M,KAC1C,MAAM,mBAAE4I,GAAuBtY,KAAKN,MAEpC,OAAI6Y,EAAAA,EAAAA,uBAAsBD,GACjBA,EAAmBE,iBAAiB1V,EAAK4M,GAG3C,MAbmD,6BAgBvC5M,IACnB,MAAM,mBAAEwV,GAAuBtY,KAAKN,MAEpC,SAAI6Y,EAAAA,EAAAA,uBAAsBD,IACjBA,EAAmBtF,kBAAkBlQ,MApBY,yBA0B5C,CAACwL,EAAcmK,KAC7B,MAAQC,UAAWtN,EAAb,MAA0BuN,GAAU3Y,KAAKN,MAC/C,OAAOkZ,EAAAA,GAAAA,GAAwB,CAAEtK,MAAAA,EAAOmK,SAAAA,EAAUrN,YAAAA,EAAauN,MAAAA,OAGjEhY,SACE,MAAM,QACJqG,EADI,aAEJiE,EAFI,QAGJxK,EAHI,SAIJiS,EAJI,WAKJC,EALI,YAMJO,EANI,mBAOJN,EAPI,sBAQJC,EARI,gBASJrB,EATI,eAUJC,EAVI,cAWJ9I,EAXI,SAYJ9H,EAZI,aAaJkI,EAbI,SAcJ+J,EAdI,MAeJ6F,EAfI,MAgBJ3N,EAhBI,OAiBJ6N,EAjBI,UAkBJvB,EAlBI,kBAmBJpO,EAnBI,WAoBJD,GACEjJ,KAAKN,MAET,IAAKe,EACH,OAAO,KAIT,MAAMqY,EAAoC7X,EAAAA,GAAI;;;;;;;MAS9C,OACE,iCACE,SAACqV,GAAD,CAAyBC,QAASsC,EAAlC,UACE,SAAC,EAAAE,SAAD,CAAUhU,MAAM,OAAOiC,SAAS,EAAOgS,QAAM,EAA7C,UACE,SAAC5B,GAAD,CAAkBE,UAAWA,EAA7B,SACID,IACA,SAACnT,EAAD,CACEzD,QAASA,EACTI,SAAUA,EACVkD,SAAUsT,EAASQ,KACnB/X,SAAUE,KAAKN,MAAMI,SACrBC,QAASsX,EAASI,MAClB3W,SAAUuW,EAASO,gBAM7B,SAACtB,GAAD,CAAyBC,SAAUsC,EAAnC,UACE,SAAC,EAAAE,SAAD,CAAUhU,MAAM,OAAOiC,QAASA,EAASgS,QAAM,EAACza,UAAWua,EAA3D,UACE,SAACjD,GAAD,CACEpV,QAASA,EACTiS,SAAUA,EACVC,WAAYA,EACZO,YAAaA,EACblI,MAAOA,EACPhE,QAASA,EACTiE,aAAcA,EACdpC,aAAc7I,KAAK6I,aACnB+J,mBAAoBA,EACpBC,sBAAuBA,EACvBrB,gBAAiBA,EACjBC,eAAgBA,EAChB9I,cAAeA,EACfI,aAAcA,EACdlI,SAAUA,EACViS,SAAUA,EACVC,UAAW4F,EAAMvV,IACjB4P,kBAAmBhT,KAAKgT,kBACxBmC,cAAenV,KAAKwY,iBACpBvF,cAAejT,KAAKiT,cACpB/J,kBAAmB,IAAMA,EAAkBoO,GAC3CrO,WAAY,IAAMA,EAAWqO,aA8C3C,MAAM2B,GAAqB,CACzBb,gBADyB,KAEzBM,UAFyB,KAGzBxP,kBAHyB,KAIzBD,WAAUA,EAAAA,IAMZ,IAHkBiQ,EAAAA,EAAAA,UA5ClB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MAEMpS,EAFU3E,EAAM4Y,QAEiB7B,IACjC,WACJ8B,EADI,QAEJpS,EAFI,SAGJ8L,EAHI,mBAIJwF,EAJI,OAKJO,EALI,SAMJ/Y,EANI,MAOJ6Y,EAPI,cAQJhQ,EARI,uBASJ0Q,EATI,eAUJC,GACEpU,EACErE,GAAW0Y,EAAAA,EAAAA,GAAYhZ,EAAMiZ,MAEnC,MAAO,CACLxS,QAAAA,EACAvG,QAAS2Y,MAAAA,OAAF,EAAEA,EAAYK,KACrB/G,SAAU0G,MAAAA,OAAF,EAAEA,EAAY/T,KACtBsN,WAAYyG,MAAAA,OAAF,EAAEA,EAAY7J,OACxB2D,YAAakG,MAAAA,OAAF,EAAEA,EAAYpQ,QACzBD,aAAcqQ,MAAAA,OAAF,EAAEA,EAAYrQ,aAC1B+J,SAAAA,EACAjS,SAAAA,EACAyX,mBAAAA,EACAO,OAAAA,EACA/Y,SAAAA,EACA6Y,MAAAA,EACAhQ,cAAAA,EACA0Q,uBAAAA,EACAC,eAAAA,KAWuCL,GAG3C,CAAyBd,I,6TCzMlB,MAAMuB,GAAWnZ,GAAsBoZ,QAAQpZ,EAAM4Y,QAAQS,GAAAA,GAAAA,OAAmBrZ,EAAM4Y,QAAQS,GAAAA,GAAAA,QC2BxFC,GAAY,EAAGvC,UAAAA,MAC1B,MAAMC,GAAWC,EAAAA,EAAAA,gBACX,WAAEsC,EAAF,8BAAcC,EAAd,iBAA6CC,EAA7C,WAA+DC,EAA/D,eAA2EC,IAAmBjN,EAAAA,EAAAA,UAClG,IAjBmBqK,CAAAA,IACrB,MAAM6C,EDZ+B7C,CAAAA,GAA0B/W,GAAsBA,EAAM4Y,QAAQ7B,GCYvE8C,CAAuB9C,GACnD,MAAO,CACLwC,YAAYO,EAAAA,GAAAA,IAAeF,GAAsBG,GAAMA,EAAGtR,UAC1DgR,kBAAkBK,EAAAA,GAAAA,IAAeF,GAAsBG,GAAMA,EAAGC,gBAChEN,YAAYI,EAAAA,GAAAA,IAAeF,GAAsBG,GAAMA,EAAGE,UAC1DN,gBAAgBG,EAAAA,GAAAA,IAAeF,GAAsBG,GAAMA,EAAGG,cAC9DV,+BAA+BM,EAAAA,GAAAA,IAC7BF,GACCG,IAAD,aAAOI,EAAAA,GAAAA,MAAmBC,oBAAnB,UAAuCL,EAAGhC,0BAA1C,aAAuC,EAAuBhV,UAQjEsX,CAActD,IACpB,CAACA,IAGGtO,GAAU6R,EAAAA,EAAAA,aAAYf,GACtBgB,GAAaD,EAAAA,EAAAA,aAAYd,GACzBQ,GAAgBM,EAAAA,EAAAA,aAAYb,GAC5BQ,GAAUK,EAAAA,EAAAA,aAAYZ,GACtBQ,GAAcI,EAAAA,EAAAA,aAAYX,GAE1Ba,GAAerD,EAAAA,EAAAA,cAAY,KAC/BH,GAASS,EAAAA,EAAAA,IAAWV,MACnB,CAACC,EAAUD,IAERtD,GAAW0D,EAAAA,EAAAA,cACdsD,IACCzD,GAAS0D,EAAAA,EAAAA,IAAoB,CAAEjS,QAASgS,EAAY1D,UAAAA,KAGhD0D,EAAW5U,OAAS4C,EAAQ5C,QAC9B2U,MAGJ,CAACxD,EAAUD,EAAWyD,EAAc/R,IAGhCkS,GAAaxD,EAAAA,EAAAA,cAChByD,IACCnH,EAAS,IAAIhL,EAAJ,iBAAkBmS,EAAlB,CAAyBC,OAAOC,EAAAA,GAAAA,IAAiBrS,SAE5D,CAACgL,EAAUhL,IAGb,OACE,SAACsS,GAAA,EAAD,CACER,WAAYA,EACZ9R,QAASA,EACTuS,gBAAiBvH,EACjBkH,WAAYA,EACZH,aAAcA,EACdjQ,KAAMyP,EACNiB,IAAKC,EAAAA,QAAAA,QACLjB,QAASA,EACT1L,SAAU2L,K,+EC7ChB,MAAMxB,GAAqB,CACzBP,UAASA,EAAAA,IAGLgD,IAAYxC,EAAAA,EAAAA,UAblB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MAEMpS,EAFU3E,EAAM4Y,QAEiB7B,IAC/BtQ,QAAS2U,EAAX,YAA2BC,EAA3B,MAAwCjD,GAAUzT,EAExD,MAAO,CAAE8B,UADO4U,GAAeA,EAAYxV,OAAS,IAAYuV,EAC9CC,YAAAA,EAAajD,MAAAA,KAOUM,IAIpC,MAAM4C,WAAuBrc,EAAAA,cAClCsc,iBACE,MAAM,YAAEF,GAAgB5b,KAAKN,MAE7B,OAAKkc,GAAsC,IAAvBA,EAAYxV,OAKzB2V,KAAKC,IAAID,KAAKE,IAAI,IAA0B,GAArBL,EAAYxV,QAAe,IAJhD,IAOXzF,SAAS,QACP,MAAM,QAAEqG,EAAF,kBAAWkV,EAAX,YAA8BN,EAA9B,MAA2C5Q,EAA3C,UAAkD0N,EAAlD,MAA6DC,EAA7D,UAAoEwD,EAApE,SAA+Etb,GAAab,KAAKN,MACjGqL,EAAS/K,KAAK8b,iBACdM,EAAapR,EAAoC,EAA5BuC,GAAAA,GAAAA,MAAAA,aAAgC8O,GAAAA,GAE3D,IAAIC,EAAYV,EAEhB,aAAIU,SAAJ,OAAI,EAAWlW,OAAQ,CACrBkW,GAAYvO,EAAAA,EAAAA,qBAAoB,CAC9BjD,KAAM,CAACwR,GACPzb,SAAAA,EACAD,MAAO2M,GAAAA,GAAAA,OACPS,iBAAmBuO,GAAcA,EACjCrQ,YAAa,CACXE,SAAU,GACVS,UAAW,MAEZ,GAIH,IAAK,MAAMyB,KAASgO,EAAUjO,OAC5BC,EAAMkO,SAAYjP,IACTqL,EAAAA,GAAAA,GAAwB,CAAEtK,MAAAA,EAAOmK,SAAUlL,EAAOkP,cAAgBrR,YAAasN,EAAWC,MAAAA,IAKvG,OACE,SAAC,EAAAI,SAAD,CAAUhU,MAAM,QAAQiC,QAASA,EAASgS,QAAM,EAAhD,SACY,QAAT,EAAAsD,SAAA,SAAWlW,QACV,SAAC,EAAAsW,MAAD,CACEP,UAAWA,EACXrR,KAAMwR,EACNtR,MAAOoR,EACPrR,OAAQA,EACRmR,kBAAmBA,KAGrB,SAAClX,EAAD,CAAcC,UAAW,CAAC,CAAE9B,MAAO,2BAO7C,SAAeuY,GAAUG,I,0KC3EzB,MAAM1Z,IAAYwa,EAAAA,EAAAA,gBAAe/b,IACxB,CACLgc,UAAW3b,EAAAA,GAAI;mBACAL,EAAMM,WAAW8C,KAAKyE;;yBAEhB7H,EAAMoB,QAAQ6a;;MAGnCC,MAAO7b,EAAAA,GAAI;;MAGX8b,OAAQ9b,EAAAA,GAAI;;;MAIZ8D,MAAO9D,EAAAA,GAAI;qBACML,EAAMoB,QAAQgb;UAK7BC,GAAyB,CAC7B,CAAE9Z,MAAO,EAAG4B,MAAO,UACnB,CAAE5B,MAAO,EAAG4B,MAAO,UACnB,CAAE5B,MAAO,EAAG4B,MAAO,UACnB,CAAE5B,MAAO,GAAI4B,MAAO,YAGf,SAASmY,GAAoBxd,GAClC,MAAM,gBACJyd,EADI,qBAEJC,EAFI,qBAGJC,EAHI,wBAIJC,EAJI,2BAKJC,EALI,2BAMJC,EANI,kBAOJC,GACE/d,EACEkB,GAAQ8c,EAAAA,EAAAA,YACR3c,EAASoB,GAAUvB,GACnB+c,EAAiBV,GAAuBW,MAAMrB,GAAMA,EAAEpZ,QAAUga,IAiBtE,OACE,iBAAK5e,UAAWwC,EAAO6b,UAAvB,WACE,SAAC,EAAAiB,MAAD,CACE9Y,MAAM,oBACN2P,YAAc,mFAAkFoJ,EAAAA,6BAChGvf,UAAU,gBAHZ,UAKE,gBAAKA,UAAWwC,EAAO+b,MAAvB,UACE,SAAC,EAAAiB,OAAD,CACEC,kBAAgB,EAChB7a,MAAOwa,EACPjO,QAASuN,GACTjJ,SAAUsJ,SAIhB,SAAC,EAAAO,MAAD,CAAO9Y,MAAM,qBAAqB2P,YAAY,IAAInW,UAAU,gBAA5D,UACE,iBAAKA,UAAWwC,EAAOgc,OAAvB,WACE,SAAC,EAAAkB,OAAD,CAAQ9a,MAAOia,EAAsBpJ,SAAUuJ,KAC/C,gBAAKhf,UAAWwC,EAAOgE,MAAvB,mFAGJ,SAAC,EAAA8Y,MAAD,CAAO9Y,MAAM,wBAAwB2P,YAAY,IAAInW,UAAU,gBAA/D,UACE,iBAAKA,UAAWwC,EAAOgc,OAAvB,WACE,SAAC,EAAAkB,OAAD,CAAQ9a,MAAOka,EAAsBrJ,SAAUwJ,KAC/C,gBAAKjf,UAAWwC,EAAOgE,MAAvB,iFAGJ,gBACExG,UAAW0C,EAAAA,GAAI;yBACEL,EAAMM,WAAWgd,OAAOC;UAF3C,kCAOA,gBACE5f,UAAW0C,EAAAA,GAAI;2BACIL,EAAMoB,QAAQyG;UAFnC,6DAOA,SAAC,EAAA/E,OAAD,CAAQC,QAAQ,cAAcC,QAzDjB,KACfmL,EAAAA,EAAAA,QACE,IAAIqP,GAAAA,GAAsB,CACxBxT,MAAO,SACPpJ,KAAM,kEACN6c,QAAS,SACTC,KAAM,YACNC,UAAW,KACTd,KACAlG,EAAAA,GAAAA,KAASiH,EAAAA,GAAAA,KAAUC,EAAAA,GAAAA,IAA0B,gCAgDjD,oC,mKC1FN,MAAMxF,GAAqB,CACzByF,iBADyB,MAEzBC,kBAFyB,MAGzBC,WAAUA,EAAAA,IAGNlD,IAAYxC,EAAAA,EAAAA,UAflB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MAAM6B,EAAU5Y,EAAM4Y,SAChB,mBAAEb,GAAuBa,EAAQ7B,GACvC,MAAO,CACLA,UAAAA,EACAgB,mBAAAA,KAUuCW,IAUrC9W,IAAYwa,EAAAA,EAAAA,gBAAc,CAAC/b,EAAqBie,KAEpD,MAAMC,EAAkB,QAClBC,EAAyB,QAGzBC,EAAYpe,EAAMW,OAAO0d,IAE/B,MAAO,CACLC,UAAWje,EAAAA,GAAI;;;0BAGOL,EAAMW,OAAO4d;gBACvBve,EAAMoB,QAAQyG;0BACJuW;uBACHpe,EAAMoV,OAAOoJ,OAAO3W;;iBAE1B7H,EAAMye,QAAQC;;MAG3BC,QAASte,EAAAA,GAAI;;;;iBAIAL,EAAMoB,QAAQyG;;;mCAGI7H,EAAMW,OAAO4d;mBAC7Bve,EAAMoB,QAAQwd,MAAM5e,EAAMoB,QAAQyG;;;kBAGnC7H,EAAMM,WAAW8C,KAAKyb;qBACnB7e,EAAMM,WAAW8C,KAAKyb;wBACnB7e,EAAMoB,QAAQyG;;MAGlCiX,oBAAqBze,EAAAA,GAAI;;;mBAGVL,EAAMM,WAAW8C,KAAKyE;qBACpB7H,EAAMM,WAAWgd,OAAOyB;MAEzCC,mBAAoB3e,EAAAA,GAAI;mBACT8d;;;mBAGAne,EAAMM,WAAW8C,KAAKyb;;uBAElB7e,EAAMoB,QAAQyG;;MAGjCoX,eAAgB5e,EAAAA,GAAI;qBACHL,EAAMM,WAAWgd,OAAOyB;2BAClBb;MAEvBgB,SAAU7e,EAAAA,GAAI;8BACYL,EAAMW,OAAO4d;;;;;;;MAQvCY,uBAAwB9e,EAAAA,GAAI;2BACL6d;oBACPle,EAAMoB,QAAQyG;MAE9BuX,QAAS/e,EAAAA,GAAI;;mBAEEL,EAAMM,WAAW8C,KAAKyE;qBACpB7H,EAAMM,WAAWgd,OAAO+B;oBACzBrf,EAAMoB,QAAQwd;MAE9BU,iBAAkBjf,EAAAA,GAAI;;wBAEFL,EAAMoB,QAAQyG;;MAGlC0X,SAAUlf,EAAAA,GAAI;;MAGdmf,UAAWnf,EAAAA,GAAI;mBACA8d;;;;;mBAKAne,EAAMoB,QAAQwd,MAAM5e,EAAMoB,QAAQgb;;;;;;UAyLrD,SAAetB,IA/KR,SAAyBhc,GAAc,MAC5C,MAAM,MACJyb,EADI,MAEJkF,EAFI,UAGJxB,EAHI,kBAIJF,EAJI,iBAKJD,EALI,UAMJpH,EANI,mBAOJgB,EAPI,WAQJsG,GACElf,GACG4gB,EAAqBC,IAA0BlhB,EAAAA,EAAAA,WAAS,IACxD2gB,EAASQ,IAAcnhB,EAAAA,EAAAA,UAA6B8b,EAAM6E,UAC1DS,EAAiBC,IAAsBrhB,EAAAA,EAAAA,eAAoCoD,IAElFzE,EAAAA,EAAAA,YAAU,KACmBqa,WACzB,MAAMsI,QAAWC,EAAAA,EAAAA,oBAAmBC,IAAI1F,EAAM2F,gBAC9CJ,EAAmBC,IAGrBI,KACC,CAAC5F,EAAM2F,iBAEV,MAAMlgB,GAAQ8c,EAAAA,EAAAA,YACR3c,EAASoB,GAAUvB,EAAOie,GAkD1BmC,EAAkB,KACtBrC,EAAkBxD,EAAM8F,GAAI,UAAWjB,GACvCO,GAAuB,IAGnBW,EAAwB,KAC5BX,GAAuB,GACvBC,EAAWrF,EAAM6E,UAabmB,GACJ,iBAAK5iB,UAAWwC,EAAOgf,uBAAwB,aAAYC,EAAU,sBAAwB,mBAA7F,WACE,SAAC,EAAAoB,SAAD,CACEje,MAAO6c,EACPqB,YAAarB,OAAUvd,EAAY,kDACnCuR,SAAWsN,GAAMd,EAAWc,EAAElhB,cAAc+C,OAC5C5E,UAAWwC,EAAOof,YAEpB,iBAAK5hB,UAAWwC,EAAOmf,iBAAvB,WACE,SAAC,EAAAxc,OAAD,CAAQE,QAASod,EAAiB,aAAW,gBAA7C,2BAGA,SAAC,EAAAtd,OAAD,CAAQC,QAAQ,YAAYC,QAASsd,EAArC,0BAOAtB,GACJ,iBAAKrhB,UAAWwC,EAAO6e,mBAAvB,WACE,SAAC,EAAA2B,WAAD,CACEzd,KAAK,cACLF,QA7C4B,IAAM2c,GAAwBD,GA8C1D1V,OAAO,UAAAuQ,EAAM6E,eAAN,eAAe5Z,QAAS,EAAI,eAAiB,iBAEtD,SAAC,EAAAmb,WAAD,CAAYzd,KAAK,OAAOF,QApFR,KAClB,MAAM4d,EAAgBrG,EAAMnS,QAAQnG,KAAK4e,IAAMC,EAAAA,EAAAA,IAAgBD,EAAGhB,KAAkBkB,KAAK,OACzFC,EAAAA,EAAAA,IAAsBJ,IACtBjK,EAAAA,GAAAA,KAASiH,EAAAA,GAAAA,KAAUC,EAAAA,GAAAA,IAA0B,gCAiFG7T,MAAM,6BAClDiU,IACA,SAAC,EAAA0C,WAAD,CAAYzd,KAAK,YAAYF,QAhFTyU,UACxB,MAAMpI,GAAO4R,EAAAA,EAAAA,IAAyB1G,SAChC2G,EAAAA,GAAAA,GAAuB7R,IA8EgCrF,MAAM,sCAEjE,SAAC,EAAA2W,WAAD,CAAYzd,KAAK,YAAY8G,MAAO,eAAgBhH,QA7ElC,KAEhBuX,EAAM4G,QACRhT,EAAAA,EAAAA,QACE,IAAIqP,GAAAA,GAAsB,CACxBxT,MAAO,SACPpJ,KAAM,kEACN6c,QAAS,SACTC,KAAM,YACNC,UAAW,KACTI,EAAkBxD,EAAM8F,GAAI,WAC5B1J,EAAAA,GAAAA,KAASiH,EAAAA,GAAAA,KAAUC,EAAAA,GAAAA,IAA0B,wBAKnDE,EAAkBxD,EAAM8F,GAAI,WAC5B1J,EAAAA,GAAAA,KAASiH,EAAAA,GAAAA,KAAUC,EAAAA,GAAAA,IAA0B,wBA6D7C,SAAC,EAAA8C,WAAD,CACEzd,KAAMqX,EAAM4G,QAAU,WAAa,OACnCC,SAAU7G,EAAM4G,QAAU,OAAS,UACnCne,QA5De,KACnB+a,EAAkBxD,EAAM8F,GAAI,YA4DxBrW,MAAOuQ,EAAM4G,QAAU,eAAiB,kBAK9C,OACE,iBAAKxjB,UAAWwC,EAAOme,UAAW+C,UAnDjBC,IACI,UAAjBA,EAASxQ,MAAoBwQ,EAASC,UAAYD,EAASE,UAC7DpB,IAGmB,WAAjBkB,EAASxQ,KACXwP,KA6CF,WACE,iBAAK3iB,UAAWwC,EAAOwe,QAAvB,WACE,iBAAKhhB,UAAWwC,EAAO2e,oBAAvB,WACE,gBAAK2C,IAAKhC,EAAO,aAAW,sBAC5B,gBAAK,aAAW,mBAAhB,SACGxB,EAAY,qCAAuC1D,EAAM2F,oBAG7DlB,MAEH,iBAAKrhB,WAAWmE,EAAAA,EAAAA,IAAG3B,EAAOwe,SAA1B,WACE,iBAAKhhB,UAAWwC,EAAO8e,eAAvB,UACG1E,EAAMnS,QAAQnG,KAAI,CAAC4e,EAAGa,KACrB,MAAMC,GAAYb,EAAAA,EAAAA,IAAgBD,EAAGhB,GACrC,OACE,gBAAK,aAAW,aAA+BliB,UAAWwC,EAAO+e,SAAjE,SACGyC,GADgC,GAAEd,KAAKa,SAK5ChC,GAAuBnF,EAAM6E,UAC7B,gBAAK,aAAW,gBAAgBzhB,UAAWwC,EAAOif,QAAlD,SACG7E,EAAM6E,UAGVM,GAAuBa,MAExBb,IACA,gBAAK/hB,UAAWwC,EAAOqf,UAAvB,UACE,SAAC,EAAA1c,OAAD,CAAQC,QAAQ,YAAYC,QA1InByU,UACjB,MAAMmK,EAAerH,EAAMnS,QACvBmS,EAAM2F,kBAAmBxI,MAAAA,OAAzB,EAAyBA,EAAoBxU,aACzC4a,EAAiBpH,EAAW6D,EAAM2F,eAAgB,CAAE2B,eAAe,IACzE7D,EAAWtH,EAAWkL,IAEtB5D,EAAWtH,EAAWkL,IAoIiCjY,SAAUsU,EAA3D,UACGvG,MAAAA,OAAA,EAAAA,EAAoBxU,QAASqX,EAAM2F,eAAiB,YAAc,gD,+KClRjF,MAAM3e,IAAYwa,EAAAA,EAAAA,gBAAc,CAAC/b,EAAqBmK,KACpD,MAAM2X,EAAU9hB,EAAM+hB,QAAU/hB,EAAMye,QAAQuD,MAAQhiB,EAAMye,QAAQwD,MAI9DC,EAAkB/X,EAAS,IAAX,KACtB,MAAO,CACL6R,UAAW3b,EAAAA,GAAI;;;qBAGEL,EAAMM,WAAW8C,KAAKyE;;wBAEnB7H,EAAMoB,QAAQ6a;;;yBAGbjc,EAAMM,WAAWgd,OAAOyB;2BACtB/e,EAAMoB,QAAQgb;;;MAIrC+F,iBAAkB9hB,EAAAA,GAAI;oBAhBN;MAmBhB+hB,gBAAiB/hB,EAAAA,GAAI;;sBAEHL,EAAMoB,QAAQyG;;;kBAGlBqa;;mBAECliB,EAAMoB,QAAQyG;;MAG7Bwa,OAAQhiB,EAAAA,GAAI;;MAGZiiB,UAAWjiB,EAAAA,GAAI;;;;MAKfkiB,YAAaliB,EAAAA,GAAI;uBACEL,EAAMoB,QAAQyG;MAEjC2a,YAAaniB,EAAAA,GAAI;;uBAEEL,EAAMoB,QAAQyG;;4BAETia;mBACT9hB,EAAMoB,QAAQqhB,OAAOziB,EAAMoB,QAAQwd,MAAM5e,EAAMoB,QAAQqhB,OAAOziB,EAAMoB,QAAQyG;yBACtE7H,EAAMoV,OAAOoJ,OAAO3W;;MAGzCsB,KAAM9I,EAAAA,GAAI;;MAGVqiB,YAAariB,EAAAA,GAAI;;;;oBAIDL,EAAMoB,QAAQ6a;;;;MAK9B0G,QAAStiB,EAAAA,GAAI;mBACEL,EAAMM,WAAWqiB,QAAQC;gBAC5B5iB,EAAMoB,QAAQgb,MAAMpc,EAAMoB,QAAQqhB,OAAOziB,EAAMoB,QAAQyG,MAAM7H,EAAMoB,QAAQqhB;MAEvFI,OAAQxiB,EAAAA,GAAI;;gBAEAL,EAAMoB,QAAQ6a;;;qBAGTjc,EAAMM,WAAWgd,OAAOwF;mBAC1B9iB,EAAMM,WAAW8C,KAAKyE;;uBAElB7H,EAAMM,WAAWgd,OAAOyB;uBACxB/e,EAAMoB,QAAQqhB;;MAGjCra,QAAS/H,EAAAA,GAAI;mBACEL,EAAMM,WAAW8C,KAAKyE;qBACpB7H,EAAMM,WAAWgd,OAAO+B;qBACxBrf,EAAMoB,QAAQwd;UAK5B,SAASmE,GAAsBjkB,GACpC,MAAM,kBACJkkB,EADI,0BAEJC,EAFI,QAGJ7a,EAHI,kBAIJ8a,EAJI,UAKJC,EALI,qBAMJ1G,EANI,gBAOJF,EAPI,UAQJ7F,EARI,OASJvM,GACErL,GAEGskB,EAAYC,IAAiB5kB,EAAAA,EAAAA,UAA2B,CAAC,EAAG8d,KAC5DrS,EAAMoZ,IAAW7kB,EAAAA,EAAAA,UAAyE,CAAC,GAAI,MAC/F8kB,EAAaC,IAAkB/kB,EAAAA,EAAAA,UAAS,KACxCglB,EAAsBC,IAA2BjlB,EAAAA,EAAAA,UAAS,IAE3DuB,GAAQ8c,EAAAA,EAAAA,YACR3c,EAASoB,GAAUvB,EAAOmK,IAEhCwZ,EAAAA,GAAAA,IACE,KACED,EAAwBH,KAE1B,IACA,CAACA,KAGHnmB,EAAAA,EAAAA,YAAU,KACR,MAAMwmB,GAAuCC,EAAAA,EAAAA,QAAOzb,EAAS,kBAAkBnG,KAAK6hB,GAAMA,EAAE5D,iBACtF6D,GAAoBC,EAAAA,EAAAA,IAAsBJ,GAEhDN,EAAQ,EACNW,EAAAA,EAAAA,IACE7b,EACA+a,EACAH,EAAkB/gB,KAAK6hB,GAAMA,EAAEvhB,QAC/BkhB,EACAL,GAEFW,MAED,CAACX,EAAYhb,EAAS+a,EAAWH,EAAmBS,IAEvD,MAAOS,EAAiBH,GAAqB7Z,EAKvCia,GAA0BC,EAAAA,EAAAA,IAAqBF,EAAiBf,GAEtE,OACE,iBAAKxlB,UAAWwC,EAAO6b,UAAvB,WACE,gBAAKre,UAAWwC,EAAOiiB,gBAAvB,UACE,iBAAKzkB,UAAWwC,EAAOkiB,OAAvB,mBACE,gBAAK1kB,UAAU,eAAf,8BACA,gBAAKA,UAAU,eAAf,UAA+B0mB,EAAAA,EAAAA,IAAwBjB,EAAW,OAClE,gBAAKzlB,UAAU,SAAf,UACE,SAAC,EAAA2mB,YAAD,CACEC,sBAAsB,EACtBlJ,IAAK,EACLD,IAAKmB,EACLha,MAAO6gB,EACPoB,YAAY,WACZC,oBAAqBJ,EAAAA,GACrBK,SAAS,EACTC,cAAetB,OAGnB,gBAAK1lB,UAAU,eAAf,UAA+B0mB,EAAAA,EAAAA,IAAwBjB,EAAW,YAItE,iBAAKzlB,UAAWwC,EAAOgiB,iBAAvB,WACE,iBAAKxkB,UAAWwC,EAAOmiB,UAAvB,WACI7F,IACA,gBAAK,aAAW,qBAAqB9e,UAAWwC,EAAOqiB,YAAvD,UACE,SAAC,EAAAoC,YAAD,CACExH,kBAAgB,EAChBtO,QAASiV,EACTxhB,MAAOygB,EACPvC,YAAY,qCACZrN,SAAU6P,OAIhB,gBAAKtlB,UAAWwC,EAAOoiB,YAAvB,UACE,SAAC,EAAAsC,YAAD,CACEpE,YAAY,iBACZle,MAAOghB,EACPnQ,SAAW7Q,IACTihB,EAAejhB,SAIrB,gBAAK,aAAW,eAAe5E,UAAWwC,EAAOgJ,KAAjD,UACE,SAAC,EAAAgU,OAAD,CACEC,kBAAgB,EAChB7a,MAAOuiB,GAAiB5b,QAAQ6b,GAAUA,EAAMxiB,QAAU4gB,IAC1DrU,QAASgW,GACTrE,YAAY,kBACZrN,SAAWsN,GAAMwC,EAAkBxC,EAAEne,cAI1CmR,OAAOsR,KAAKb,GAAyBliB,KAAK0gB,IAEvC,4BACE,iBAAKhlB,UAAWwC,EAAOwiB,QAAvB,UACGA,EADH,KACY,kBAAMhlB,UAAWwC,EAAOiI,QAAxB,UAAkC+b,EAAwBxB,GAASnd,OAAnE,iBAEX2e,EAAwBxB,GAAS1gB,KAAK4e,IACrC,MAAMoE,EAAMlB,EAAkBxa,WAAWua,GAAMA,EAAE3f,QAAU0c,EAAEX,iBAC7D,OACE,SAAC,GAAD,CACE3F,MAAOsG,EAEPnK,UAAWA,EACX+I,MAAOsE,EAAkBkB,GAAKC,OAC9BjH,UAAW8F,EAAkBkB,GAAKhH,WAH7B4C,EAAER,SATLsC,MAmBd,gBAAKhlB,UAAWwC,EAAO0iB,OAAvB,uFCjOR,MAAMthB,IAAYwa,EAAAA,EAAAA,gBAAe/b,IAC/B,MAAM8hB,EAAU9hB,EAAM+hB,QAAU/hB,EAAMye,QAAQuD,MAAQhiB,EAAMye,QAAQwD,MACpE,MAAO,CACLjG,UAAW3b,EAAAA,GAAI;;MAGf8hB,iBAAkB9hB,EAAAA,GAAI;;MAGtBiiB,UAAWjiB,EAAAA,GAAI;;;;MAKfmiB,YAAaniB,EAAAA,GAAI;;uBAEEL,EAAMoB,QAAQyG;;4BAETia;mBACT9hB,EAAMoB,QAAQqhB,OAAOziB,EAAMoB,QAAQwd,MAAM5e,EAAMoB,QAAQqhB,OAAOziB,EAAMoB,QAAQyG;yBACtE7H,EAAMoV,OAAOoJ,OAAO3W;;MAGzC0a,YAAaliB,EAAAA,GAAI;uBACEL,EAAMoB,QAAQyG;MAEjCsB,KAAM9I,EAAAA,GAAI;;MAGVwiB,OAAQxiB,EAAAA,GAAI;;oBAEIL,EAAMoB,QAAQ6a;;;qBAGbjc,EAAMM,WAAWgd,OAAOwF;mBAC1B9iB,EAAMM,WAAW8C,KAAKyE;;uBAElB7H,EAAMM,WAAWgd,OAAOyB;uBACxB/e,EAAMoB,QAAQqhB;;UAM9B,SAAS0C,GAAsBrmB,GACpC,MAAM,kBACJkkB,EADI,0BAEJC,EAFI,QAGJ7a,EAHI,kBAIJ8a,EAJI,UAKJC,EALI,qBAMJ1G,EANI,UAOJ/F,GACE5X,GAEGoL,EAAMoZ,IAAW7kB,EAAAA,EAAAA,UAAyE,CAAC,GAAI,MAC/F8kB,EAAaC,IAAkB/kB,EAAAA,EAAAA,UAAS,KACxCglB,EAAsBC,IAA2BjlB,EAAAA,EAAAA,UAAS,IAE3DuB,GAAQ8c,EAAAA,EAAAA,YACR3c,EAASoB,GAAUvB,IAEzB2jB,EAAAA,GAAAA,IACE,KACED,EAAwBH,KAE1B,IACA,CAACA,KAGHnmB,EAAAA,EAAAA,YAAU,KACR,MAAMwmB,GAAuCC,EAAAA,EAAAA,QAAOzb,EAAS,kBAAkBnG,KAAK6hB,GAAMA,EAAE5D,iBACtF6D,GAAoBC,EAAAA,EAAAA,IAAsBJ,GAC1CwB,EAAiBhd,EAAQc,QAAQ2X,IAAoB,IAAdA,EAAEM,UAC/CmC,EAAQ,EACNW,EAAAA,EAAAA,IACEmB,EACAjC,EACAH,EAAkB/gB,KAAK6hB,GAAMA,EAAEvhB,QAC/BkhB,GAEFM,MAED,CAAC3b,EAAS+a,EAAWH,EAAmBS,IAE3C,MAAOS,EAAiBH,GAAqB7Z,EAE7C,OACE,gBAAKvM,UAAWwC,EAAO6b,UAAvB,UACE,iBAAKre,UAAWwC,EAAOgiB,iBAAvB,WACE,iBAAKxkB,UAAWwC,EAAOmiB,UAAvB,WACI7F,IACA,gBAAK,aAAW,qBAAqB9e,UAAWwC,EAAOqiB,YAAvD,UACE,SAAC,EAAAoC,YAAD,CACExH,kBAAgB,EAChBtO,QAASiV,EACTxhB,MAAOygB,EACPvC,YAAY,8CACZrN,SAAU6P,OAIhB,gBAAKtlB,UAAWwC,EAAOoiB,YAAvB,UACE,SAAC,EAAAsC,YAAD,CACEpE,YAAY,iBACZle,MAAOghB,EACPnQ,SAAW7Q,IACTihB,EAAejhB,SAIrB,gBAAK,aAAW,eAAe5E,UAAWwC,EAAOgJ,KAAjD,UACE,SAAC,EAAAgU,OAAD,CACEC,kBAAgB,EAChBtO,QAASgW,GACTviB,MAAOuiB,GAAiB5b,QAAQ6b,GAAUA,EAAMxiB,QAAU4gB,IAC1D1C,YAAY,kBACZrN,SAAWsN,GAAMwC,EAAkBxC,EAAEne,cAI1C2hB,EAAgBjiB,KAAK4e,IACpB,MAAMoE,EAAMlB,EAAkBxa,WAAWua,GAAMA,EAAE3f,QAAU0c,EAAEX,iBAC7D,OACE,SAAC,GAAD,CACE3F,MAAOsG,EAEPnK,UAAWA,EACX+I,MAAOsE,EAAkBkB,GAAKC,OAC9BjH,UAAW8F,EAAkBkB,GAAKhH,WAH7B4C,EAAER,QAOb,gBAAK1iB,UAAWwC,EAAO0iB,OAAvB,sF,yHChJD,IAAKwC,I,SAAAA,GAAAA,EAAAA,YAAAA,gBAAAA,EAAAA,QAAAA,UAAAA,EAAAA,SAAAA,W,CAAAA,KAAAA,GAAAA,KAML,MAAMP,GAAmB,CAC9B,CAAE3gB,MAAO,eAAgB5B,MAAO+iB,EAAAA,GAAAA,YAChC,CAAEnhB,MAAO,eAAgB5B,MAAO+iB,EAAAA,GAAAA,WAChC,CAAEnhB,MAAO,kBAAmB5B,MAAO+iB,EAAAA,GAAAA,cACnC,CAAEnhB,MAAO,kBAAmB5B,MAAO+iB,EAAAA,GAAAA,eAqBrC,MAAMC,WAA4B3mB,EAAAA,cAChCC,YAAYC,GACVC,MAAMD,GAD6B,mCAWVyd,SACK1a,IAA1B0a,EAAgBha,QAClBnD,KAAK4Q,SAAS,CACZuM,gBAAiBA,EAAgBha,QAEnCmN,EAAAA,EAAAA,IAAU8V,EAAAA,GAAAA,gBAA2CjJ,EAAgBha,WAhBpC,sCAoBR,KAC3B,MAAMia,GAAwBpd,KAAKO,MAAM6c,qBACzCpd,KAAK4Q,SAAS,CACZwM,qBAAAA,IAEF9M,EAAAA,EAAAA,IAAU8V,EAAAA,GAAAA,qBAAgDhJ,MAzBvB,sCA4BR,KAC3B,MAAMC,GAAwBrd,KAAKO,MAAM8c,qBACzCrd,KAAK4Q,SAAS,CACZyM,qBAAAA,IAEF/M,EAAAA,EAAAA,IAAU8V,EAAAA,GAAAA,qBAAgD/I,MAjCvB,qCAoCRla,IAC3B,IACEmN,EAAAA,EAAAA,UAAgB8V,EAAAA,GAAAA,kBAA6CjjB,GAC7D,MAAOoB,GACP8hB,QAAQ9hB,MAAMA,GAKhBvE,KAAK4Q,SAAS,CAAEgT,kBAAmBzgB,OA7CA,6BAgDhB4gB,GAAyB/jB,KAAK4Q,SAAS,CAAEmT,UAAAA,MA9C5D/jB,KAAKO,MAAQ,CACXwjB,UAAWmC,EAAAA,GAAAA,WACXtC,kBAAmBtT,EAAAA,EAAAA,UAAgB8V,EAAAA,GAAAA,kBAA6C,IAChFjJ,gBAAiB7M,EAAAA,EAAAA,UAAgB8V,EAAAA,GAAAA,gBAA2C,GAC5EhJ,qBAAsB9M,EAAAA,EAAAA,QAAc8V,EAAAA,GAAAA,sBAAgD,GACpF/I,qBAAsB/M,EAAAA,EAAAA,QAAc8V,EAAAA,GAAAA,sBAAgD,IA+CxFE,gBACEtmB,KAAKO,MAAM8c,sBAAwBrd,KAAKN,MAAM6mB,yBAC1CvmB,KAAK6jB,0BAA0B,CAC7B,CAAE9e,MAAO/E,KAAKN,MAAM6mB,yBAA0BpjB,MAAOnD,KAAKN,MAAM6mB,4BAElEvmB,KAAK6jB,0BAA0B7jB,KAAKO,MAAMqjB,mBAGhD4C,oBACExmB,KAAKsmB,gBAGPG,mBAAmBC,EAA6B1V,GAE5ChR,KAAKN,MAAM6mB,2BAA6BG,EAAUH,0BAClDvmB,KAAKO,MAAM8c,uBAAyBrM,EAAUqM,sBAE9Crd,KAAKsmB,gBAIT3lB,SACE,MAAM,kBAAEijB,EAAF,UAAqBG,EAArB,qBAAgC1G,EAAhC,gBAAsDF,GAAoBnd,KAAKO,OAC/E,YAAEomB,EAAF,OAAe5b,EAAf,UAAuBuM,EAAvB,kBAAkCmG,EAAlC,QAAqDmJ,EAArD,SAA8DC,GAAa7mB,KAAKN,MAuDtF,IAAIonB,EAAO,CArDmB,CAC5B/hB,MAAO,gBACP5B,MAAO8iB,GAAKc,YACZvgB,SACE,SAACmd,GAAD,CACE3a,QAAS2d,EACT5C,UAAWA,EACXH,kBAAmBA,EACnBvG,qBAAsBA,EACtBF,gBAAiBA,EACjB2G,kBAAmB9jB,KAAK8jB,kBACxBD,0BAA2B7jB,KAAK6jB,0BAChCvM,UAAWA,EACXvM,OAAQA,IAGZuT,KAAM,WAGsB,CAC5BvZ,MAAO,UACP5B,MAAO8iB,GAAKe,QACZxgB,SACE,SAACuf,GAAD,CACE/c,QAAS2d,EACT5C,UAAWA,EACXH,kBAAmBA,EACnBvG,qBAAsBA,EACtByG,kBAAmB9jB,KAAK8jB,kBACxBD,0BAA2B7jB,KAAK6jB,0BAChCvM,UAAWA,IAGfgH,KAAM,QAGuB,CAC7BvZ,MAAO,WACP5B,MAAO8iB,GAAKgB,SACZzgB,SACE,SAAC0W,GAAD,CACEC,gBAAiBnd,KAAKO,MAAM4c,gBAC5BC,qBAAsBpd,KAAKO,MAAM6c,qBACjCC,qBAAsBrd,KAAKO,MAAM8c,qBACjCC,wBAAyBtd,KAAKsd,wBAC9BC,2BAA4Bvd,KAAKud,2BACjCC,2BAA4Bxd,KAAKknB,2BACjCzJ,kBAAmBA,IAGvBa,KAAM,kBAIR,OACE,SAAC,EAAA6I,gBAAD,CAAiBL,KAAMA,EAAMF,QAASA,EAASQ,WAAYP,EAAUQ,iBAAiB,yBAKrF,MAAMN,IAAcO,EAAAA,EAAAA,WAAUnB,IC3LrC,IACQoB,GADJC,IACID,GAAgB,SAAU7C,EAAGza,GAI7B,OAHAsd,GAAgBjT,OAAOmT,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUjD,EAAGza,GAAKya,EAAEgD,UAAYzd,IACvE,SAAUya,EAAGza,GAAK,IAAK,IAAI2d,KAAK3d,EAAOqK,OAAOuT,UAAUC,eAAeC,KAAK9d,EAAG2d,KAAIlD,EAAEkD,GAAK3d,EAAE2d,KACzFL,GAAc7C,EAAGza,IAErB,SAAUya,EAAGza,GAChB,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAI+d,UAAU,uBAAyBC,OAAOhe,GAAK,iCAE7D,SAASie,IAAOloB,KAAKP,YAAcilB,EADnC6C,GAAc7C,EAAGza,GAEjBya,EAAEmD,UAAkB,OAAN5d,EAAaqK,OAAO6T,OAAOle,IAAMie,EAAGL,UAAY5d,EAAE4d,UAAW,IAAIK,KAGnFE,GAAsC,WAStC,OARAA,GAAW9T,OAAO+T,QAAU,SAASC,GACjC,IAAK,IAAIhO,EAAGgI,EAAI,EAAGiG,EAAIC,UAAUpiB,OAAQkc,EAAIiG,EAAGjG,IAE5C,IAAK,IAAIsF,KADTtN,EAAIkO,UAAUlG,GACOhO,OAAOuT,UAAUC,eAAeC,KAAKzN,EAAGsN,KACzDU,EAAEV,GAAKtN,EAAEsN,IAEjB,OAAOU,GAEJF,GAASK,MAAMzoB,KAAMwoB,YAG5BznB,GAAS,CACT2nB,IAAK,CACD1d,MAAO,OACPD,OAAQ,OACR2d,IAAK,OACLC,KAAM,MACNC,OAAQ,cAEZC,MAAO,CACH7d,MAAO,OACPD,OAAQ,OACR2d,IAAK,MACLG,MAAO,OACPD,OAAQ,cAEZE,OAAQ,CACJ9d,MAAO,OACPD,OAAQ,OACR+d,OAAQ,OACRH,KAAM,MACNC,OAAQ,cAEZD,KAAM,CACF3d,MAAO,OACPD,OAAQ,OACR2d,IAAK,MACLC,KAAM,OACNC,OAAQ,cAEZG,SAAU,CACN/d,MAAO,OACPD,OAAQ,OACRie,SAAU,WACVH,MAAO,QACPH,IAAK,QACLE,OAAQ,aAEZK,YAAa,CACTje,MAAO,OACPD,OAAQ,OACRie,SAAU,WACVH,MAAO,QACPC,OAAQ,QACRF,OAAQ,aAEZM,WAAY,CACRle,MAAO,OACPD,OAAQ,OACRie,SAAU,WACVL,KAAM,QACNG,OAAQ,QACRF,OAAQ,aAEZO,QAAS,CACLne,MAAO,OACPD,OAAQ,OACRie,SAAU,WACVL,KAAM,QACND,IAAK,QACLE,OAAQ,cAGZQ,GAAyB,SAAUC,GAEnC,SAASD,IACL,IAAIE,EAAmB,OAAXD,GAAmBA,EAAOZ,MAAMzoB,KAAMwoB,YAAcxoB,KAOhE,OANAspB,EAAMC,YAAc,SAAUjI,GAC1BgI,EAAM5pB,MAAM8pB,cAAclI,EAAGgI,EAAM5pB,MAAM+pB,YAE7CH,EAAMI,aAAe,SAAUpI,GAC3BgI,EAAM5pB,MAAM8pB,cAAclI,EAAGgI,EAAM5pB,MAAM+pB,YAEtCH,EAKX,OAdA9B,GAAU4B,EAASC,GAWnBD,EAAQvB,UAAUlnB,OAAS,WACvB,OAAQ,gBAAoB,MAAO,CAAEpC,UAAWyB,KAAKN,MAAMnB,WAAa,GAAIsG,MAAOujB,GAASA,GAAS,CAAEY,SAAU,WAAYW,WAAY,QAAU5oB,GAAOf,KAAKN,MAAM+pB,YAAczpB,KAAKN,MAAMkqB,eAAiB,IAAML,YAAavpB,KAAKupB,YAAaG,aAAc1pB,KAAK0pB,cAAgB1pB,KAAKN,MAAM8W,WAE/R4S,EAfiB,CAgB1B,iB,qICzGE,GAAwC,WACxC,IAAI7B,EAAgB,SAAU7C,EAAGza,GAI7B,OAHAsd,EAAgBjT,OAAOmT,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUjD,EAAGza,GAAKya,EAAEgD,UAAYzd,IACvE,SAAUya,EAAGza,GAAK,IAAK,IAAI2d,KAAK3d,EAAOqK,OAAOuT,UAAUC,eAAeC,KAAK9d,EAAG2d,KAAIlD,EAAEkD,GAAK3d,EAAE2d,KACzFL,EAAc7C,EAAGza,IAE5B,OAAO,SAAUya,EAAGza,GAChB,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAI+d,UAAU,uBAAyBC,OAAOhe,GAAK,iCAE7D,SAASie,IAAOloB,KAAKP,YAAcilB,EADnC6C,EAAc7C,EAAGza,GAEjBya,EAAEmD,UAAkB,OAAN5d,EAAaqK,OAAO6T,OAAOle,IAAMie,EAAGL,UAAY5d,EAAE4d,UAAW,IAAIK,IAZ3C,GAexC,GAAsC,WAStC,OARA,GAAW5T,OAAO+T,QAAU,SAASC,GACjC,IAAK,IAAIhO,EAAGgI,EAAI,EAAGiG,EAAIC,UAAUpiB,OAAQkc,EAAIiG,EAAGjG,IAE5C,IAAK,IAAIsF,KADTtN,EAAIkO,UAAUlG,GACOhO,OAAOuT,UAAUC,eAAeC,KAAKzN,EAAGsN,KACzDU,EAAEV,GAAKtN,EAAEsN,IAEjB,OAAOU,GAEJ,GAASG,MAAMzoB,KAAMwoB,YAK5BqB,GAAe,CACf7e,MAAO,OACPD,OAAQ,QAER+e,GAAQ,MAAQ,SAAUvB,EAAGtM,EAAKD,GAAO,OAAOD,KAAKC,IAAID,KAAKE,IAAIsM,EAAGvM,GAAMC,MAC3E8N,GAAO,MAAQ,SAAUxB,EAAGvkB,GAAQ,OAAO+X,KAAKiO,MAAMzB,EAAIvkB,GAAQA,KAClEimB,GAAe,MAAQ,SAAUC,EAAKhZ,GACtC,OAAO,IAAIiZ,OAAOD,EAAK,KAAKE,KAAKlZ,MAGjCmZ,GAAe,SAAUxqB,GACzB,OAAO8Z,QAAQ9Z,EAAMyqB,SAAWzqB,EAAMyqB,QAAQlkB,SAM9CmkB,GAAkB,MAAQ,SAAUhC,EAAGiC,EAAWC,QAClC,IAAZA,IAAsBA,EAAU,GACpC,IAAIC,EAAkBF,EAAUvY,QAAO,SAAU0Y,EAAMC,EAAMzlB,GAAS,OAAQ4W,KAAK8O,IAAID,EAAOrC,GAAKxM,KAAK8O,IAAIL,EAAUG,GAAQpC,GAAKpjB,EAAQwlB,IAAU,GACjJG,EAAM/O,KAAK8O,IAAIL,EAAUE,GAAmBnC,GAChD,OAAmB,IAAZkC,GAAiBK,EAAML,EAAUD,EAAUE,GAAmBnC,KAErEwC,GAAW,MAAQ,SAAUC,EAAKC,GAClC,OAAOD,EAAIE,OAAOF,EAAI5kB,OAAS6kB,EAAU7kB,OAAQ6kB,EAAU7kB,UAAY6kB,KAEvEE,GAAgB,MAAQ,SAAU5C,GAElC,MAAU,UADVA,EAAIA,EAAE1mB,aAIFkpB,GAASxC,EAAG,OAGZwC,GAASxC,EAAG,MAGZwC,GAASxC,EAAG,OAGZwC,GAASxC,EAAG,OAGZwC,GAASxC,EAAG,SAGZwC,GAASxC,EAAG,QAjBLA,EAoBJA,EAAI,QAEX6C,GAAe,SAAUpnB,EAAMqnB,EAAYC,EAAYC,GACvD,GAAIvnB,GAAwB,iBAATA,EAAmB,CAClC,GAAI+mB,GAAS/mB,EAAM,MACf,OAAOwnB,OAAOxnB,EAAKynB,QAAQ,KAAM,KAErC,GAAIV,GAAS/mB,EAAM,KAEf,OAAOqnB,GADKG,OAAOxnB,EAAKynB,QAAQ,IAAK,KAAO,KAGhD,GAAIV,GAAS/mB,EAAM,MAEf,OAAOsnB,GADKE,OAAOxnB,EAAKynB,QAAQ,KAAM,KAAO,KAGjD,GAAIV,GAAS/mB,EAAM,MAEf,OAAOunB,GADKC,OAAOxnB,EAAKynB,QAAQ,KAAM,KAAO,KAIrD,OAAOznB,GAEP0nB,GAAkB,MAAQ,SAAUL,EAAYC,EAAYC,EAAaI,EAAUC,EAAWC,EAAUC,GAKxG,OAJAH,EAAWP,GAAaO,EAAUN,EAAWrgB,MAAOsgB,EAAYC,GAChEK,EAAYR,GAAaQ,EAAWP,EAAWtgB,OAAQugB,EAAYC,GACnEM,EAAWT,GAAaS,EAAUR,EAAWrgB,MAAOsgB,EAAYC,GAChEO,EAAYV,GAAaU,EAAWT,EAAWtgB,OAAQugB,EAAYC,GAC5D,CACHI,cAA8B,IAAbA,OAA2BlpB,EAAY+oB,OAAOG,GAC/DC,eAAgC,IAAdA,OAA4BnpB,EAAY+oB,OAAOI,GACjEC,cAA8B,IAAbA,OAA2BppB,EAAY+oB,OAAOK,GAC/DC,eAAgC,IAAdA,OAA4BrpB,EAAY+oB,OAAOM,OAGrEC,GAAe,CACf,KACA,QACA,YACA,OACA,OACA,SACA,oBACA,OACA,cACA,WACA,YACA,WACA,YACA,kBACA,4BACA,6BACA,SACA,eACA,gBACA,qBACA,qBACA,WACA,gBACA,WACA,eACA,kBACA,QACA,cACA,WAGAC,GAAgB,qBAChBC,GAA2B,SAAU5C,GAErC,SAAS4C,EAAUvsB,GACf,IAAI4pB,EAAQD,EAAOtB,KAAK/nB,KAAMN,IAAUM,KAmFxC,OAlFAspB,EAAM4C,MAAQ,EACd5C,EAAM6C,UAAY,KAElB7C,EAAM8C,WAAa,EACnB9C,EAAM+C,UAAY,EAElB/C,EAAMgD,cAAgB,EACtBhD,EAAMiD,eAAiB,EACvBjD,EAAMkD,aAAe,EACrBlD,EAAMmD,gBAAkB,EAExBnD,EAAMoD,WAAa,EACnBpD,EAAMqD,UAAY,EAClBrD,EAAMsD,WAAa,WACf,IAAKtD,EAAM6C,YAAc7C,EAAMxY,OAC3B,OAAO,KAEX,IAAI+b,EAASvD,EAAMwD,WACnB,IAAKD,EACD,OAAO,KAEX,IAAItpB,EAAU+lB,EAAMxY,OAAOic,SAASC,cAAc,OAclD,OAbAzpB,EAAQsB,MAAMmG,MAAQ,OACtBzH,EAAQsB,MAAMkG,OAAS,OACvBxH,EAAQsB,MAAMmkB,SAAW,WACzBzlB,EAAQsB,MAAMooB,UAAY,cAC1B1pB,EAAQsB,MAAM8jB,KAAO,IACrBplB,EAAQsB,MAAMqoB,KAAO,IACjB3pB,EAAQ4pB,UACR5pB,EAAQ4pB,UAAUC,IAAIpB,IAGtBzoB,EAAQhF,WAAaytB,GAEzBa,EAAOQ,YAAY9pB,GACZA,GAEX+lB,EAAMgE,WAAa,SAAU7N,GACzB,IAAIoN,EAASvD,EAAMwD,WACdD,GAGLA,EAAOU,YAAY9N,IAEvB6J,EAAM3mB,IAAM,SAAU6qB,GACdA,IACAlE,EAAM6C,UAAYqB,IAG1BlE,EAAM/oB,MAAQ,CACVktB,YAAY,EACZziB,WAA6D,KAA9Cse,EAAMoE,WAAapE,EAAMoE,UAAU1iB,OAC5C,OACAse,EAAMoE,WAAapE,EAAMoE,UAAU1iB,MACzCD,YAA+D,KAA/Cue,EAAMoE,WAAapE,EAAMoE,UAAU3iB,QAC7C,OACAue,EAAMoE,WAAapE,EAAMoE,UAAU3iB,OACzC0e,UAAW,QACXkE,SAAU,CACNC,EAAG,EACHC,EAAG,EACH7iB,MAAO,EACPD,OAAQ,GAEZ+iB,gBAAiB,CACb/iB,OAAQ,OACRC,MAAO,OACP+iB,gBAAiB,gBACjBnF,OAAQ,OACRoF,QAAS,EACThF,SAAU,QACViF,OAAQ,KACRvF,IAAK,IACLC,KAAM,IACNG,OAAQ,IACRD,MAAO,KAEXqF,eAAWzrB,GAEf6mB,EAAME,cAAgBF,EAAME,cAAc2E,KAAK7E,GAC/CA,EAAM8E,YAAc9E,EAAM8E,YAAYD,KAAK7E,GAC3CA,EAAM+E,UAAY/E,EAAM+E,UAAUF,KAAK7E,GAChCA,EA0gBX,OA/lBA,GAAU2C,EAAW5C,GAuFrB/U,OAAOga,eAAerC,EAAUpE,UAAW,aAAc,CACrDhH,IAAK,WACD,OAAK7gB,KAAKmsB,UAGHnsB,KAAKmsB,UAAUW,WAFX,MAIfyB,YAAY,EACZC,cAAc,IAElBla,OAAOga,eAAerC,EAAUpE,UAAW,SAAU,CACjDhH,IAAK,WACD,OAAK7gB,KAAKmsB,WAGLnsB,KAAKmsB,UAAUsC,cAGbzuB,KAAKmsB,UAAUsC,cAAcC,YALzB,MAOfH,YAAY,EACZC,cAAc,IAElBla,OAAOga,eAAerC,EAAUpE,UAAW,YAAa,CACpDhH,IAAK,WACD,OAAO7gB,KAAKN,MAAMsE,MAAQhE,KAAKN,MAAMivB,aAAe9E,IAExD0E,YAAY,EACZC,cAAc,IAElBla,OAAOga,eAAerC,EAAUpE,UAAW,OAAQ,CAC/ChH,IAAK,WACD,IAAI7V,EAAQ,EACRD,EAAS,EACb,GAAI/K,KAAKmsB,WAAansB,KAAK8Q,OAAQ,CAC/B,IAAI8d,EAAW5uB,KAAKmsB,UAAU0C,YAC1BC,EAAY9uB,KAAKmsB,UAAU4C,aAG3BC,EAAchvB,KAAKmsB,UAAUtnB,MAAMmkB,SACnB,aAAhBgG,IACAhvB,KAAKmsB,UAAUtnB,MAAMmkB,SAAW,YAGpChe,EAAuC,SAA/BhL,KAAKmsB,UAAUtnB,MAAMmG,MAAmBhL,KAAKmsB,UAAU0C,YAAcD,EAC7E7jB,EAAyC,SAAhC/K,KAAKmsB,UAAUtnB,MAAMkG,OAAoB/K,KAAKmsB,UAAU4C,aAAeD,EAEhF9uB,KAAKmsB,UAAUtnB,MAAMmkB,SAAWgG,EAEpC,MAAO,CAAEhkB,MAAOA,EAAOD,OAAQA,IAEnCwjB,YAAY,EACZC,cAAc,IAElBla,OAAOga,eAAerC,EAAUpE,UAAW,YAAa,CACpDhH,IAAK,WACD,IAAIyI,EAAQtpB,KACRgE,EAAOhE,KAAKN,MAAMsE,KAClBirB,EAAU,SAAUvd,GACpB,QAAgC,IAArB4X,EAAM/oB,MAAMmR,IAA6C,SAArB4X,EAAM/oB,MAAMmR,GACvD,MAAO,OAEX,GAAI4X,EAAMoE,WAAapE,EAAMoE,UAAUhc,IAAQqZ,GAASzB,EAAMoE,UAAUhc,GAAK7P,WAAY,KAAM,CAC3F,GAAIkpB,GAASzB,EAAM/oB,MAAMmR,GAAK7P,WAAY,KACtC,OAAOynB,EAAM/oB,MAAMmR,GAAK7P,WAE5B,IAAIwpB,EAAa/B,EAAM4F,gBAGvB,OAFY1D,OAAOlC,EAAM/oB,MAAMmR,GAAK7P,WAAW4pB,QAAQ,KAAM,KACtCJ,EAAW3Z,GAAQ,IACzB,IAErB,OAAOyZ,GAAc7B,EAAM/oB,MAAMmR,KAQrC,MAAO,CAAE1G,MANGhH,QAA8B,IAAfA,EAAKgH,QAA0BhL,KAAKO,MAAMktB,WAC/DtC,GAAcnnB,EAAKgH,OACnBikB,EAAQ,SAISlkB,OAHV/G,QAA+B,IAAhBA,EAAK+G,SAA2B/K,KAAKO,MAAMktB,WACjEtC,GAAcnnB,EAAK+G,QACnBkkB,EAAQ,YAGlBV,YAAY,EACZC,cAAc,IAElBvC,EAAUpE,UAAUqH,cAAgB,WAChC,IAAKlvB,KAAK8sB,WACN,OAAK9sB,KAAK8Q,OAGH,CAAE9F,MAAOhL,KAAK8Q,OAAOwa,WAAYvgB,OAAQ/K,KAAK8Q,OAAOya,aAFjD,CAAEvgB,MAAO,EAAGD,OAAQ,GAInC,IAAI0U,EAAOzf,KAAK4sB,aAChB,IAAKnN,EACD,MAAO,CAAEzU,MAAO,EAAGD,OAAQ,GAG/B,IAAIokB,GAAc,EACdC,EAAOpvB,KAAK8sB,WAAWjoB,MAAMwqB,SACpB,SAATD,IACAD,GAAc,EACdnvB,KAAK8sB,WAAWjoB,MAAMwqB,SAAW,QAGrC5P,EAAK5a,MAAMmkB,SAAW,WACtBvJ,EAAK5a,MAAMgnB,SAAW,OACtB,IAAI7nB,EAAO,CACPgH,MAAOyU,EAAKoP,YACZ9jB,OAAQ0U,EAAKsP,cAMjB,OAJII,IACAnvB,KAAK8sB,WAAWjoB,MAAMwqB,SAAWD,GAErCpvB,KAAKstB,WAAW7N,GACTzb,GAEXioB,EAAUpE,UAAUyH,WAAa,WACzBtvB,KAAK8Q,SACL9Q,KAAK8Q,OAAOye,iBAAiB,UAAWvvB,KAAKquB,WAC7CruB,KAAK8Q,OAAOye,iBAAiB,YAAavvB,KAAKouB,aAC/CpuB,KAAK8Q,OAAOye,iBAAiB,aAAcvvB,KAAKquB,WAChDruB,KAAK8Q,OAAOye,iBAAiB,YAAavvB,KAAKouB,YAAa,CACxDoB,SAAS,EACTC,SAAS,IAEbzvB,KAAK8Q,OAAOye,iBAAiB,WAAYvvB,KAAKquB,aAGtDpC,EAAUpE,UAAU6H,aAAe,WAC3B1vB,KAAK8Q,SACL9Q,KAAK8Q,OAAO6e,oBAAoB,UAAW3vB,KAAKquB,WAChDruB,KAAK8Q,OAAO6e,oBAAoB,YAAa3vB,KAAKouB,aAClDpuB,KAAK8Q,OAAO6e,oBAAoB,aAAc3vB,KAAKquB,WACnDruB,KAAK8Q,OAAO6e,oBAAoB,YAAa3vB,KAAKouB,aAAa,GAC/DpuB,KAAK8Q,OAAO6e,oBAAoB,WAAY3vB,KAAKquB,aAGzDpC,EAAUpE,UAAUrB,kBAAoB,WACpC,GAAKxmB,KAAKmsB,WAAcnsB,KAAK8Q,OAA7B,CAGA,IAAI8e,EAAgB5vB,KAAK8Q,OAAO+e,iBAAiB7vB,KAAKmsB,WACtDnsB,KAAK4Q,SAAS,CACV5F,MAAOhL,KAAKO,MAAMyK,OAAShL,KAAKgE,KAAKgH,MACrCD,OAAQ/K,KAAKO,MAAMwK,QAAU/K,KAAKgE,KAAK+G,OACvCmjB,UAAuC,SAA5B0B,EAAc1B,UAAuB0B,EAAc1B,eAAYzrB,MAGlFwpB,EAAUpE,UAAUrV,qBAAuB,WACnCxS,KAAK8Q,QACL9Q,KAAK0vB,gBAGbzD,EAAUpE,UAAUiI,yBAA2B,SAAUC,EAAS/pB,GAC9D,IAAI0nB,EAAY1tB,KAAK0tB,WAAa1tB,KAAK0tB,UAAU1nB,GACjD,MAA4B,SAArBhG,KAAKO,MAAMyF,IACdhG,KAAKO,MAAMotB,SAAS3nB,KAAU+pB,QACR,IAAdrC,GAA2C,SAAdA,EAEnCqC,EADA,QAGV9D,EAAUpE,UAAUmI,4BAA8B,SAAUrE,EAAUC,GAClE,IAIIqE,EACAC,EALAC,EAAoBnwB,KAAKN,MAAMywB,kBAC/B1G,EAAYzpB,KAAKO,MAAMkpB,UACvB2G,EAAmBD,GAAqBlG,GAAa,OAAQR,GAC7D4G,EAAoBF,GAAqBlG,GAAa,MAAOR,GAGjE,GAA0B,WAAtBzpB,KAAKN,MAAM4wB,OAAqB,CAChC,IAAIC,EAAWvwB,KAAK8sB,WAChByD,IACAN,EAAaG,EACPpwB,KAAKusB,eAAiBvsB,KAAKosB,WAC3BmE,EAAS1B,aAAe7uB,KAAKosB,WAAapsB,KAAKssB,eACrD4D,EAAcG,EACRrwB,KAAKysB,gBAAkBzsB,KAAKqsB,UAC5BkE,EAASxB,cAAgB/uB,KAAKqsB,UAAYrsB,KAAKwsB,mBAG9B,WAAtBxsB,KAAKN,MAAM4wB,OACZtwB,KAAK8Q,SACLmf,EAAaG,EAAmBpwB,KAAKusB,eAAiBvsB,KAAK8Q,OAAOwa,WAAatrB,KAAKssB,cACpF4D,EAAcG,EAAoBrwB,KAAKysB,gBAAkBzsB,KAAK8Q,OAAOya,YAAcvrB,KAAKwsB,cAGvFxsB,KAAKN,MAAM4wB,SAChBL,EAAaG,EACPpwB,KAAKusB,eAAiBvsB,KAAK0sB,WAC3B1sB,KAAKN,MAAM4wB,OAAOzB,aAAe7uB,KAAK0sB,WAAa1sB,KAAKssB,eAC9D4D,EAAcG,EACRrwB,KAAKysB,gBAAkBzsB,KAAK2sB,UAC5B3sB,KAAKN,MAAM4wB,OAAOvB,cAAgB/uB,KAAK2sB,UAAY3sB,KAAKwsB,eAQlE,OANIyD,GAAczE,OAAOgF,SAASP,KAC9BtE,EAAWA,GAAYA,EAAWsE,EAAatE,EAAWsE,GAE1DC,GAAe1E,OAAOgF,SAASN,KAC/BtE,EAAYA,GAAaA,EAAYsE,EAActE,EAAYsE,GAE5D,CAAEvE,SAAUA,EAAUC,UAAWA,IAE5CK,EAAUpE,UAAU4I,8BAAgC,SAAUC,EAASC,GACnE,IAAIC,EAAQ5wB,KAAKN,MAAMkxB,OAAS,EAC5BC,EAAc7wB,KAAKN,MAAMmxB,aAAe,EACxCC,EAAK9wB,KAAKO,MAAOkpB,EAAYqH,EAAGrH,UAAWkE,EAAWmD,EAAGnD,SACzDoD,EAAK/wB,KAAKN,MAAOsxB,EAAkBD,EAAGC,gBAAiBC,EAA6BF,EAAGE,2BAA4BC,EAA4BH,EAAGG,0BAClJC,EAAWxD,EAAS3iB,MACpBomB,EAAYzD,EAAS5iB,OACrBsmB,EAAcJ,GAA8B,EAC5CK,EAAaJ,GAA6B,EAyB9C,OAxBIjH,GAAa,QAASR,KACtB0H,EAAWxD,EAAS3iB,OAAU0lB,EAAU/C,EAASC,GAAKiD,EAAeD,EACjEI,IACAI,GAAaD,EAAWG,GAActxB,KAAKksB,MAAQmF,IAGvDpH,GAAa,OAAQR,KACrB0H,EAAWxD,EAAS3iB,OAAU0lB,EAAU/C,EAASC,GAAKiD,EAAeD,EACjEI,IACAI,GAAaD,EAAWG,GAActxB,KAAKksB,MAAQmF,IAGvDpH,GAAa,SAAUR,KACvB2H,EAAYzD,EAAS5iB,QAAW4lB,EAAUhD,EAASE,GAAKgD,EAAeD,EACnEI,IACAG,GAAYC,EAAYC,GAAerxB,KAAKksB,MAAQoF,IAGxDrH,GAAa,MAAOR,KACpB2H,EAAYzD,EAAS5iB,QAAW4lB,EAAUhD,EAASE,GAAKgD,EAAeD,EACnEI,IACAG,GAAYC,EAAYC,GAAerxB,KAAKksB,MAAQoF,IAGrD,CAAEH,SAAUA,EAAUC,UAAWA,IAE5CnF,EAAUpE,UAAU0J,gCAAkC,SAAUJ,EAAUC,EAAWpV,EAAKC,GACtF,IAAI6U,EAAK9wB,KAAKN,MAAOsxB,EAAkBF,EAAGE,gBAAiBC,EAA6BH,EAAGG,2BAA4BC,EAA4BJ,EAAGI,0BAClJM,OAAwC,IAAdvV,EAAIjR,MAAwB,GAAKiR,EAAIjR,MAC/DymB,OAAwC,IAAdzV,EAAIhR,OAAyBgR,EAAIhR,MAAQ,EAAImmB,EAAWnV,EAAIhR,MACtF0mB,OAA0C,IAAfzV,EAAIlR,OAAyB,GAAKkR,EAAIlR,OACjE4mB,OAA0C,IAAf3V,EAAIjR,QAA0BiR,EAAIjR,OAAS,EAAIqmB,EAAYpV,EAAIjR,OAC1FsmB,EAAcJ,GAA8B,EAC5CK,EAAaJ,GAA6B,EAC9C,GAAIF,EAAiB,CACjB,IAAIY,GAAiBF,EAAoBL,GAAerxB,KAAKksB,MAAQoF,EACjEO,GAAiBF,EAAoBN,GAAerxB,KAAKksB,MAAQoF,EACjEQ,GAAkBN,EAAmBF,GAActxB,KAAKksB,MAAQmF,EAChEU,GAAkBN,EAAmBH,GAActxB,KAAKksB,MAAQmF,EAChEW,EAAiBjW,KAAKC,IAAIwV,EAAkBI,GAC5CK,EAAiBlW,KAAKE,IAAIwV,EAAkBI,GAC5CK,EAAkBnW,KAAKC,IAAI0V,EAAmBI,GAC9CK,EAAkBpW,KAAKE,IAAI0V,EAAmBI,GAClDZ,EAAWrH,GAAMqH,EAAUa,EAAgBC,GAC3Cb,EAAYtH,GAAMsH,EAAWc,EAAiBC,QAG9ChB,EAAWrH,GAAMqH,EAAUK,EAAkBC,GAC7CL,EAAYtH,GAAMsH,EAAWM,EAAmBC,GAEpD,MAAO,CAAER,SAAUA,EAAUC,UAAWA,IAE5CnF,EAAUpE,UAAUuK,sBAAwB,WAExC,GAA0B,WAAtBpyB,KAAKN,MAAM4wB,OAAqB,CAChC,IAAI+B,EAAWryB,KAAK8sB,WACpB,GAAIuF,EAAU,CACV,IAAIC,EAAaD,EAASE,wBAC1BvyB,KAAKosB,WAAakG,EAAW3J,KAC7B3oB,KAAKqsB,UAAYiG,EAAW5J,KAIpC,GAAI1oB,KAAKN,MAAM4wB,QAAuC,iBAAtBtwB,KAAKN,MAAM4wB,OAAqB,CAC5D,IAAIkC,EAAaxyB,KAAKN,MAAM4wB,OAAOiC,wBACnCvyB,KAAK0sB,WAAa8F,EAAW7J,KAC7B3oB,KAAK2sB,UAAY6F,EAAW9J,IAGhC,GAAI1oB,KAAKmsB,UAAW,CAChB,IAAI2E,EAAK9wB,KAAKmsB,UAAUoG,wBAAyB5J,EAAOmI,EAAGnI,KAAM8J,EAAQ3B,EAAGpI,IAAKG,EAAQiI,EAAGjI,MAAOC,EAASgI,EAAGhI,OAC/G9oB,KAAKssB,cAAgB3D,EACrB3oB,KAAKusB,eAAiB1D,EACtB7oB,KAAKwsB,aAAeiG,EACpBzyB,KAAKysB,gBAAkB3D,IAG/BmD,EAAUpE,UAAU2B,cAAgB,SAAU3pB,EAAO4pB,GACjD,GAAKzpB,KAAKmsB,WAAcnsB,KAAK8Q,OAA7B,CAGA,IA8BIod,EA9BAwC,EAAU,EACVC,EAAU,EASd,GARI9wB,EAAM6yB,aAneC,SAAU7yB,GACzB,OAAO8Z,SAAS9Z,EAAM6wB,SAA6B,IAAlB7wB,EAAM6wB,WAClC7wB,EAAM8wB,SAA6B,IAAlB9wB,EAAM8wB,UAieCgC,CAAa9yB,EAAM6yB,cACxChC,EAAU7wB,EAAM6yB,YAAYhC,QAC5BC,EAAU9wB,EAAM6yB,YAAY/B,SAEvB9wB,EAAM6yB,aAAerI,GAAaxqB,EAAM6yB,eAC7ChC,EAAU7wB,EAAM6yB,YAAYpI,QAAQ,GAAGoG,QACvCC,EAAU9wB,EAAM6yB,YAAYpI,QAAQ,GAAGqG,SAEvC3wB,KAAKN,MAAM8pB,cACX,GAAIxpB,KAAKmsB,UAEL,IAAoB,IADFnsB,KAAKN,MAAM8pB,cAAc3pB,EAAO4pB,EAAWzpB,KAAKmsB,WAE9D,OAKRnsB,KAAKN,MAAMsE,YAC2B,IAA3BhE,KAAKN,MAAMsE,KAAK+G,QAA0B/K,KAAKN,MAAMsE,KAAK+G,SAAW/K,KAAKO,MAAMwK,QACvF/K,KAAK4Q,SAAS,CAAE7F,OAAQ/K,KAAKN,MAAMsE,KAAK+G,cAEP,IAA1B/K,KAAKN,MAAMsE,KAAKgH,OAAyBhL,KAAKN,MAAMsE,KAAKgH,QAAUhL,KAAKO,MAAMyK,OACrFhL,KAAK4Q,SAAS,CAAE5F,MAAOhL,KAAKN,MAAMsE,KAAKgH,SAI/ChL,KAAKksB,MACqC,iBAA/BlsB,KAAKN,MAAMsxB,gBAA+BhxB,KAAKN,MAAMsxB,gBAAkBhxB,KAAKgE,KAAKgH,MAAQhL,KAAKgE,KAAK+G,OAE9G,IAAI6kB,EAAgB5vB,KAAK8Q,OAAO+e,iBAAiB7vB,KAAKmsB,WACtD,GAAgC,SAA5ByD,EAAc1B,UAAsB,CACpC,IAAI0E,EAAW5yB,KAAK8sB,WACpB,GAAI8F,EAAU,CACV,IAAI1I,EAAMlqB,KAAK8Q,OAAO+e,iBAAiB+C,GAAUC,cACjD7yB,KAAK8yB,QAAU5I,EAAI6I,WAAW,OAAS,MAAQ,SAC/C7E,EAAY0B,EAAc1B,WAIlCluB,KAAKoyB,wBACLpyB,KAAKsvB,aACL,IAAI/uB,EAAQ,CACRotB,SAAU,CACNC,EAAG8C,EACH7C,EAAG8C,EACH3lB,MAAOhL,KAAKgE,KAAKgH,MACjBD,OAAQ/K,KAAKgE,KAAK+G,QAEtB0iB,YAAY,EACZK,gBAAiB,GAAS,GAAS,GAAI9tB,KAAKO,MAAMutB,iBAAkB,CAAElF,OAAQ5oB,KAAK8Q,OAAO+e,iBAAiBhwB,EAAMqR,QAAQ0X,QAAU,SACnIa,UAAWA,EACXyE,UAAWA,GAEfluB,KAAK4Q,SAASrQ,KAElB0rB,EAAUpE,UAAUuG,YAAc,SAAUvuB,GACxC,GAAKG,KAAKO,MAAMktB,YAAeztB,KAAKmsB,WAAcnsB,KAAK8Q,OAAvD,CAGA,GAAI9Q,KAAK8Q,OAAOkiB,YAAc3I,GAAaxqB,GACvC,IACIA,EAAM0R,iBACN1R,EAAMozB,kBAEV,MAAO3R,IAIX,IAAIwP,EAAK9wB,KAAKN,MAAOisB,EAAWmF,EAAGnF,SAAUC,EAAYkF,EAAGlF,UAAWC,EAAWiF,EAAGjF,SAAUC,EAAYgF,EAAGhF,UAC1G4E,EAAUrG,GAAaxqB,GAASA,EAAMyqB,QAAQ,GAAGoG,QAAU7wB,EAAM6wB,QACjEC,EAAUtG,GAAaxqB,GAASA,EAAMyqB,QAAQ,GAAGqG,QAAU9wB,EAAM8wB,QACjEI,EAAK/wB,KAAKO,MAAOkpB,EAAYsH,EAAGtH,UAAWkE,EAAWoD,EAAGpD,SAAU3iB,EAAQ+lB,EAAG/lB,MAAOD,EAASgmB,EAAGhmB,OACjGsgB,EAAarrB,KAAKkvB,gBAClBlT,EAAM0P,GAAgBL,EAAYrrB,KAAK8Q,OAAOwa,WAAYtrB,KAAK8Q,OAAOya,YAAaI,EAAUC,EAAWC,EAAUC,GACtHH,EAAW3P,EAAI2P,SACfC,EAAY5P,EAAI4P,UAChBC,EAAW7P,EAAI6P,SACfC,EAAY9P,EAAI8P,UAEhB,IAAIoH,EAAKlzB,KAAKywB,8BAA8BC,EAASC,GAAUS,EAAY8B,EAAG9B,UAAWD,EAAW+B,EAAG/B,SAEnGgC,EAAcnzB,KAAKgwB,4BAA4BrE,EAAUC,GAEzDmE,EAAU/vB,KAAKuxB,gCAAgCJ,EAAUC,EAAW,CAAEpmB,MAAOmoB,EAAYxH,SAAU5gB,OAAQooB,EAAYvH,WAAa,CAAE5gB,MAAO6gB,EAAU9gB,OAAQ+gB,IAGnK,GAFAqF,EAAWpB,EAAQoB,SACnBC,EAAYrB,EAAQqB,UAChBpxB,KAAKN,MAAM0zB,KAAM,CACjB,IAAIC,EAAetJ,GAAKoH,EAAUnxB,KAAKN,MAAM0zB,KAAK,IAC9CE,EAAgBvJ,GAAKqH,EAAWpxB,KAAKN,MAAM0zB,KAAK,IAChDtI,EAAM9qB,KAAKN,MAAM+qB,SAAW,EAChC0G,EAAmB,IAARrG,GAAa/O,KAAK8O,IAAIwI,EAAelC,IAAarG,EAAMuI,EAAelC,EAClFC,EAAoB,IAARtG,GAAa/O,KAAK8O,IAAIyI,EAAgBlC,IAActG,EAAMwI,EAAgBlC,EAEtFpxB,KAAKN,MAAMqqB,MAAQ/pB,KAAKN,MAAMqqB,KAAK6D,IACnCuD,EAAW5G,GAAgB4G,EAAUnxB,KAAKN,MAAMqqB,KAAK6D,EAAG5tB,KAAKN,MAAM+qB,UAEnEzqB,KAAKN,MAAMqqB,MAAQ/pB,KAAKN,MAAMqqB,KAAK8D,IACnCuD,EAAY7G,GAAgB6G,EAAWpxB,KAAKN,MAAMqqB,KAAK8D,EAAG7tB,KAAKN,MAAM+qB,UAEzE,IAAI8I,EAAQ,CACRvoB,MAAOmmB,EAAWxD,EAAS3iB,MAC3BD,OAAQqmB,EAAYzD,EAAS5iB,QAEjC,GAAIC,GAA0B,iBAAVA,EAChB,GAAI+f,GAAS/f,EAAO,KAEhBmmB,EADeA,EAAW9F,EAAWrgB,MAAS,IACzB,SAEpB,GAAI+f,GAAS/f,EAAO,MAAO,CAE5BmmB,EADUA,EAAWnxB,KAAK8Q,OAAOwa,WAAc,IAC/B,UAEf,GAAIP,GAAS/f,EAAO,MAAO,CAE5BmmB,EADUA,EAAWnxB,KAAK8Q,OAAOya,YAAe,IAChC,KAGxB,GAAIxgB,GAA4B,iBAAXA,EACjB,GAAIggB,GAAShgB,EAAQ,KAEjBqmB,EADeA,EAAY/F,EAAWtgB,OAAU,IAC1B,SAErB,GAAIggB,GAAShgB,EAAQ,MAAO,CAE7BqmB,EADUA,EAAYpxB,KAAK8Q,OAAOwa,WAAc,IAC/B,UAEhB,GAAIP,GAAShgB,EAAQ,MAAO,CAE7BqmB,EADUA,EAAYpxB,KAAK8Q,OAAOya,YAAe,IAChC,KAGzB,IAAIiI,EAAW,CACXxoB,MAAOhL,KAAK8vB,yBAAyBqB,EAAU,SAC/CpmB,OAAQ/K,KAAK8vB,yBAAyBsB,EAAW,WAEhC,QAAjBpxB,KAAK8yB,QACLU,EAAStF,UAAYsF,EAASxoB,MAER,WAAjBhL,KAAK8yB,UACVU,EAAStF,UAAYsF,EAASzoB,QAElC/K,KAAK4Q,SAAS4iB,GACVxzB,KAAKN,MAAM+zB,UACXzzB,KAAKN,MAAM+zB,SAAS5zB,EAAO4pB,EAAWzpB,KAAKmsB,UAAWoH,KAG9DtH,EAAUpE,UAAUwG,UAAY,SAAUxuB,GACtC,IAAIixB,EAAK9wB,KAAKO,MAAOktB,EAAaqD,EAAGrD,WAAYhE,EAAYqH,EAAGrH,UAAWkE,EAAWmD,EAAGnD,SACzF,GAAKF,GAAeztB,KAAKmsB,UAAzB,CAGA,IAAIoH,EAAQ,CACRvoB,MAAOhL,KAAKgE,KAAKgH,MAAQ2iB,EAAS3iB,MAClCD,OAAQ/K,KAAKgE,KAAK+G,OAAS4iB,EAAS5iB,QAEpC/K,KAAKN,MAAMg0B,cACX1zB,KAAKN,MAAMg0B,aAAa7zB,EAAO4pB,EAAWzpB,KAAKmsB,UAAWoH,GAE1DvzB,KAAKN,MAAMsE,MACXhE,KAAK4Q,SAAS5Q,KAAKN,MAAMsE,MAE7BhE,KAAK0vB,eACL1vB,KAAK4Q,SAAS,CACV6c,YAAY,EACZK,gBAAiB,GAAS,GAAS,GAAI9tB,KAAKO,MAAMutB,iBAAkB,CAAElF,OAAQ,aAGtFqD,EAAUpE,UAAU8L,WAAa,SAAU3vB,GACvChE,KAAK4Q,SAAS,CAAE5F,MAAOhH,EAAKgH,MAAOD,OAAQ/G,EAAK+G,UAEpDkhB,EAAUpE,UAAU+L,cAAgB,WAChC,IAAItK,EAAQtpB,KACR8wB,EAAK9wB,KAAKN,MAAOm0B,EAAS/C,EAAG+C,OAAQC,EAAehD,EAAGgD,aAAcC,EAAgBjD,EAAGiD,cAAeC,EAAqBlD,EAAGkD,mBAAoBC,EAAqBnD,EAAGmD,mBAAoBC,EAAkBpD,EAAGoD,gBACxN,IAAKL,EACD,OAAO,KAEX,IAAIM,EAAW7f,OAAOsR,KAAKiO,GAAQhxB,KAAI,SAAUqnB,GAC7C,OAAoB,IAAhB2J,EAAO3J,GACC,gBAAoBd,GAAS,CAAE1X,IAAKwY,EAAKT,UAAWS,EAAKV,cAAeF,EAAME,cAAeI,cAAekK,GAAgBA,EAAa5J,GAAM3rB,UAAWw1B,GAAiBA,EAAc7J,IAAQgK,GAAmBA,EAAgBhK,GAAOgK,EAAgBhK,GAAO,MAEvQ,QAGX,OAAQ,gBAAoB,MAAO,CAAE3rB,UAAW01B,EAAoBpvB,MAAOmvB,GAAsBG,IAErGlI,EAAUpE,UAAUlnB,OAAS,WACzB,IAAI2oB,EAAQtpB,KACRo0B,EAAe9f,OAAOsR,KAAK5lB,KAAKN,OAAOuS,QAAO,SAAUoiB,EAAK3iB,GAC7D,OAAmC,IAA/Bqa,GAAapa,QAAQD,KAGzB2iB,EAAI3iB,GAAO4X,EAAM5pB,MAAMgS,IAFZ2iB,IAIZ,IACCxvB,EAAQ,GAAS,GAAS,GAAS,CAAEmkB,SAAU,WAAYW,WAAY3pB,KAAKO,MAAMktB,WAAa,OAAS,QAAUztB,KAAKN,MAAMmF,OAAQ7E,KAAKs0B,WAAY,CAAE3I,SAAU3rB,KAAKN,MAAMisB,SAAUC,UAAW5rB,KAAKN,MAAMksB,UAAWC,SAAU7rB,KAAKN,MAAMmsB,SAAUC,UAAW9rB,KAAKN,MAAMosB,UAAWyI,UAAW,aAAcC,WAAY,IAC7Tx0B,KAAKO,MAAM2tB,YACXrpB,EAAMqpB,UAAYluB,KAAKO,MAAM2tB,WAEjC,IAAIuG,EAAUz0B,KAAKN,MAAMg1B,IAAM,MAC/B,OAAQ,gBAAoBD,EAAS,GAAS,CAAE9xB,IAAK3C,KAAK2C,IAAKkC,MAAOA,EAAOtG,UAAWyB,KAAKN,MAAMnB,WAAa61B,GAC5Gp0B,KAAKO,MAAMktB,YAAc,gBAAoB,MAAO,CAAE5oB,MAAO7E,KAAKO,MAAMutB,kBACxE9tB,KAAKN,MAAM8W,SACXxW,KAAK4zB,kBAEb3H,EAAU0I,aAAe,CACrBD,GAAI,MACJlL,cAAe,aACfiK,SAAU,aACVC,aAAc,aACdG,OAAQ,CACJnL,KAAK,EACLG,OAAO,EACPC,QAAQ,EACRH,MAAM,EACNI,UAAU,EACVE,aAAa,EACbC,YAAY,EACZC,SAAS,GAEbtkB,MAAO,GACPuuB,KAAM,CAAC,EAAG,GACVpC,iBAAiB,EACjBE,0BAA2B,EAC3BD,2BAA4B,EAC5BL,MAAO,EACPC,YAAa,EACbpG,QAAS,GAENwB,EAhmBmB,CAimB5B,iBCvuBF,MAAM2I,GAAcC,EAAAA,SAAU;;;;;;;;EAUxB1yB,IAAYwa,EAAAA,EAAAA,gBAAe/b,IACxB,CACLgc,UAAW3b,EAAAA,GAAI;;;oBAGCL,EAAMW,OAAO8G,WAAWC;8BACd1H,EAAMW,OAAOyU,OAAO8e;gBAClCl0B,EAAMoB,QAAQ,GAAI,EAAG,GAAI;oBACrBpB,EAAMm0B,QAAQC;iBACjBp0B,EAAMqtB,OAAOgH;MAE1BC,aAAcj0B,EAAAA,GAAI;;iCAEW2zB;MAE7BO,SAAUl0B,EAAAA,GAAI;oBACEL,EAAMW,OAAO8C,UAAUkE;;;;;;;;;;sBAUrB3H,EAAMW,OAAO8C,UAAU+wB;;UAYtC,SAASC,GAAc31B,GAC5B,MAAM,MAAEsL,EAAF,SAASwL,EAAT,SAAmBid,GAAa/zB,EAChCkB,GAAQ+G,EAAAA,EAAAA,aACR5G,EAASoB,GAAUvB,GACnB00B,EAAe,GAAEtqB,EAAQ,SAE/B,OACE,SAACihB,GAAD,CACE1tB,WAAWmE,EAAAA,EAAAA,IAAG3B,EAAO6b,UAAW7b,EAAOm0B,cACvCvG,YAAa,CAAE3jB,MAAOsqB,EAAavqB,OAAQ,SAC3CgpB,cAAe,CAAErL,IAAK3nB,EAAOo0B,UAC7BtB,OAAQ,CACNnL,KAAK,EACLG,OAAO,EACPC,QAAQ,EACRH,MAAM,EACNI,UAAU,EACVE,aAAa,EACbC,YAAY,EACZC,SAAS,GAEXyC,UAAU,QACVD,SAAU2J,EACVzJ,SAAUyJ,EACV7B,SAAUA,EAjBZ,SAmBGjd,IClDP,MAAMyC,GAAqB,CACzBwE,kBAAiBA,GAAAA,IAGb/B,IAAYxC,EAAAA,EAAAA,UApBlB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MAAM6B,EAAU5Y,EAAM4Y,QAEhBjU,EAAyBiU,EAAQ7B,IACjC,mBAAEgB,GAAuBpT,EACzB2hB,EAAWvW,EAAAA,EAAAA,QAAc8V,EAAAA,GAAAA,sBAAgD,GAC3EH,GAAKe,QACLf,GAAKc,aACH,YAAEJ,GAAgBxN,EACxB,MAAO,CACLwN,YAAAA,EACAE,SAAAA,EACAN,yBAA0BjO,MAAAA,OAAF,EAAEA,EAAoBxU,QAQPmV,IAkC3C,SAAeyC,IAzBR,SAA8Bhc,GACnC,MAAOqL,EAAQwqB,IAAal2B,EAAAA,EAAAA,UAAS,MAE/B,YAAEsnB,EAAF,MAAe3b,EAAf,SAAsB6b,EAAtB,yBAAgCN,EAAhC,UAA0DjP,EAA1D,kBAAqEmG,EAArE,QAAwFmJ,GAAYlnB,EAE1G,OACE,SAAC21B,GAAD,CACErqB,MAAOA,EACPyoB,SAAU,CAAC+B,EAAIC,EAAM9yB,KACnB4yB,EAAU/J,OAAO7oB,EAAIkC,MAAMkG,OAAOvK,MAAM,GAAI,MAHhD,UAME,SAACumB,GAAD,CACEJ,YAAaA,EACbE,SAAUA,EACVN,yBAA0BA,EAC1BjP,UAAWA,EACXmG,kBAAmBA,EACnBmJ,QAASA,EACT7b,OAAQA,S,6SCuBhB,MAAMkO,GAAqB,CACzBjB,WAAUA,EAAAA,IAKZ,IAFkBkB,EAAAA,EAAAA,UAflB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MACMpS,EADU3E,EAAM4Y,QACiB7B,IACjC,QAAEtQ,EAAF,cAAWuT,GAAkBrV,EAEnC,MAAO,CACL8B,QAAAA,EACAuT,cAAAA,KAQuCtB,GAE3C,EA1EO,SAA+BvZ,GAAc,MAClD,MAAM,QAAEsH,EAAF,MAAWgE,EAAX,QAAkB4b,EAAlB,cAA2BrM,EAA3B,SAA0C1Z,GAAanB,EACvDg2B,GAAanb,MAAAA,OAAA,EAAAA,EAAehL,SAAU,GACtChL,EAAQgW,MAAAA,OAAH,EAAGA,EAAehW,MAEvBoxB,EAAsB,CAC1B5wB,MAAO,QACP5B,MAAO,QACPmb,KAAM,aACN9X,SAAS,SAACovB,GAAA,EAAD,CAAiB9qB,KAAMyP,EAAgB1Z,SAAU0Z,MAAAA,GAAF,UAAEA,EAAesb,eAAjB,aAAE,EAAwBC,YAG9EC,EAAqB,CACzBhxB,MAAO,OACP5B,MAAO,OACPmb,KAAM,iBACN9X,SAAS,SAACwvB,GAAA,EAAD,CAAgBlrB,KAAMyP,EAAeqM,QAASA,KAGnDqP,EAAqB,CACzBlxB,MAAO,OACP5B,MAAO,OACPmb,KAAM,WACN9X,SACE,SAAC0vB,GAAA,EAAD,CACEprB,KAAM4qB,EACNS,UAAWnvB,EACX0I,QAAS,CAAE0mB,gBAAgB,EAAOC,iBAAiB,GACnDx1B,SAAUA,KAYVimB,EAAO,CAAC6O,EAPc,CAC1B5wB,MAAO,QACP5B,MAAO,QACPmb,KAAM,cACN9X,SAAS,SAAC8vB,GAAA,EAAD,CAAgBxrB,KAAM4qB,EAAYa,eAAgB,IAAM72B,EAAMsY,WAAWtY,EAAM4X,cAGxDye,EAASE,GAC3C,GAAI1xB,EAAO,CACT,MAAMiyB,EAAsB,CAC1BzxB,MAAO,QACP5B,MAAO,QACPmb,KAAM,uBACN9X,SAAS,SAACiwB,GAAA,EAAD,CAAiBlyB,MAAOA,KAEnCuiB,EAAK/gB,KAAKywB,GAEZ,OACE,SAACnB,GAAD,CAAerqB,MAAOA,EAAOyoB,SAAU,OAAvC,UACE,SAAC,EAAAtM,gBAAD,CAAiBL,KAAMA,EAAMF,QAASA,EAASS,iBAAiB,+B,4DClE/D,SAASqP,GAAeh3B,GAC7B,MAAM,QAAEkE,EAAF,SAAW+yB,GAAaj3B,EAQ9B,OACE,SAAC,EAAA6G,QAAD,CAASC,QAPc,KACvB,MAAM,SAAEmwB,GAAaj3B,EACfiQ,EAAUgnB,EAAW,mBAAqB,oCAChD,OAAO,8BAAGhnB,KAI0BlJ,UAAU,SAA9C,UACE,SAAC,EAAAmwB,cAAD,CACEtY,KAAK,OACL3a,QAASgzB,EAAW,SAAW,UAC/B,aAAYA,EAAW,eAAiB,iBACxC/yB,QAASA,M,qPCOV,MAAMizB,WAA4BC,EAAAA,UAAiB,0DACpCrN,IAClB,MAAM,MAAE9Q,EAAF,aAAS9P,EAAT,SAAuBhI,GAAab,KAAKN,OACzC,KAAE+H,EAAF,GAAQC,IAAOqvB,EAAAA,GAAAA,GAAoBtN,EAAW9Q,GAMpD9P,EALsB,CACpBpB,MAAMuvB,EAAAA,EAAAA,qBAAoBn2B,EAAU4G,GACpCC,IAAIsvB,EAAAA,EAAAA,qBAAoBn2B,EAAU6G,QANkB,yBAYxC,IAAM1H,KAAKi3B,iBAAiB,KAZY,sBAa3C,IAAMj3B,KAAKi3B,kBAAkB,KAbc,8BAelCnqB,IACpB,MAAMoqB,EAAeC,EAAAA,SAAAA,aAAsBrqB,EAAU1J,IAAIqE,MAAQqF,EAAU1J,IAAIqE,KAAOqF,EAAUrF,KAC1F2vB,EAAaD,EAAAA,SAAAA,aAAsBrqB,EAAU1J,IAAIsE,IAAMoF,EAAU1J,IAAIsE,GAAKoF,EAAUpF,GAE1F1H,KAAKN,MAAMmJ,aAAa,CACtBpB,KAAMyvB,EACNxvB,GAAI0vB,OArBgD,kBAyB/C,KACP,MAAM,MAAEze,EAAF,aAAS9P,EAAT,SAAuBhI,GAAab,KAAKN,OACzC,KAAE+H,EAAF,GAAQC,IAAO2vB,EAAAA,GAAAA,GAAmB1e,EAAO,GAM/C9P,EALsB,CACpBpB,MAAMuvB,EAAAA,EAAAA,qBAAoBn2B,EAAU4G,GACpCC,IAAIsvB,EAAAA,EAAAA,qBAAoBn2B,EAAU6G,QAMtC/G,SACE,MAAM,MACJgY,EADI,SAEJ9X,EAFI,qBAGJy2B,EAHI,SAIJC,EAJI,YAKJC,EALI,iBAMJC,EANI,SAOJC,EAPI,iBAQJC,EARI,6BASJC,GACE53B,KAAKN,MACHm4B,EAAiBN,GAAW,SAACb,GAAD,CAAgB9yB,QAAS6zB,EAAkBd,SAAUa,SAAkB/0B,EACnGq1B,EAAwB,CAC5B30B,MAAOwV,EACP9X,SAAAA,EACAy2B,qBAAAA,EACAS,eAAgB/3B,KAAKg4B,WACrBC,cAAej4B,KAAKi4B,cACpBC,OAAQl4B,KAAKk4B,OACbR,SAAAA,GAGF,OACE,SAACS,GAAA,EAAD,iBACML,EADN,CAEED,eAAgBA,EAChBlB,SAAUa,EACVxjB,SAAUhU,KAAKo4B,mBACfT,iBAAkBA,EAClBC,6BAA8BA,MCjF/B,SAASS,GAAe34B,GAC7B,MAAM,MAAEuY,EAAF,MAASR,EAAT,OAAgBG,EAAhB,OAAwBiB,EAAxB,SAAgC/Y,EAAhC,KAA0C+X,EAA1C,SAAgD0f,GAAa73B,EAC7D44B,EAAgBzf,IAAW/Y,EAAW,SAAW,UACjDy4B,EAAc1f,EAAU/Y,EAAW8X,EAASH,EAASQ,EAE3D,OACE,UAAC,EAAAugB,YAAD,YACE,SAAC,EAAAjyB,QAAD,CACEC,QAASqS,IAAW/Y,GAAW,yDAA6B,8DAC5D2G,UAAU,SAFZ,UAIE,SAAC,EAAAmwB,cAAD,CACE6B,SAAUlB,EACV5zB,QAAS20B,EACTha,MAAOzF,GAAU/Y,EAAW,OAAS,QACrC8D,QAAS20B,EAJX,SAMG1f,GAAU/Y,EAAW,SAAW,YAIrC,SAAC2W,GAAA,EAAD,CACEE,cAAc,EACdC,eAAe,EACfC,QAAS,IACTH,GAAImC,EACJ9B,WAAY,CACVC,MAAOjW,GAAO23B,gBACdzhB,YAAalW,GAAO43B,sBACpBzhB,KAAMnW,GAAO63B,eACbzhB,WAAYpW,GAAO83B,sBATvB,UAYE,SAAC,EAAAtyB,QAAD,CAASC,SAAS,gEAAoCC,UAAU,SAAhE,UACE,SAAC,EAAAmwB,cAAD,CAAejzB,QAAS20B,EAAe10B,QAASiU,EAAMyG,KAAK,wBAOrE,MAAMvd,GAAS,CACb23B,gBAAiBz3B,EAAAA,GAAI;;;;;IAMrB03B,sBAAuB13B,EAAAA,GAAI;;;;IAK3B23B,eAAgB33B,EAAAA,GAAI;;;;;IAMpB43B,qBAAsB53B,EAAAA,GAAI;;;;qEC5DrB,SAAS63B,GAAUp5B,GACxB,MAAM,QAAEq5B,EAAF,QAAW/xB,EAAX,MAAoBgyB,EAApB,wBAA2BC,EAA3B,gBAAoDC,EAApD,aAAqEC,EAArE,OAAmFtgB,GAAWnZ,EAC9F05B,GAAYC,EAAAA,GAAAA,MAAaC,kBAAkBC,EAAAA,kBACjD,IAAI/3B,EAA2BwF,EAAU,SAAW,YAChDgE,EAAQ,QAEZ,OAAI6N,EACK,MAGLkgB,IACFv3B,OAAOiB,EACPuI,EAAQ,SAIR,SAAC,EAAA+M,cAAD,CACEyhB,kBAAmBP,EACnB91B,MAAO+1B,EACP/C,UAAWnvB,EACXxF,KAAMA,EACN43B,UAAWA,EACXvgB,OAAQA,EACR4gB,UAAW,IAAMT,EAAMhyB,GACvB0yB,kBAAmBP,EACnB7wB,SAAS,EACT0C,MAAOA,K,2NCLb,MAAMiO,GAAqB,CACzB0gB,kCAAiCA,GAAAA,IAG7Bje,IAAYxC,EAAAA,EAAAA,UAxBlB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MAAM6B,EAAU5Y,EAAM4Y,QAChBoe,EAAW7d,GAAQnZ,IACnB,mBAAE+X,EAAF,QAAsBtP,EAAtB,cAA+B4wB,GAAkBzgB,EAAQ7B,GAEzDuiB,EAAQ,CAAC,SAAU,SAKzB,OAJItsB,GAAAA,GAAAA,gBACFssB,EAAM9zB,KAAK,UAGN,CACLuR,UAAAA,EACAgB,mBAAAA,EACAtP,QAAAA,EACA4wB,cAAAA,EACArC,SAAAA,EACAuC,QAASD,EAAM3zB,MAAMC,GAAM4zB,GAAAA,GAAAA,QAAmB5zB,QAQP8S,IAsE3C,GAAeyC,IAnE8C,EAC3Dke,cAAAA,EACAD,kCAAAA,EACA3wB,QAAAA,EACAuuB,SAAAA,EACAuC,QAAAA,MAEA,MAAME,EAAeJ,GAAiBpO,OAAOyO,UAAUL,GAGvD,GAAIrC,IAAayC,EACf,OAAO,KAGT,MAAME,EAAgBlxB,GACbA,EAAQnG,KAAKsY,WACXA,EAAMgf,eACNhf,EAAMzJ,IACNyJ,KAILif,EAAgB/hB,OAASgiB,YAAAA,GAAc,GAAU,MACrD,MACMC,GADeC,EAAAA,GAAAA,MACKC,aAC1B,IAAKF,EACH,OAGF,MAAMG,EAAYC,GAAAA,EAAAA,cAAkBJ,EAAK1vB,OAErCyvB,GACFV,EAAkC,CAChCgB,QAASf,EACT5wB,QAASkxB,EAAalxB,KAI1B,MAAMmS,EAAa,GAEfkf,GAAeC,EAAKM,YACtBzf,EAAM0f,UAAYjB,EACTU,EAAKQ,cACd3f,EAAM4f,UAAYnB,GAGpBoB,EAAAA,gBAAAA,KAAqBC,EAAAA,QAAAA,UAAmB,MAAKX,EAAKh3B,QAAQm3B,IAAatf,KAGzE,OACE,UAAC,EAAAqd,YAAD,YACE,SAAC,EAAAjyB,QAAD,CAASC,QAAS,kBAAmBC,UAAU,SAA/C,UACE,SAAC,EAAAmwB,cAAD,CAAe,cAAY,eAAehsB,MAAO,kBAAmBhH,QAAS,IAAMw2B,IAAnF,kBACE,SAAC,EAAAv2B,KAAD,CAAMC,KAAK,oBAGdg2B,IACC,SAAC,EAAAoB,aAAD,CACE,cAAY,0BACZxrB,QAAS,CAAC,CAAE3K,MAAO,+BAAgC5B,MAAO,KAC1D6Q,SAAU,IAAMomB,EAAc,CAAEC,aAAa,Y,0MCzEvD,MAAMc,WAAkC37B,EAAAA,cAAqB,4DACtC6Y,MAAAA,IACnBrY,KAAKN,MAAMgf,iBAAiB1e,KAAKN,MAAM4X,UAAWwD,EAAWxX,IAAK,CAAEmf,eAAe,OAF1B,sBAK9C,CAACzb,GAAU,KACtB,MAAM,WAAEgR,EAAF,cAAcojB,EAAd,UAA6B9jB,GAActX,KAAKN,MACtD,OAAIsH,EACKo0B,EAAc9jB,GAEdU,EAAWV,MAVqC,mCAchCpS,IACzB,MAAM,sBAAE4S,EAAF,UAAyBR,GAActX,KAAKN,MAClDoY,EAAsBR,EAAWpS,MAhBwB,4BAmBxC,KACjB,MAAM,UAAEm2B,EAAF,UAAa/jB,GAActX,KAAKN,MACtC27B,EAAU/jB,MAGZ3W,SACE,MAAM,kBACJ26B,EADI,WAEJC,EAFI,UAGJjkB,EAHI,QAIJtQ,EAJI,MAKJ2R,EALI,SAMJ9X,EANI,qBAOJy2B,EAPI,SAQJC,EARI,YASJC,EATI,gBAUJ0B,EAVI,aAWJrwB,EAXI,MAYJ2yB,EAZI,cAaJC,EAbI,OAcJ5iB,EAdI,SAeJ/Y,EAfI,eAgBJ47B,EAhBI,iBAiBJ/D,EAjBI,6BAkBJC,GACE53B,KAAKN,MAEHi8B,GAA6BpE,EAAWmE,EAAiB,IAAMA,EAAiB,OAAQ,EACxFE,EAAsBrE,GAAYmE,EAAiB,KAEzD,OACE,SAAC,EAAAG,YAAD,CACEjxB,MAAO0M,IAAcsC,EAAAA,EAAAA,KAAiB,eAAYnX,EAClDq5B,SAAUxkB,IAAcsC,EAAAA,EAAAA,KAAiB,eAAYnX,EACrDs5B,UAAW,CACTzkB,IAAcsC,EAAAA,EAAAA,OACZ,SAACoiB,GAAA,EAAD,CAEErsB,QAAQ,sBACR2O,KAAK,YACL1a,QAAS,KAAMke,EAAAA,GAAAA,GAAuBhR,OAAOmrB,SAASC,MACtD,aAAW,uBAJP,UAOPZ,IACC,SAAC,EAAAa,iBAAD,CAEEnoB,SAAUhU,KAAKo8B,mBACfn+B,QAAS+B,KAAKN,MAAMohB,eACpBub,cAAeV,EACf3wB,MAAO2wB,EAA4B,OAAIl5B,GAJjC,GAAE6U,gBAOZxN,OAAO6P,SAtBX,UAwBE,UAAC,EAAA2iB,iBAAD,YACE,SAACC,GAAD,CAAyBjlB,UAAWA,IAElCigB,GAKA,SAAC,EAAAX,cAAD,CAAehsB,MAAM,mBAAmBhH,QAAS,IAAM23B,EAAWjkB,GAAYgH,KAAK,QAAnF,oBAJA,SAAC,EAAAsY,cAAD,CAAehsB,MAAM,QAAQhH,QAAS,IAAM43B,IAASld,KAAK,UAAU/T,SAAUsO,EAA9E,oBASAA,IACA,SAACge,GAAD,CACEvf,UAAWA,EACXqB,MAAOA,EACP9X,SAAUA,EACVy2B,qBAAsBA,EACtBzuB,aAAcA,EACd0uB,SAAUA,EACVC,YAAaA,EACbC,iBAAkBz3B,KAAKy3B,iBACvBC,SAAUkE,EACVjE,iBAAkBA,EAClBC,6BAA8BA,KAIlC,SAACkB,GAAD,CACEI,gBAAiBA,EACjBD,wBAAyBj5B,KAAKi5B,wBAC9BF,QAASxB,GAAYqE,EACrB/iB,OAAQA,EACR7R,QAASA,GAAY6R,IAAW/Y,EAChCk5B,MAAOh5B,KAAKw8B,WACZrD,cAAetgB,IAGhBqgB,IAAmB,SAAC,EAAAuD,YAAD,CAAaC,KAAM18B,KAAKw8B,WAAYG,SAAUzD,EAAiBlyB,QAASA,IAE3Fy0B,IACC,SAACrkB,GAAD,CAAkBE,UAAWA,EAA7B,SACID,IACA,SAACghB,GAAD,CACEd,SAAUA,EACV1e,OAAQA,EACR/Y,SAAUA,EACVmY,MAAOZ,EAASY,MAChBR,MAAOJ,EAASI,MAChBG,OAAQP,EAASO,OACjBC,KAAMR,EAASQ,eAWjC,MAiCMoB,GAAqB,CACzByF,iBADyB,MAEzB5G,sBAFyB,KAGzBsjB,cAHyB,KAIzBpjB,WAJyB,KAKzBujB,WAAYqB,EAAAA,GACZpB,MAAO9iB,EAAAA,GACP2iB,UAPyB,KAQzB1D,iBAAkBkF,GAAAA,GAClBjF,6BAA8BkF,GAAAA,IAKnBC,IAFK7jB,EAAAA,EAAAA,UA7CM,CAAC3Y,GAAqB+W,UAAAA,MAA0B,MACtE,MAAM,YAAEkgB,GAAgBj3B,EAAM4Y,QACxB6jB,EAAgCz8B,EAAM4Y,QAAQ7B,IAC9C,mBACJgB,EADI,kBAEJgjB,EAFI,MAGJ3iB,EAHI,gBAIJugB,EAJI,QAKJlyB,EALI,OAMJ6R,EANI,SAOJ/Y,EAPI,eAQJ47B,GACEsB,EAEEvB,IAAkBnjB,MAAAA,GAAD,UAACA,EAAoBjT,YAArB,QAAC,EAA0B43B,WAElD,MAAO,CACL3B,kBAAAA,EACAxa,eAAgBxI,MAAAA,OAAF,EAAEA,EAAoBxU,KACpCkD,QAAAA,EACA2R,MAAAA,EACA9X,UAAU0Y,EAAAA,EAAAA,GAAYhZ,EAAMiZ,MAC5B8d,sBAAsB4F,EAAAA,EAAAA,GAAwB38B,EAAMiZ,MACpD+d,SAAU7d,GAAQnZ,GAClB24B,gBAAAA,EACAuC,cAAAA,EACA5iB,OAAAA,EACA/Y,SAAAA,EACA03B,YAAAA,EACAkE,eAAAA,KAgBuCziB,GAEbyC,CAAUyf,I,4CC7MjC,MAAMgC,GAA2B,KACtC,MAAMv8B,GAAQ+G,EAAAA,EAAAA,aAERy1B,EACJrD,GAAAA,GAAAA,cAAyBsD,GAAAA,GAAAA,oBACzBtD,GAAAA,GAAAA,cAAyBsD,GAAAA,GAAAA,kBAIrB5Z,GACJ,yCACE,SAAC,EAAA5f,KAAD,CAAMC,KAAK,aACX,0GAFF,SAGE,cACEo4B,KAAK,sFACLhrB,OAAO,SACPosB,IAAI,aACJ/+B,UAAU,YAJZ,4BAWEg/B,GACJ,SAAC,EAAAC,WAAD,CAAYx5B,KAAK,KAAKk4B,KAAK,kBAAkB5d,KAAK,WAAW/T,UAAW6yB,EAAxE,6BAKIK,EAAgBx8B,EAAAA,GAAI;iBACXL,EAAM88B,YAAYnpB,OAAOsI;kBACxBjc,EAAMoB,QAAQ;;IAI9B,OACE,SAAC,EAAA27B,iBAAD,CAAkBC,oBAAqBL,EAAYh/B,UAAWk/B,EAAeha,OAAQA,EAAQoa,QA7B7F,0GCQG,SAASC,GAAiBp+B,GAC/B,MACMqB,EATWH,CAAAA,IACV,CACLm9B,gBAAiB98B,EAAAA,GAAI;oBACLL,EAAMoB,QAAQ;QAMjBG,EADDwF,EAAAA,EAAAA,cAEd,OACE,gBAAKpJ,UAAWwC,EAAOg9B,gBAAvB,UACE,UAAC,EAAAC,gBAAD,YACIt+B,EAAMu+B,0BACN,SAAC,EAAAv6B,OAAD,CACEC,QAAQ,YACR,aAAW,iBACXC,QAASlE,EAAMw+B,yBACf3zB,SAAU7K,EAAMy+B,0BAChB7f,KAAK,OALP,wBAUF,SAAC,EAAA5a,OAAD,CACEC,QAAQ,YACR,aAAW,sBACXpF,WAAWmE,EAAAA,EAAAA,IAAG,CAAE,wBAA2BhD,EAAM0+B,0BACjDx6B,QAASlE,EAAM2+B,yBACf/f,KAAK,UALP,4BASA,SAAC,EAAA5a,OAAD,CACEC,QAAQ,YACR,aAAW,yBACXpF,WAAWmE,EAAAA,EAAAA,IAAG,CAAE,wBAA2BhD,EAAM4+B,6BACjD16B,QAASlE,EAAM6+B,4BACfjgB,KAAK,cALP,4B,wWCrCR,MAAMnc,GAAavB,IAAD,CAChB49B,YAAav9B,EAAAA,GAAI;;iBAEFL,EAAMM,WAAWE,UAAUC;aAC/BT,EAAMW,OAAOC,KAAK6C;MAoE/B,MAAM4U,GAAqB,CACzBP,UAASA,EAAAA,IAIE+lB,IADKvlB,EAAAA,EAAAA,UAVlB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MAAO,CACLqB,MAAOpY,EAAM4Y,QAAQ7B,GAAYqB,SAQMM,GACTyC,EA3D3B,SAAuChc,GAAc,MAC1D,MAAM,WAAEg2B,EAAF,MAAc/c,EAAd,UAAqBD,EAArB,cAAgCgmB,GAAkBh/B,EAClD8c,GAAWmiB,EAAAA,GAAAA,GAAShmB,EAAOD,GAC3B9X,GAAQ+G,EAAAA,EAAAA,aACR5G,GAAS+D,EAAAA,EAAAA,YAAW3C,IAKpBy8B,GAAS7wB,EAAAA,EAAAA,qBAAoB,CACjC7B,YAAa,CACXE,SAAU,GACVS,UAAW,IAEb/B,KAAM4qB,EAEN1nB,iBAAmB7K,GAAUA,EAC7BvC,MAAAA,KAGI,MAAEi+B,IAAUC,EAAAA,GAAAA,GAAoBF,IAC/BG,EAAMC,IAAcC,EAAAA,GAAAA,IAAU,GAE/BC,EACJR,IAAiB,UAAAG,EAAM,UAAN,eAAUz4B,QAAS,KAClC,kBAAM7H,UAAWwC,EAAOy9B,YAAxB,eAAwCK,EAAM,GAAGz4B,OAAjD,kCACE,KAEN,OACE,SAAC,EAAA2S,SAAD,CACEhU,OACE,yCACam6B,EAAc,IAD3B,SAEE,SAAC,EAAAC,MAAD,CAAO39B,KAAM,OAAQ6K,MAAO,OAAQiS,KAAM,SAAU3O,QAAS,sCAGjEyvB,YAAaV,EAEb1lB,QAAQ0lB,GAAgBK,EACxBM,SAAUX,EAAgB,IAAMM,SAAev8B,EAVjD,UAYE,gBAAKoC,MAAO,CAAEkG,OAAQ2zB,EAAgB,IAAM,KAA5C,UACE,SAACY,GAAA,EAAD,CAAW5J,WAAYkJ,EAAQpiB,SAAUA,W,iNC7D1C,MAAM+iB,GAAqB7/B,IAChC,MAAM8/B,EAA8B,CAClCC,WAAa,WAAU//B,EAAMd,oBAC7BovB,QAAS,GAGL0R,EAAqD,CACzDC,OAAQ,CAAE3R,QAAS,EAAG4R,QAAS,QAC/BC,SAAU,CAAE7R,QAAS,GACrB8R,QAAS,CAAE9R,QAAS,GACpB+R,QAAS,CAAE/R,QAAS,IAGtB,OACE,SAACgS,GAAA,GAAD,CACEtpB,GAAIhX,EAAMgX,GACVG,QAASnX,EAAMd,SACfgY,cAAelX,EAAMkX,gBAAiB,EACtCqpB,SAAUvgC,EAAMugC,SAJlB,SAMI1/B,IACA,gBACEsE,MAAK,iBACA26B,EACAE,EAAiBn/B,IAHxB,SAMGb,EAAM8W,cC5BJ0pB,GAA0DxgC,IAAU,MAC/E,MAAM,WAAEygC,GAAezgC,EACjBkB,GAAQ+G,EAAAA,EAAAA,aACRy4B,IAAYD,EACZvhC,EAAWwhC,EAAY,IAAM,GAC7Bx1B,EAAQu1B,EAAa,cAAgB,gBACrCtC,GAAUsC,MAAAA,OAAA,EAAAA,EAAYtC,WAAWsC,MAAAA,GAAvB,UAAuBA,EAAYr1B,YAAnC,aAAuB,EAAkB+yB,UAAW,KAC9DwC,EAAqBp/B,EAAAA,GAAI;kBACfL,EAAMoB,QAAQ;IAG9B,OACE,SAACu9B,GAAD,CAAQ7oB,GAAI0pB,EAAWxhC,SAAUA,EAAjC,UACE,SAAC,EAAA0hC,MAAD,CAAOC,SAAS,QAAQ31B,MAAOA,EAAOrM,UAAW8hC,EAAjD,SACGxC,OCfF,SAAS2C,GAAuB9gC,GACrC,MAAM6a,GAAgBM,EAAAA,EAAAA,cAAata,IAAD,uBAAuBA,EAAM4Y,QAAQzZ,EAAM4X,kBAA3C,aAAuB,EAAgCiD,iBAEnF4lB,GAAa5lB,MAAAA,OAAA,EAAAA,EAAeha,SAAUkgC,EAAAA,aAAAA,MAAqBlmB,MAAAA,OAA9C,EAA8CA,EAAehW,WAAQ9B,EAExF,OAAO,SAACy9B,GAAD,CAAgBC,WAAYA,I,+DCU9B,SAASO,IAAsB,YACpCt1B,EADoC,mBAEpCu1B,EAFoC,UAGpCrkB,IAMA,OAAKA,GAAyC,IAA5BA,EAAUjO,OAAOjI,QAAiBkW,EAAUjO,OAAOnI,MAAM06B,IAAD,aAAOjnB,QAAO,UAACinB,EAAErzB,OAAOszB,aAAV,aAAC,EAAgBz6B,WAKhG,SAAU06B,GAEf,MAAMxyB,EAAQgO,EAAUjO,OAAOuP,MAAMgjB,IAAD,aAAOjnB,QAAO,UAACinB,EAAErzB,OAAOszB,aAAV,aAAC,EAAgBz6B,WACnE,IACE,MAAMy6B,GAAQjoB,EAAAA,GAAAA,GAAwB,CACpCtK,MAAAA,EACAmK,SAAUqoB,EAAKC,kBACf31B,YAAAA,EACAuN,MAAOqoB,GAAqBF,GAC5BxkB,UAAAA,IAGF,MAAO,CACL4f,KAAM2E,EAAM,GAAG3E,KACft4B,QAASi9B,EAAM,GAAGj9B,QAClB4C,QAAS,kBAAC,EAAA3C,KAAD,CAAMC,KAAK,UAAU8G,MAAM,8CAEtC,MAAOrG,GAGP,YADA8hB,QAAQ9hB,MAAMA,KAOtB,SAAqC6G,EAAwBu1B,GAE3D,GAAKA,MAAAA,IAAAA,EAAoBM,cACvB,OAGF,MAAMC,GAAqBxmB,EAAAA,GAAAA,MAAmBC,oBAAoBgmB,EAAmBM,eAErF,IAAKC,EACH,OAGF,OAAO,SAAUJ,GAMf,MAAMK,EAAgC,CACpCv2B,MAAOs2B,EAAmBp9B,KAC1Bs9B,IAAK,GACLC,SAAU,CACRJ,cAAeC,EAAmB59B,IAClCwd,eAAgBogB,EAAmBp9B,KACnCqX,MAAO,CACLmmB,KAAMC,GAAqBT,EAAMH,GACjCvlB,MAAO,MAKPnL,GAAOuxB,EAAAA,EAAAA,0BAAyB,CACpCvxB,KAAMkxB,EACNM,aAAcN,EAASE,SACvBK,WAAY,GACZ/oB,MAAOqoB,GAAqBF,EAAM,CAChCa,QAAShB,EAAmBiB,mBACxBnuB,EAAAA,UAAAA,aAAuBktB,EAAmBiB,oBAC1C,EACJC,MAAOlB,EAAmBmB,iBAAmBruB,EAAAA,UAAAA,aAAuBktB,EAAmBmB,kBAAoB,IAE7GxzB,MAAO,GACPyzB,UAAW32B,EACX4C,kBAAkBg0B,EAAAA,EAAAA,kBAAiBvW,QAAQ0C,MAAK6T,EAAAA,EAAAA,qBAGlD,MAAO,CACL9F,KAAMjsB,EAAKisB,KACXt4B,QAASqM,EAAKrM,QACd4C,QAAS,KAAF,IAAE,SAAC,EAAA3C,KAAD,CAAMC,KAAK,UAAU8G,MAAM,+CA7E/Bq3B,CAA4B72B,EAAau1B,GAqFpD,MAAMuB,GAAc,CAAC,UAAW,WAAY,YAAa,OAEzD,SAASX,GAAqBT,EAAiBpxB,GAC7C,MAAQyyB,KAAMvc,EAAR,gBAAcwc,EAAd,eAA+BC,GAAmB3yB,EAClD4yB,EAAc1c,MAAAA,GAAAA,EAAMxf,OAASwf,EAAOsc,GAQ1C,IAAI/mB,EAAS,IAPA,IAAI2lB,EAAKyB,QAAQJ,QAASrB,EAAKqB,MAAMlwB,QAAO,CAACoiB,EAAKmO,KACzDF,EAAYG,SAASD,EAAI9wB,MAC3B2iB,EAAItuB,KAAM,GAAEy8B,EAAI9wB,QAAQ8wB,EAAIr/B,UAEvBkxB,IACN,IAEkB1S,KAAK,SAS1B,OAPIygB,GAAmBtB,EAAK4B,UAC1BvnB,GAAU,OAAM2lB,EAAK4B,YAEnBL,GAAkBvB,EAAK6B,SACzBxnB,GAAU,OAAM2lB,EAAK6B,WAGhBxnB,EAMT,SAAS6lB,GACPF,EACA8B,EAAgD,CAAEjB,QAAS,EAAGE,MAAO,IAErE,MAAMgB,EAAoB9mB,KAAK+mB,MAAMhC,EAAKiC,UAAY,IAAOH,EAAUjB,SACjEl6B,GAAOsF,EAAAA,EAAAA,UAAS81B,GAChBG,GAAalC,EAAKiC,UAAYjC,EAAKliC,UAAY,IACrD,IAAIqkC,EAAkBlnB,KAAK+mB,MAAME,EAAYJ,EAAUf,OAInDgB,IAAsBI,GACxBA,IAEF,MAAMv7B,GAAKqF,EAAAA,EAAAA,UAASk2B,GAGpB,MAAO,CACLx7B,KAAAA,EACAC,GAAAA,EACAtE,IAAK,CACHqE,KAAAA,EACAC,GAAAA,I,iICrJC,MAAMw7B,GAAuB,CAClCC,SAAQ,SAAE3sB,EAAF,QAAYhQ,EAAZ,iBAAqB48B,IAC3B,MAAMC,GAAatlC,EAAAA,EAAAA,QAAoB,MAEvC,OACE,SAAC,EAAAulC,kBAAD,CAAmB98B,QAASA,EAAS+8B,UAAW,IAAhD,SACG,CAACC,EAAYC,EAAYC,KAEtB,gCACGL,EAAWplC,UACV,SAAC,EAAAklC,QAAD,iBACMO,EADN,CAEEC,iBAAkBN,EAAWplC,QAC7B2lC,iBAAkBR,EAClBS,aAAcJ,EACdK,aAAcN,KAIjB5jC,EAAAA,aAAmB4W,EAAU,CAC5B7T,IAAK0gC,EACLS,aAAcN,EACdK,aAAcJ,UAQ5Bl9B,QAAO,EAAC,SAAEiQ,EAAF,MAAY5L,MACX,SAAC,UAAD,CAAgBpE,QAASoE,EAAzB,SAAiC4L,IAE1C3S,KAAO,IAAM,KACbkgC,SAAW,IAAM,KACjBC,KAAO,IAAM,KACbC,SAAW,IAAM,KACjBvgC,OAAM,EAAC,QAAEE,EAAF,SAAW4S,EAAX,UAAqBjY,MAExB,SAAC,EAAAmF,OAAD,CAAQC,QAAQ,YAAYC,QAASA,EAASrF,UAAWA,EAAzD,SACGiY,IAIP0tB,QA0BF,UAAiB,UAAE3lC,IACjB,MAAMwC,EAASoB,IAAUub,EAAAA,EAAAA,aACzB,OAAO,gBAAK7Y,MAAO,GAAItG,UAAWmE,IAAAA,CAAG3B,EAAOmjC,QAAS3lC,MA3BrD4lC,MAAMzkC,IACG,SAAC,EAAAykC,MAAD,iBAAWzkC,IAEpB0kC,WAAU,EAAC,SAAE5tB,EAAF,UAAYjY,EAAZ,MAAuBsG,MAE9B,iBAAMtG,UAAWA,EAAWsG,MAAOA,EAAnC,SACG2R,KAMHrU,IAAYwa,EAAAA,EAAAA,gBAAe/b,IACxB,CACLsjC,QAASjjC,EAAAA,GAAI;;oBAEGL,EAAMyjC,OAAS,UAAY;;;;;UCoB/C,SAASC,GAAsBC,EAAuBC,GAEpD,OADuBD,EAASz6B,QAAQwQ,GAAMA,EAAEmqB,cAC1Br+B,SAAWo+B,EAAexgC,KC7BlD,SAAS0gC,GACPC,EACAC,EACAC,GAEA,OAAQlC,IACN,MAAMmC,EAAMF,EAAa/jB,IAAI8hB,GAC7B,IAAKmC,EACH,OAEF,IAAIC,EAEFA,EADiB,SAAfJ,EACYG,EAAIE,aACM,YAAfL,EACKG,EAAIG,gBACM,aAAfN,EACKG,EAAII,iBACM,eAAfP,EACKG,EAAIK,mBACM,gBAAfR,EACKG,EAAIM,oBAEJN,EAAIO,aAEpB,MAAMC,EAAkB,IAAIC,IAAIX,GAChCU,EAAgBE,IAAI7C,EAAQoC,GAC5BF,EAAgBS,ICvEpB,SAASG,KACP,MAAO,GAUF,SAASC,GAAUhmC,GAAc,UAEtC,MAAM0O,EAAQ1O,EAAMg2B,WAAW,IAEzB,UAAEiQ,EAAF,YAAaC,EAAb,eAA0BC,EAA1B,YAA0CC,EAA1C,kBAAuDC,EAAvD,UAA0EC,GFvC3E,WACL,MAAOD,EAAmBE,IAAwB5mC,EAAAA,EAAAA,UAAS,IAAIgT,KAEzDszB,GAAYjuB,EAAAA,EAAAA,cAChB,SAAmBwuB,GACjB,GAA+B,IAA3BH,EAAkB/hC,KACpB,OAEF,IAAImiC,GAAqB,EACrBC,GAAuB,EAC3B,MAAMC,EAAuBH,EAAMj0B,QAAO,CAACq0B,EAAKhsB,KAC1CA,EAAEisB,OAASJ,IACbC,GAAuB,GAErBA,GAAwBE,EAAIE,IAAIlsB,EAAEqoB,UACpC2D,EAAIG,OAAOnsB,EAAEqoB,QACbyD,GAAuB,EACvBD,EAAoB7rB,EAAEisB,OAEjBD,IACN,IAAIj0B,IAAI0zB,IACXE,EAAqBI,KAEvB,CAACN,IAGGH,GAAcluB,EAAAA,EAAAA,cAClB,SAAqBwuB,GACnB,GAAI5B,GAAsB4B,EAAOH,GAC/B,OAEF,IAAIW,EACJ,MAAML,EAAuBH,EAAMj0B,QAAO,CAACq0B,EAAKK,KAC1CD,GAA4BC,EAAQJ,OAASG,EAAyBH,OACxED,EAAIlZ,IAAIsZ,EAAyB/D,QAC7BgE,EAAQlC,cACViC,EAA2BC,IAEpBA,EAAQlC,cAAgB6B,EAAIE,IAAIG,EAAQhE,UACjD+D,EAA2BC,GAEtBL,IACN,IAAIj0B,IAAI0zB,IAEPW,GACFL,EAAqBjZ,IAAIsZ,EAAyB/D,QAEpDsD,EAAqBI,KAEvB,CAACN,IAGGC,GAAYtuB,EAAAA,EAAAA,cAAY,WAC5BuuB,EAAqB,IAAI5zB,OACxB,IAEGyzB,GAAcpuB,EAAAA,EAAAA,cAClB,SAAqBwuB,GACnB,GAAI5B,GAAsB4B,EAAOH,GAC/B,OAEF,MAAMM,EAAuBH,EAAMj0B,QAAO,CAACq0B,EAAKhsB,KAC1CA,EAAEmqB,aACJ6B,EAAIlZ,IAAI9S,EAAEqoB,QAEL2D,IACN,IAAIj0B,KAEP4zB,EAAqBI,KAEvB,CAACN,IAGGF,GAAiBnuB,EAAAA,EAAAA,cACrB,SAAwBirB,GACtB,MAAM0D,EAAuB,IAAIh0B,IAAI0zB,GACjCA,EAAkBS,IAAI7D,GACxB0D,EAAqBI,OAAO9D,GAE5B0D,EAAqBjZ,IAAIuV,GAE3BsD,EAAqBI,KAEvB,CAACN,IAGH,MAAO,CACLA,kBAAAA,EACAJ,UAAAA,EACAC,YAAAA,EACAI,UAAAA,EACAF,YAAAA,EACAD,eAAAA,GErD4Fe,IACxF,aACJhC,EADI,aAEJiC,EAFI,oBAGJC,EAHI,iBAIJC,EAJI,oBAKJC,EALI,uBAMJC,EANI,iBAOJC,EAPI,qBAQJC,EARI,wBASJC,GD9CG,SAAwBh5B,GAC7B,MAAOw2B,EAAcC,IAAmBxlC,EAAAA,EAAAA,UAAS,IAAIkmC,MAGrDvnC,EAAAA,EAAAA,YAAU,KACR6mC,EAAgB,IAAIU,OACnB,CAACn3B,EAAOy2B,IAEX,MAAMgC,GAAenvB,EAAAA,EAAAA,cACnB,SAAsBirB,GACpB,MAAM2C,EAAkB,IAAIC,IAAIX,GAC5BU,EAAgBkB,IAAI7D,GACtB2C,EAAgBmB,OAAO9D,GAEvB2C,EAAgBE,IAAI7C,EAAQ,IAAI0E,GAAAA,IAElCxC,EAAgBS,KAElB,CAACV,IAGGkC,GAAsBpvB,EAAAA,EAAAA,cAC1B,SAA6BirB,EAAgB2E,GAC3C,MAAMxC,EAAMF,EAAa/jB,IAAI8hB,GAC7B,IAAKmC,EACH,OAEF,MAAMC,EAAcD,EAAIyC,cAAcD,GAChChC,EAAkB,IAAIC,IAAIX,GAEhC,OADAU,EAAgBE,IAAI7C,EAAQoC,GACrBF,EAAgBS,KAEzB,CAACV,IAGH,MAAO,CACLA,aAAAA,EACAiC,aAAAA,EACAC,oBAAAA,EACAC,kBAAkBrvB,EAAAA,EAAAA,cACfirB,GAAmB+B,GAA2B,OAAQE,EAAcC,EAAjDH,CAAkE/B,IACtF,CAACiC,IAEHuC,sBAAsBzvB,EAAAA,EAAAA,cACnBirB,GAAmB+B,GAA2B,WAAYE,EAAcC,EAArDH,CAAsE/B,IAC1F,CAACiC,IAEHwC,yBAAyB1vB,EAAAA,EAAAA,cACtBirB,GAAmB+B,GAA2B,cAAeE,EAAcC,EAAxDH,CAAyE/B,IAC7F,CAACiC,IAEHqC,wBAAwBvvB,EAAAA,EAAAA,cACrBirB,GAAmB+B,GAA2B,aAAcE,EAAcC,EAAvDH,CAAwE/B,IAC5F,CAACiC,IAEHoC,qBAAqBtvB,EAAAA,EAAAA,cAClBirB,GAAmB+B,GAA2B,UAAWE,EAAcC,EAApDH,CAAqE/B,IACzF,CAACiC,IAEHsC,kBAAkBxvB,EAAAA,EAAAA,cACfirB,GAAmB+B,GAA2B,OAAQE,EAAcC,EAAjDH,CAAkE/B,IACtF,CAACiC,KCdD4C,CAAep5B,IAEb,yBAAEq5B,EAAF,sBAA4BC,EAA5B,oBAAmDC,GCjDpD,WACL,MAAOA,EAAqBC,IAA0BvoC,EAAAA,EAAAA,UAAS,IAAIgT,KAkBnE,MAAO,CAAEs1B,oBAAAA,EAAqBD,uBAhBAhwB,EAAAA,EAAAA,cAAY,SAA+BirB,GACvEiF,GAAwB52B,IACtB,MAAM62B,EAAyB,IAAIx1B,IAAIrB,GAEvC,OADA62B,EAAuBza,IAAIuV,GACpBkF,OAER,IAUkDJ,0BARpB/vB,EAAAA,EAAAA,cAAY,SAAkCirB,GAC7EiF,GAAwB52B,IACtB,MAAM62B,EAAyB,IAAIx1B,IAAIrB,GAEvC,OADA62B,EAAuBpB,OAAO9D,GACvBkF,OAER,KDgC8EC,IAC3E,UAAEC,EAAF,oBAAaC,EAAb,wBAAkCC,GEpDnC,WACL,MAAOF,EAAWG,IAAgB7oC,EAAAA,EAAAA,UAAoB,CACpD6H,KAAM,CACJjJ,QAAS,CAAC,EAAG,MAIXgqC,GAA0BvwB,EAAAA,EAAAA,cAAY,SAAiCywB,GAC3ED,GACGE,IACC,MAAMlhC,EAAO,OAAH,UAAQkhC,EAAUlhC,KAASihC,GACrC,wBAAYC,EAAZ,CAAuBlhC,KAAAA,SAG1B,IAEG8gC,GAAsBtwB,EAAAA,EAAAA,cAAY,SAA6BO,EAAeowB,GAClF,MACMnhC,EAAO,CAAEjJ,QADmB,CAACga,EAAOowB,IAE1CH,GACGE,GACC,iBAAYA,EAAZ,CAAuBlhC,KAAAA,QAG1B,IAEH,MAAO,CAAE6gC,UAAAA,EAAWC,oBAAAA,EAAqBC,wBAAAA,GF0B2BK,IAK7DC,EAAqBC,IAA0BnpC,EAAAA,EAAAA,UAAS,MAIxDopC,EAAMC,IAAWrpC,EAAAA,EAAAA,WAAS,GAE3BspC,GAAY17B,EAAAA,EAAAA,UAAQ,IA6G5B,SAA6BmB,GAC3B,IAAKA,EACH,OAAO,KAET,IAAItD,EACsB,IAAxBsD,EAAMC,OAAOjI,OAETgI,EAAMC,OAAO,GAAGkG,OAAOsM,IAAI,GAKnC,SAAiCzS,GAC/B,MAAMw6B,EAAO,IAAIC,EAAAA,cAA4Bz6B,GACvC06B,EAA0C,GAChD,IAAK,IAAIxmB,EAAI,EAAGA,EAAIsmB,EAAKxiC,OAAQkc,IAAK,CACpC,MAAMwe,EAAO8H,EAAK/nB,IAAIyB,GACjBwmB,EAAUhI,EAAK6B,UAClBmG,EAAUhI,EAAK6B,QAAU,CACvBoG,YAAajI,EAAKiI,YAClB5G,KAAMrB,EAAKkI,cAKjB,MAAO,CACLtG,QAASkG,EAAK/nB,IAAI,GAAG6hB,QACrBoG,UAAAA,EACA5C,MAAO0C,EAAKK,UAAUpmC,KAAI,CAACyX,EAAGnV,KAAU,MACtC,wBACKmV,EADL,CAEE1b,SAAuB,IAAb0b,EAAE1b,SACZmkC,UAAyB,IAAdzoB,EAAEyoB,UACbmG,UAAW5uB,EAAEqoB,OACbwG,MAAO,EACPC,WAAY9uB,EAAE+uB,aAAe,CAAC,CAAEC,QAAS,WAAY3G,OAAQroB,EAAE+uB,aAAc3G,QAASpoB,EAAEooB,eAAajgC,EACrG8mC,MAAM,UAAAjvB,EAAEivB,YAAF,eAAQ1mC,KAAK2mC,GAAD,iBAAaA,EAAb,CAAgBC,UAAyB,IAAdD,EAAEC,gBAAwB,GACvE1I,kBAAmB57B,QA7BnBukC,CAAwBt7B,GAC9B,OAAOu7B,EAAAA,GAAAA,IAAmB7+B,GAtHM8+B,CAAoBx7B,IAAQ,CAACA,KACvD,OAAEy7B,EAAF,UAAUC,EAAV,gBAAqBC,GGhEtB,SAAmB7D,GACxB,MAAO2D,EAAQC,IAAazqC,EAAAA,EAAAA,UAAS,IAC/B0qC,GAAkD98B,EAAAA,EAAAA,UAAQ,IACvD48B,GAAU3D,GAAQ8D,EAAAA,GAAAA,IAAYH,EAAQ3D,QAASzjC,GACrD,CAAConC,EAAQ3D,IAEZ,MAAO,CAAE2D,OAAAA,EAAQC,UAAAA,EAAWC,gBAAAA,GH0DmBE,CAAUtB,MAAAA,OAAD,EAACA,EAAWzC,OAC9DgE,GAAiBrvB,EAAAA,EAAAA,cAAata,IAAD,yBAAuBA,EAAM4Y,QAAQzZ,EAAM4X,kBAA3C,iBAAuB,EAAgCgB,0BAAvD,aAAuB,EAAoDxU,QACxG68B,EAAkB,QAAI,GAAAjmB,EAAAA,GAAAA,MAAmBC,oBAAoBuvB,UAA3C,iBAAI,EAAwDC,gBAA5D,aAAG,EACvBC,aACEvpC,GAAWga,EAAAA,EAAAA,cAAata,IAAsBgZ,EAAAA,EAAAA,GAAYhZ,EAAMiZ,QAEhE5Y,GAAQ8c,EAAAA,EAAAA,YACR2sB,GAAap9B,EAAAA,EAAAA,UACjB,MAEIhJ,KAAMrD,EAAMyjC,OAASiG,GAAAA,GAAAA,KAAiBA,GAAAA,GAAAA,MACtCC,qBAAsBhpC,EAAAA,OACtBipC,WAAY,CACVC,UAAW,CACTppC,SAAUT,EAAMM,WAAW8C,KAAK6Y,QAIxC,CAACjc,IAGG8pC,GAAgCz9B,EAAAA,EAAAA,UACpC,KAAM,CACJ84B,kBAAAA,EACAnB,aAAAA,EACA+C,oBAAAA,EACAgD,gCAAgC,EAChCpC,oBAAAA,EACA7F,QAASiG,MAAAA,OAAF,EAAEA,EAAWjG,WAEtB,CAACqD,EAAmBnB,EAAc+C,EAAqBY,EAAqBI,MAAAA,OAA5E,EAA4EA,EAAWjG,UAGnFkI,GAAiB39B,EAAAA,EAAAA,UACrB,IAAMyzB,GAAsB,CAAEt1B,YAAa1L,EAAM0L,YAAau1B,mBAAAA,EAAoBrkB,UAAWlO,KAC7F,CAAC1O,EAAM0L,YAAau1B,EAAoBvyB,IAEpCy8B,GAAoBnzB,EAAAA,EAAAA,cAAY,IAAMgxB,GAASD,IAAO,CAACA,IAE7D,OAAI,UAAC/oC,EAAMg2B,kBAAP,OAAC,EAAkBtvB,QAAWuiC,GAKhC,SAAC,MAAD,CAAexlC,MAAOknC,EAAtB,UACE,UAAC,eAAD,CAA4BlnC,MAAO+/B,GAAnC,WACE,SAAC,MAAD,CACE4H,aAAa,EACbC,YAAatF,GACbuF,mBAAoBvF,GACpBwF,SAAS,EACTC,aAAa,EACbC,WAAY1F,GACZoF,kBAAmBA,EACnBO,wBAAyB3F,GACzB4F,WAAY5F,GACZ6F,YAAa,EACbC,SAAU9C,EACV+C,WAAY,KACZC,MAAO9C,EACP+C,gBAAgB,EAChBzD,wBAAyBA,EACzBD,oBAAqBA,EACrBD,UAAWA,EACX4D,YAAa9B,EACb+B,oBAAqB9B,EACrB+B,mBAAmB,EACnBhrC,SAAUA,KAEZ,SAAC,MAAD,CACEirC,kBAAmBrG,GACnBsG,yBAA0BtG,GAC1BuG,eAAgBjC,EAChB0B,MAAO9C,EACP+B,cAAeA,EACfzC,wBAAyBA,EACzBD,oBAAqBA,EACrBD,UAAWA,EACXkE,UAAWxG,GACXyG,yBAA0BzG,GAC1B+C,uBAAwBA,EACxB1C,YAAaA,EACbF,YAAaA,EACbI,UAAWA,EACXL,UAAWA,EACXE,eAAgBA,EAChBsG,oCAAqC1G,GACrCqB,oBAAqBA,EACrBC,iBAAkBA,EAClBI,qBAAsBA,EACtBC,wBAAyBA,EACzBH,uBAAwBA,EACxBD,oBAAqBA,EACrBE,iBAAkBA,EAClBkF,aAAcvF,EACdwF,SAAU5G,GACViC,sBAAuBA,EACvBD,yBAA0BA,EAC1B6E,YAAa7G,GACb8G,OAAQ1C,EACRe,eAAgBA,EAChB4B,cAAe9sC,EAAM8sC,qBA7DpB,KInGJ,SAASC,GAAmB/sC,GACjC,MAAM,WAAEg2B,EAAF,YAActqB,EAAd,UAA2BkM,EAA3B,cAAsCk1B,GAAkB9sC,EAE9D,OACE,SAAC,EAAAqZ,SAAD,CAAUhU,MAAM,aAAaiU,QAAM,EAAnC,UACE,SAAC0sB,GAAD,CACEpuB,UAAWA,EACXoe,WAAYA,EACZtqB,YAAaA,EACbohC,cAAeA,M,UCLhB,SAASE,GAAgBhtC,GAC9B,MAAM,MAAEsL,EAAF,eAASsO,EAAT,cAAyB3Q,EAAzB,SAAwC9H,EAAxC,UAAkD6X,EAAlD,kBAA6Di0B,EAA7D,iBAAgFC,GAAqBltC,EACrGkB,GAAQ+G,EAAAA,EAAAA,aACR5G,GAAS+D,EAAAA,EAAAA,YAAW3C,IACpBH,EAAU6qC,SAASjsC,EAAMoB,QAAQ,GAAGxB,MAAM,GAAI,GAAI,IAGxD,IAAIssC,EAEJ,IAAKxzB,EACH,OAAO,KACyB,MAA3B,GAAIA,MAAAA,GAAAA,EAAgB/U,MACzB,OACE,SAAC,EAAA+7B,MAAD,CAAO11B,MAAM,2CAAb,UACG,UAAA0O,EAAe/U,MAAMuG,YAArB,eAA2B+yB,UAAWvkB,EAAe/U,MAAMwoC,YAAczzB,EAAe/U,MAAMs5B,WAG1FvkB,MAAAA,OAAA,EAAAA,EAAgB/Y,SAAUkgC,EAAAA,aAAAA,QACnCqM,EAAyB,KAAH,IAAG,wDAChBxzB,MAAAA,GAAAA,EAAgBxO,OAEvBgiC,EADExzB,EAAexO,KAAK1E,OAAS,GAE7B,SAACyE,GAAD,CACEQ,WAAW,QACXJ,aAAcw1B,EAAAA,aAAAA,KACd31B,KAAMwO,EAAexO,KACrBC,OArBO,IAsBPC,MAAOA,EAAQhJ,EACf2G,cAAeA,EACfE,aAAc8jC,EACd9rC,SAAUA,EACVuK,YAAasN,EACbpN,mBAAoBC,EAAAA,mBAAAA,QAIC,KAAH,IAAG,gDAI7B,MAAMyhC,EAsCR,SACE1zB,EACA2zB,GACoB,QACpB,MAAMC,EAAY5zB,GAAkBA,EAAexO,KAAK,KAAtC,UAA4CwO,EAAexO,KAAK,GAAGzF,YAAnE,iBAA4C,EAA6BmH,cAAzE,aAA4C,EAAqC7D,eACnG,OAAOukC,GAAaD,EAAkBxlC,KAAOwlC,EAAkBvlC,KAAOwlC,EAAUzlC,KAAOylC,EAAUxlC,SAAMjF,EA3CrF0qC,CAAmB7zB,EAAgB3Q,GACrD,IAAIykC,EAUJ,YARkB3qC,IAAduqC,GAA2BA,EAAY,IACzCI,GACE,SAAC,EAAAt5B,YAAD,CAAa/O,MAAM,oBAAoBpD,aAAW,EAAlD,UACE,SAAC,EAAA+B,OAAD,CAAQM,KAAK,KAAKsa,KAAK,OAAO3a,QAAQ,YAAYC,QAASgpC,EAAkB34B,GAAG,sBAMpF,UAAC,EAAA8E,SAAD,CAAUhU,MAAM,aAAaiU,QAAQ,EAAMhS,SAASsS,MAAAA,OAAA,EAAAA,EAAgB/Y,SAAUkgC,EAAAA,aAAAA,QAA9E,WACE,gBAAK57B,MAAO,CAAEkG,OAhDH,KAgDaxM,UAAWwC,EAAOssC,iBAA1C,SACGP,KAEH,gBAAKvuC,UAAWwC,EAAOusC,kBAAvB,SAA2CF,OAKjD,MAAMjrC,GAAY,KACT,CACLmrC,kBAAmBrsC,EAAAA,GAAI;;;;;;MAOvBosC,iBAAkBpsC,EAAAA,GAAI;;;;QChF1B,MAAMssC,GAAqEC,EAAAA,GAAAA,KAA0B3oC,IAAD,CAClG1B,MAAO0B,EAEPE,MAAOF,EAAM,GAAG4oC,cAAgB5oC,EAAMrE,MAAM,GAAGirB,QAAQ,IAAK,SAGxDzpB,IAAUf,EAAAA,EAAAA,KAAI,CAClB2+B,QAAS,OACT8N,eAAgB,kBAQX,SAASC,GAAkBjuC,GAChC,MAAM,WAAE2L,EAAF,mBAAcuiC,GAAuBluC,EAC3C,OACE,iBAAKnB,UAAWyD,GAAhB,mBAEE,SAAC,EAAAqS,iBAAD,CAAkBrQ,KAAK,KAAK0L,QAAS69B,GAAyBpqC,MAAOkI,EAAY2I,SAAU45B,O,oICmC5FvY,I,SAAAA,GAAAA,EAAAA,EAAAA,YAAAA,GAAAA,cAAAA,EAAAA,EAAAA,eAAAA,GAAAA,iB,CAAAA,KAAAA,GAAAA,KAmCE,MAAMwY,WAAgBjuC,EAAAA,cAG3BH,YAAYC,GACVC,MAAMD,GADkB,wDAOVouC,IACd,MAAM,gBAAE11B,EAAF,UAAmBd,GAActX,KAAKN,MAC5C0Y,EAAgB,CAAEd,UAAAA,EAAWw2B,SAAAA,OATL,0BAaR3yB,IAChBnb,KAAKN,MAAMkf,WAAW5e,KAAKN,MAAM4X,UAAW,CAAC6D,OAdrB,6BAiBLrR,IACnB,MAAM,MAAE3G,EAAF,IAASuO,EAAT,SAAcq8B,GAAajkC,EAC7BikC,IAAaC,GAAAA,IACfhuC,KAAK4S,mBAAmBlB,EAAKvO,GAG3B4qC,IAAaE,GAAAA,IACfjuC,KAAK6S,sBAAsBnB,EAAKvO,MAxBV,8BA4BL,CAACuO,EAAavO,KACjCnD,KAAKkuC,gBAAgB,CAAEjqC,KAAM,aAAcyN,IAAAA,EAAKvO,MAAAA,OA7BxB,iCAgCF,CAACuO,EAAavO,KACpCnD,KAAKkuC,gBAAgB,CAAEjqC,KAAM,iBAAkByN,IAAAA,EAAKvO,MAAAA,OAjC5B,oCAoCC,KACzB,MAAM,UAAEmU,EAAF,UAAa62B,GAAcnuC,KAAKN,MACtCM,KAAKN,MAAM0uC,YAAY92B,EAAW62B,EAAU/nC,WAtCpB,2BAyCR,CAACioC,EAAalpC,KAC9B,MAAM,mBAAEmT,GAAuBtY,KAAKN,MACpC,GAAI4Y,MAAAA,GAAAA,EAAoBg2B,YAAa,CACnC,MAAMC,EAAW,CAACvlC,EAAoBwlC,IACpCl2B,EAAmBg2B,YAAatlC,EAASwlC,GAC3CxuC,KAAKN,MAAM+uC,cAAczuC,KAAKN,MAAM4X,UAAW+2B,EAAQE,EAAUppC,OA9C3C,oBAkDdnB,IACVhE,KAAKN,MAAMgvC,WAAW1uC,KAAKN,MAAM4X,UAAWtT,MAnDpB,2BAsDR,KAEhBhE,KAAKN,MAAMivC,UAAU3uC,KAAKN,MAAM4X,cAxDR,0BA2DT,KACftX,KAAKN,MAAMkvC,eAAe,CAAEt3B,UAAWtX,KAAKN,MAAM4X,eA5D1B,6BA+DL3O,IACnB,MAAM,UAAE2O,EAAF,gBAAac,GAAoBpY,KAAKN,MAC5C0Y,EAAgB,CAAEd,UAAAA,EAAW3O,cAAAA,OAjEL,8BAoEJ0C,IACpB,MAAM,UAAEiM,EAAF,iBAAau3B,GAAqB7uC,KAAKN,MAC7CmvC,EAAiBv3B,EAAWjM,MAtEJ,iCAyEF,KACtBrL,KAAK4Q,UAAUrQ,IACN,CACLuuC,WAAYvuC,EAAMuuC,aAAezZ,GAActO,iBAActkB,EAAY4yB,GAActO,mBA5EnE,oCAiFC,KACzB/mB,KAAK4Q,UAAUrQ,IACN,CACLuuC,WAAYvuC,EAAMuuC,aAAezZ,GAAciB,oBAAiB7zB,EAAY4yB,GAAciB,sBApFtE,kCAgLDxkB,EAAAA,EAAAA,IAAY8sB,GAK5BA,EAAO90B,QAAQsE,IAAD,YAAsD,eAA3C,UAAAA,EAAM/I,YAAN,eAAY0pC,kCAnL5C/uC,KAAKO,MAAQ,CACXuuC,gBAAYrsC,GAsFhBusC,mBACE,gBACE,gBAAKzwC,UAAU,oBAAf,UACE,SAAC4+B,GAAD,OAKN8R,iBAAiBjkC,GACf,MAAM,YAAEkkC,EAAF,cAAevmC,EAAf,SAA8B9H,EAA9B,UAAwC6X,EAAxC,cAAmD6B,EAAnD,QAAkEvT,EAAlE,MAA2EpG,EAA3E,WAAkFyK,GAAerL,KAAKN,MACtGsC,EAAU6qC,SAASjsC,EAAMoB,QAAQ,GAAGxB,MAAM,GAAI,GAAI,IAClDuE,GAAQ,SAAC4oC,GAAD,CAAmBtiC,WAAYA,EAAYuiC,mBAAoB5tC,KAAK4tC,qBAClF,OACE,SAAC,EAAA70B,SAAD,CAAUhU,MAAOA,EAAOiC,QAASA,EAASgS,QAAM,EAAhD,UACE,SAACnO,GAAD,CACEQ,WAAYA,EACZP,KAAMokC,EACNnkC,OAAQ,IACRC,MAAOA,EAAQhJ,EACf2G,cAAeA,EACfE,aAAc7I,KAAK2sC,kBACnB9rC,SAAUA,EACVqK,YAAaqP,EAAcrP,YAC3BE,YAAasN,EACbzN,aAAcsP,EAAcha,UAMpC4uC,iBAAiBnkC,GACf,MAAM,eAAEsO,EAAF,UAAkBhC,EAAlB,mBAA6B83B,EAA7B,cAAiDzmC,EAAjD,SAAgE9H,EAAhE,UAA0E6X,GAAc1Y,KAAKN,MAEnG,OACE,SAACgtC,GAAD,CACE/jC,cAAeA,EACfqC,MAAOA,EACPsO,eAAgBA,EAChBqzB,kBAAmB3sC,KAAK2sC,kBACxB9rC,SAAUA,EACV6X,UAAWA,EACXk0B,iBAAkB,IAAMwC,EAAmB93B,KAKjD+3B,iBAAiBrkC,GACf,MAAM,UAAEsM,EAAF,mBAAagB,EAAb,SAAiCzX,GAAab,KAAKN,MACzD,OACE,SAAC,GAAD,CACEyc,UAAW+G,EAAAA,GAAAA,MAAAA,QAAAA,QAAAA,MACXlY,MAAOA,EACPsM,UAAWA,EACX4E,kBAAmB5D,MAAAA,GAAAA,EAAoBg2B,YAActuC,KAAKkc,uBAAoBzZ,EAC9E5B,SAAUA,IAKhByuC,gBAAgBtkC,GACd,MAAM,UAAEsM,EAAF,YAAakgB,EAAb,MAA0B52B,EAA1B,cAAiC2Z,GAAkBva,KAAKN,MACxDsC,EAAU6qC,SAASjsC,EAAMoB,QAAQ,GAAGxB,MAAM,GAAI,GAAI,IACxD,OACE,SAAC,GAAD,CACE8W,UAAWA,EACXrM,aAAcsP,EAAcha,MAC5Bi3B,YAAaA,EACbxsB,MAAOA,EAAQhJ,EACf4Q,mBAAoB5S,KAAK4S,mBACzBC,sBAAuB7S,KAAK6S,sBAC5BrB,gBAAiBxR,KAAKwR,gBACtBC,eAAgBzR,KAAKyR,iBAK3B89B,uBACE,MAAM,UAAEj4B,EAAF,UAAak4B,EAAb,cAAwBj1B,GAAkBva,KAAKN,MACrD,OACE,SAAC++B,GAAD,CACE/I,WAAY11B,KAAKyvC,uBAAuBl1B,EAAchL,QACtD+H,UAAWA,EACXonB,cAAe8Q,IAarBE,uBACE,MAAM,cAAEn1B,EAAF,UAAiB7B,EAAjB,UAA4BpB,GAActX,KAAKN,MAC/Cg2B,EAAanb,EAAchL,OAAOzF,QAAQyF,IAAD,YAAwD,WAA5C,UAAAA,EAAOlK,YAAP,eAAa0pC,+BAExE,OAEErZ,EAAWtvB,SACT,SAACqmC,GAAD,CACEn1B,UAAWA,EACXoe,WAAYA,EACZtqB,YAAasN,EACb8zB,cAAexsC,KAAKwsC,gBAM5B7rC,SACE,MAAM,mBACJ2X,EADI,kBAEJgjB,EAFI,UAGJhkB,EAHI,YAIJ43B,EAJI,cAKJ30B,EALI,OAMJ1B,EANI,MAOJjY,EAPI,YAQJ+uC,EARI,UASJC,EATI,SAUJC,EAVI,UAWJL,EAXI,cAYJM,EAZI,SAaJjvC,GACEb,KAAKN,OACH,WAAEovC,GAAe9uC,KAAKO,MACtBQ,EA5RSH,CAAAA,IACV,CACLmvC,YAAa9uC,EAAAA,GAAI;;;;;MAMjBgB,OAAQhB,EAAAA,GAAI;;;MAIZ4e,eAAgB5e,EAAAA,GAAI;;;;;;iBAMPL,EAAMoB,QAAQ;QA0QZG,CAAUvB,GACnBovC,EAAaz1B,GAAiBA,EAAcha,QAAUkgC,EAAAA,aAAAA,WACtDwP,EAAkBnB,IAAezZ,GAActO,YAC/CmpB,EAAqBpB,IAAezZ,GAAciB,eAExD,OACE,UAAC,EAAA1uB,gBAAD,CACEuoC,cAAe,OACfC,kBAAoB5D,GAAmBxsC,KAAKwsC,cAAgBA,QAAiB/pC,EAF/E,WAIE,SAACs6B,GAAD,CAAgBzlB,UAAWA,EAAWzO,aAAc7I,KAAK6I,eACxDyyB,EAAoBt7B,KAAKgvC,mBAAqB,KAC9C12B,IACC,iBAAK/Z,UAAU,oBAAf,WACE,iBAAKA,WAAWmE,EAAAA,EAAAA,IAAG,kBAAmB3B,EAAO8e,gBAA7C,WACE,SAAChG,GAAD,CAAWvC,UAAWA,KACtB,SAACwmB,GAAD,CACEK,0BAA2BtlB,EAG3BolB,yBAAyB,EACzBG,wBAAyB6R,EACzB3R,2BAA4B4R,EAC5BhS,yBAA0Bl+B,KAAKk+B,yBAC/BG,yBAA0Br+B,KAAKqwC,sBAC/B9R,4BAA6Bv+B,KAAKswC,4BAEpC,SAAC9P,GAAD,CAAwBlpB,UAAWA,QAErC,SAAC,IAAD,CAAWmc,SAAUzzB,KAAKyzB,SAAU8c,eAAa,EAAjD,SACG,EAAGvlC,MAAAA,KACY,IAAVA,EACK,MAIP,iBAAMzM,WAAWmE,EAAAA,EAAAA,IAAG3B,EAAOgvC,aAAclrC,MAAO,CAAEmG,MAAAA,GAAlD,UACE,UAAC,EAAAwlC,mBAAD,WACGR,IACC,gCACGL,GAAeT,IACd,SAAC,EAAAsB,mBAAD,UAAqBxwC,KAAKivC,iBAAiBjkC,MAE5C,SAAC,EAAAwlC,mBAAD,UAAqBxwC,KAAKmvC,iBAAiBnkC,KAC3C4kC,IAAa,SAAC,EAAAY,mBAAD,UAAqBxwC,KAAKqvC,iBAAiBrkC,KACxD6kC,IAAY,SAAC,EAAAW,mBAAD,UAAqBxwC,KAAKsvC,gBAAgBtkC,KACtD8kC,IAAiB,SAAC,EAAAU,mBAAD,UAAqBxwC,KAAKuvC,yBAC3CC,IAAa,SAAC,EAAAgB,mBAAD,UAAqBxwC,KAAK0vC,4BAG3CO,IACC,SAAC,GAAD,CACEjlC,MAAOA,EACPsM,UAAWA,EACXsP,QAAS5mB,KAAKqwC,wBAGjBH,IACC,SAAC,GAAD,CACE54B,UAAWA,EACXtM,MAAOA,EACP4b,QAAS5mB,KAAKswC,yBACdzvC,SAAUA,kBA6DpC,MAAMoY,GAAqB,CACzBy1B,WADyB,KAEzBG,iBAFyB,KAGzBJ,cAHyB,KAIzBE,UAJyB,KAKzBC,eALyB,KAMzBhwB,WANyB,KAOzBxG,gBAPyB,KAQzBg3B,mBARyB,KASzBhB,YATyB,KAUzB11B,UAASA,EAAAA,IAGLgD,IAAYxC,EAAAA,EAAAA,UA3DlB,SAAyB3Y,GAAmB,UAAE+W,IAC5C,MAAM6B,EAAU5Y,EAAM4Y,SAChB,YAAEqe,GAAgBre,EAClBjU,EAAyBiU,EAAQ7B,GACjCzW,GAAW0Y,EAAAA,EAAAA,GAAYhZ,EAAMiZ,OAC7B,mBACJlB,EADI,kBAEJgjB,EAFI,UAGJ6S,EAHI,OAIJt1B,EAJI,YAKJq2B,EALI,eAMJ51B,EANI,WAOJF,EAPI,SAQJy2B,EARI,YASJF,EATI,UAUJC,EAVI,UAWJJ,EAXI,cAYJ7mC,EAZI,cAaJ4R,EAbI,cAcJu1B,EAdI,QAeJ9oC,EAfI,WAgBJqE,GACEnG,EAEJ,MAAO,CACLoT,mBAAAA,EACAgjB,kBAAAA,EACA6S,UAAAA,EACAt1B,OAAAA,EACAq2B,YAAAA,EACA51B,eAAAA,EACAF,WAAYA,MAAAA,EAAAA,OAAc3W,EAC1BkG,cAAAA,EACA4R,cAAAA,EACAid,YAAAA,EACA32B,SAAAA,EACAgvC,SAAAA,EACAF,YAAAA,EACAC,UAAAA,EACAJ,UAAAA,EACAM,cAAAA,EACA9oC,QAAAA,EACAqE,WAAAA,KAiBuC4N,IAE3C,IAAew3B,EAAAA,EAAAA,SAAQ/0B,GAAWvX,EAAAA,WAAlC,CAA8C0pC,I,yHCva9C,MAAM6C,WAAwC9wC,EAAAA,cAI5CH,YAAYC,GACVC,MAAMD,GADkB,+EAmCRixC,IAChB,MAAM,UAAEr5B,EAAF,SAAas5B,GAAa5wC,KAAKN,MAGjCkxC,IAAaD,GAAgBC,IAAaC,EAAAA,GAAav5B,IACzDtX,KAAKN,MAAMoxC,eAAex5B,EAAWs5B,MAxCf,kBA4ChBG,IACR/wC,KAAK+wC,GAAKA,KA3CV/wC,KAAKgxC,cAAgB,IAAIC,EAAAA,YACzBjxC,KAAKO,MAAQ,CACXuuC,gBAAYrsC,GAIhB+jB,oBAAoB,QAClB,MAAM,YAAE0qB,EAAF,UAAe55B,EAAf,kBAA0B65B,EAA1B,eAA6CC,EAA7C,aAA6DC,EAA7D,cAA2EzX,GAAkB55B,KAAKN,MAClGsL,EAAK,oBAAGhL,KAAK+wC,UAAR,aAAG,EAASliB,mBAAZ,QAA2B,EAGjCqiB,GACHlxC,KAAKN,MAAM4xC,kBACTh6B,EACA65B,EACAC,EACAC,EACArmC,EACAhL,KAAKgxC,cACLpX,GAKNpnB,uBACExS,KAAKgxC,cAAcO,qBACnBvxC,KAAKN,MAAM8xC,kBAAkB,CAAEl6B,UAAWtX,KAAKN,MAAM4X,YAGvDmP,mBAAmBC,GACjB1mB,KAAK8wC,eAAepqB,EAAUkqB,UAgBhCjwC,SACE,MAAM8wC,EAAezxC,KAAKN,MAAM87B,MAAQ,wBAA0B,UAClE,OACE,gBAAKj9B,UAAWkzC,EAAc9uC,IAAK3C,KAAK0xC,OAAQ,cAAaxuB,EAAAA,GAAAA,MAAAA,QAAAA,QAAAA,UAA7D,SACGljB,KAAKN,MAAMwxC,cAAe,SAAC,GAAD,CAAS55B,UAAWtX,KAAKN,MAAM4X,eAMlE,MAAMq6B,IAAwB7/B,EAAAA,EAAAA,GAAW8/B,EAAAA,IACnCC,IAA8B//B,EAAAA,EAAAA,GAAWggC,EAAAA,IAuB/C,MAAM74B,GAAqB,CACzBq4B,kBADyB,KAEzBR,eAFyB,KAGzBU,kBAAiBA,EAAAA,IAGb91B,IAAYxC,EAAAA,EAAAA,UA3BlB,SAAyB3Y,EAAmBb,GAAiB,MAC3D,MAAMqyC,GAAWC,EAAAA,EAAAA,IAActyC,EAAMkxC,UAC/B/vC,GAAW0Y,EAAAA,EAAAA,GAAYhZ,EAAMiZ,MAC7B8d,GAAuB4F,EAAAA,EAAAA,GAAwB38B,EAAMiZ,OAErD,WAAEy4B,EAAF,QAAcjpC,EAAS2P,MAAOu5B,EAA9B,cAAwCtY,GAAmBmY,GAAY,GACvEZ,EAAoBc,GAAc3hC,EAAAA,EAAAA,KAAU6hC,EAAAA,EAAAA,IAA8B5xC,EAAMiZ,KAAK44B,QACrFhB,EAA8BO,GAAsB3oC,GACpDqoC,EAAea,EACjBL,GAA4BK,EAAUrxC,EAAUy2B,IAChD+a,EAAAA,EAAAA,IAAaxxC,EAAUyxC,EAAAA,GAAehb,GAE1C,MAAO,CACL4Z,YAAW,UAAE3wC,EAAM4Y,QAAQzZ,EAAM4X,kBAAtB,aAAE,EAAgC45B,YAC7CC,kBAAAA,EACAC,eAAAA,EACAC,aAAAA,EACAzX,cAAAA,KAUuC3gB,IAE9Bs5B,GAAuB72B,GAAUg1B,I,+GC/G9C,MAOMz3B,GAAqB,CACzBu5B,mBADyB,KAEzBC,yBAAwBA,EAAAA,IAGpB/2B,IAAYxC,EAAAA,EAAAA,UAZO3Y,IAChB,CACLmyC,UAAUC,EAAAA,GAAAA,GAAYpyC,EAAMqyC,SAAU,WACtCC,aAActyC,EAAM4Y,WASmBF,IAG3C,MAAM65B,WAA2BtzC,EAAAA,cAC/BgT,uBACExS,KAAKN,MAAM8yC,mBAAmB,IAGhChsB,oBACEqqB,EAAAA,GAAAA,UAAoBpuC,EACpBouC,EAAAA,GAAAA,WAAqBpuC,EAErB,MAAMkkB,GAAcosB,EAAAA,EAAAA,MACpB/yC,KAAKN,MAAM+yC,yBAAyB,CAAE9rB,YAAAA,IAGxCF,mBAAmBC,GAAkB,YACnC,MAAM,KAAEiC,EAAF,MAAQE,GAAU7oB,KAAKN,MAAMszC,YAE7BC,EADWt5B,QAAQgP,IAAShP,QAAQkP,GAErC,GAAD,UAAG7oB,KAAKN,MAAMmzC,aAAalqB,KAAKrQ,0BAAhC,aAAG,EAAiDxU,UAApD,UAA8D9D,KAAKN,MAAMmzC,aAAahqB,aAAtF,iBAA8D,EAA+BvQ,0BAA7F,aAA8D,EAAmDxU,OAChH,GAAD,UAAG9D,KAAKN,MAAMmzC,aAAalqB,KAAKrQ,0BAAhC,aAAG,EAAiDxU,OAClDovC,EAAiB,GAAElzC,KAAKN,MAAMgzC,SAASnqC,KAAK/G,UAAUyxC,OAAqBE,GAAAA,EAAAA,WACjFpmB,SAASniB,MAAQsoC,EAGnBvyC,SACE,MAAM,KAAEgoB,EAAF,MAAQE,GAAU7oB,KAAKN,MAAMszC,YAC7BI,EAAWz5B,QAAQgP,IAAShP,QAAQkP,GAE1C,OACE,gBAAKtqB,UAAU,yBAAf,UACE,iBAAKA,UAAU,kBAAf,WACE,SAAC,EAAAiyC,mBAAD,CAAoB3rC,MAAM,OAA1B,UACE,SAAC0tC,GAAD,CAAsB/W,MAAO4X,EAAU97B,UAAWsC,EAAAA,EAAAA,KAAgBg3B,SAAUjoB,MAE7EyqB,IACC,SAAC,EAAA5C,mBAAD,CAAoB3rC,MAAM,OAA1B,UACE,SAAC0tC,GAAD,CAAsB/W,MAAO4X,EAAU97B,UAAWsC,EAAAA,EAAAA,MAAiBg3B,SAAU/nB,YAS3F,MAEA,GAFgBnN,GAAUo3B,K,s0CC3DtBO,EAAc,SAAqBC,EAAMC,GAC3C,OAAOD,GAAQC,GAAWA,EAAQ/X,MAAM,KAAKrtB,SAAQ,SAAUqf,GAC7D,OAAO,OAAe8lB,EAAM9lB,OA0E5B/W,EAA6B,SAAU+8B,GAGzC,SAAS/8B,IAGP,IAFA,IAAI6S,EAEKmqB,EAAOjrB,UAAUpiB,OAAQstC,EAAO,IAAI/rB,MAAM8rB,GAAOE,EAAO,EAAGA,EAAOF,EAAME,IAC/ED,EAAKC,GAAQnrB,UAAUmrB,GAgHzB,OA7GArqB,EAAQkqB,EAAiBzrB,KAAKU,MAAM+qB,EAAkB,CAACxzC,MAAM4R,OAAO8hC,KAAU1zC,MACxE4zC,eAAiB,CACrBC,OAAQ,GACR78B,MAAO,GACPE,KAAM,IAGRoS,EAAMwqB,QAAU,SAAUC,EAAWC,GACnC,IAAIC,EAAwB3qB,EAAM4qB,iBAAiBH,EAAWC,GAC1DV,EAAOW,EAAsB,GAC7BE,EAAYF,EAAsB,GAEtC3qB,EAAM8qB,cAAcd,EAAM,QAE1BhqB,EAAM+qB,SAASf,EAAMa,EAAY,SAAW,QAAS,QAEjD7qB,EAAM5pB,MAAMo0C,SACdxqB,EAAM5pB,MAAMo0C,QAAQC,EAAWC,IAInC1qB,EAAMgrB,WAAa,SAAUP,EAAWC,GACtC,IAAIO,EAAyBjrB,EAAM4qB,iBAAiBH,EAAWC,GAC3DV,EAAOiB,EAAuB,GAG9BtwC,EAFYswC,EAAuB,GAEhB,SAAW,QAElCjrB,EAAM+qB,SAASf,EAAMrvC,EAAM,UAEvBqlB,EAAM5pB,MAAM40C,YACdhrB,EAAM5pB,MAAM40C,WAAWP,EAAWC,IAItC1qB,EAAMkrB,UAAY,SAAUT,EAAWC,GACrC,IAAIS,EAAyBnrB,EAAM4qB,iBAAiBH,EAAWC,GAC3DV,EAAOmB,EAAuB,GAG9BxwC,EAFYwwC,EAAuB,GAEhB,SAAW,QAElCnrB,EAAM8qB,cAAcd,EAAMrvC,GAE1BqlB,EAAM+qB,SAASf,EAAMrvC,EAAM,QAEvBqlB,EAAM5pB,MAAM80C,WACdlrB,EAAM5pB,MAAM80C,UAAUT,EAAWC,IAIrC1qB,EAAMorB,OAAS,SAAUX,GACvB,IACIT,EADyBhqB,EAAM4qB,iBAAiBH,GAClB,GAElCzqB,EAAM8qB,cAAcd,EAAM,UAE1BhqB,EAAM8qB,cAAcd,EAAM,SAE1BhqB,EAAM+qB,SAASf,EAAM,OAAQ,QAEzBhqB,EAAM5pB,MAAMg1C,QACdprB,EAAM5pB,MAAMg1C,OAAOX,IAIvBzqB,EAAMqrB,UAAY,SAAUZ,GAC1B,IACIT,EADyBhqB,EAAM4qB,iBAAiBH,GAClB,GAElCzqB,EAAM+qB,SAASf,EAAM,OAAQ,UAEzBhqB,EAAM5pB,MAAMi1C,WACdrrB,EAAM5pB,MAAMi1C,UAAUZ,IAI1BzqB,EAAM2W,SAAW,SAAU8T,GACzB,IACIT,EADyBhqB,EAAM4qB,iBAAiBH,GAClB,GAElCzqB,EAAM8qB,cAAcd,EAAM,QAE1BhqB,EAAM+qB,SAASf,EAAM,OAAQ,QAEzBhqB,EAAM5pB,MAAMugC,UACd3W,EAAM5pB,MAAMugC,SAAS8T,IAIzBzqB,EAAM4qB,iBAAmB,SAAUH,EAAWC,GAC5C,OAAO1qB,EAAM5pB,MAAMk1C,QAAU,CAACtrB,EAAM5pB,MAAMk1C,QAAQ32C,QAAS81C,GACzD,CAACA,EAAWC,IAGhB1qB,EAAMurB,cAAgB,SAAU5wC,GAC9B,IAAI8S,EAAauS,EAAM5pB,MAAMqX,WACzB+9B,EAA2C,iBAAf/9B,EAE5BiV,EAAgB8oB,EAAqB,IAD5BA,GAAsB/9B,EAAaA,EAAa,IAAM,IACZ9S,EAAO8S,EAAW9S,GAGzE,MAAO,CACL+nB,cAAeA,EACf+oB,gBAJoBD,EAAqB9oB,EAAgB,UAAYjV,EAAW9S,EAAO,UAKvF+wC,cAJkBF,EAAqB9oB,EAAgB,QAAUjV,EAAW9S,EAAO,UAQhFqlB,GAtHT,OAAe7S,EAAe+8B,GAyH9B,IAAIyB,EAASx+B,EAAcoR,UA6D3B,OA3DAotB,EAAOZ,SAAW,SAAkBf,EAAMrvC,EAAMixC,GAC9C,IAAI32C,EAAYyB,KAAK60C,cAAc5wC,GAAMixC,EAAQ,aAG7CF,EADsBh1C,KAAK60C,cAAc,SACLG,cAE3B,WAAT/wC,GAA+B,SAAVixC,GAAoBF,IAC3Cz2C,GAAa,IAAMy2C,GAKP,WAAVE,GAEF5B,GAAQA,EAAKrzC,UAGX1B,IACFyB,KAAK4zC,eAAe3vC,GAAMixC,GAAS32C,EAhOzB,SAAkB+0C,EAAMC,GAC/BD,GAAQC,GAAWA,EAAQ/X,MAAM,KAAKrtB,SAAQ,SAAUqf,GAC7D,OAAO,OAAY8lB,EAAM9lB,MAgOvB2nB,CAAU7B,EAAM/0C,KAIpB02C,EAAOb,cAAgB,SAAuBd,EAAMrvC,GAClD,IAAImxC,EAAwBp1C,KAAK4zC,eAAe3vC,GAC5C+nB,EAAgBopB,EAAsB31B,KACtCs1B,EAAkBK,EAAsBC,OACxCL,EAAgBI,EAAsBE,KAC1Ct1C,KAAK4zC,eAAe3vC,GAAQ,GAExB+nB,GACFqnB,EAAYC,EAAMtnB,GAGhB+oB,GACF1B,EAAYC,EAAMyB,GAGhBC,GACF3B,EAAYC,EAAM0B,IAItBC,EAAOt0C,OAAS,WACd,IAAI40C,EAAcv1C,KAAKN,MAEnBA,GADI61C,EAAYx+B,YACR,OAA8Bw+B,EAAa,CAAC,gBAExD,OAAoB,gBAAoB,MAAY,OAAS,GAAI71C,EAAO,CACtEo0C,QAAS9zC,KAAK8zC,QACdU,UAAWx0C,KAAKw0C,UAChBF,WAAYt0C,KAAKs0C,WACjBI,OAAQ10C,KAAK00C,OACbC,UAAW30C,KAAK20C,UAChB1U,SAAUjgC,KAAKigC,aAIZxpB,EAvLwB,CAwL/B,aAEFA,EAAcke,aAAe,CAC3B5d,WAAY,IAEdN,EAAc++B,UAiIT,GACL,W,sTC1Ze,SAAS3pC,EAAYtL,GAChC,IAAIoC,GAAM,IAAA5E,UAIV,OAHA,IAAAC,YAAU,WACN2E,EAAI1E,QAAUsC,KAEXoC,EAAI1E,U,wHCyBf,SAASw3C,EAASC,EAAIC,EAAOC,EAAYC,GACvC,IALoB1yC,EAKhB2yC,EAJY,OADI3yC,EAKO0yC,IAJc,iBAAV1yC,GAAuC,kBAAVA,EAI1B0yC,EAAMD,EAAWC,GAE/CE,EAAgBJ,EAAM90B,IAAIi1B,GAM9B,YAL6B,IAAlBC,IACTA,EAAgBL,EAAG3tB,KAAK/nB,KAAM61C,GAC9BF,EAAMnQ,IAAIsQ,EAAUC,IAGfA,EAGT,SAASC,EAAUN,EAAIC,EAAOC,GAC5B,IAAIlC,EAAO/rB,MAAME,UAAUrnB,MAAMunB,KAAKS,UAAW,GAC7CstB,EAAWF,EAAWlC,GAEtBqC,EAAgBJ,EAAM90B,IAAIi1B,GAM9B,YAL6B,IAAlBC,IACTA,EAAgBL,EAAGjtB,MAAMzoB,KAAM0zC,GAC/BiC,EAAMnQ,IAAIsQ,EAAUC,IAGfA,EAGT,SAASE,EAAUP,EAAIvb,EAAS+b,EAAUP,EAAOQ,GAC/C,OAAOD,EAAS/nB,KACdgM,EACAub,EACAC,EACAQ,GAIJ,SAASC,EAAiBV,EAAIhmC,GAG5B,OAAOumC,EACLP,EACA11C,KAJ2B,IAAd01C,EAAGtvC,OAAeqvC,EAAUO,EAMzCtmC,EAAQimC,MAAMxtB,SACdzY,EAAQkmC,YAgCZ,SAASS,IACP,OAAOC,KAAKC,UAAU/tB,WAOxB,SAASguB,IACPx2C,KAAK21C,MAAQrhC,OAAO6T,OAAO,MAG7BquB,EAA4B3uB,UAAU2e,IAAM,SAAU90B,GACpD,OAAQA,KAAO1R,KAAK21C,OAGtBa,EAA4B3uB,UAAUhH,IAAM,SAAUnP,GACpD,OAAO1R,KAAK21C,MAAMjkC,IAGpB8kC,EAA4B3uB,UAAU2d,IAAM,SAAU9zB,EAAKvO,GACzDnD,KAAK21C,MAAMjkC,GAAOvO,GAGpB,IAAIszC,EAAe,CACjBtuB,OAAQ,WACN,OAAO,IAAIquB,IAQfE,EAAOC,QAvIP,SAAkBjB,EAAIhmC,GACpB,IAAIimC,EAAQjmC,GAAWA,EAAQimC,MAC3BjmC,EAAQimC,MACRc,EAEAb,EAAalmC,GAAWA,EAAQkmC,WAChClmC,EAAQkmC,WACRS,EAMJ,OAJe3mC,GAAWA,EAAQwmC,SAC9BxmC,EAAQwmC,SACRE,GAEYV,EAAI,CAClBC,MAAOA,EACPC,WAAYA,KAyHhBc,EAAOC,QAAQC,WAAa,CAC1BZ,SAhEF,SAA2BN,EAAIhmC,GAG7B,OAAOumC,EACLP,EACA11C,KAJag2C,EAMbtmC,EAAQimC,MAAMxtB,SACdzY,EAAQkmC,aAyDVH,QArDF,SAA0BC,EAAIhmC,GAG5B,OAAOumC,EACLP,EACA11C,KAJay1C,EAMb/lC,EAAQimC,MAAMxtB,SACdzY,EAAQkmC","sources":["webpack://grafana/./.yarn/__virtual__/react-use-virtual-ca2705900f/3/opt/drone/yarncache/react-use-npm-17.2.4-c702db5427-3c885c3798.zip/node_modules/react-use/esm/useInterval.js","webpack://grafana/./public/app/features/explore/Time.tsx","webpack://grafana/./public/app/features/explore/ElapsedTime.tsx","webpack://grafana/./public/app/features/explore/LiveLogs.tsx","webpack://grafana/./public/app/features/explore/MetaInfoText.tsx","webpack://grafana/./public/app/features/explore/LogsMetaRow.tsx","webpack://grafana/./public/app/features/explore/LogsNavigationPages.tsx","webpack://grafana/./public/app/features/explore/LogsNavigation.tsx","webpack://grafana/./public/app/features/explore/ExploreGraph.tsx","webpack://grafana/./public/app/features/explore/exploreGraphStyleUtils.ts","webpack://grafana/./public/app/features/explore/Logs.tsx","webpack://grafana/./public/app/features/explore/utils/LogsCrossFadeTransition.tsx","webpack://grafana/./public/app/features/explore/useLiveTailControls.ts","webpack://grafana/./public/app/features/explore/LogsContainer.tsx","webpack://grafana/./public/app/features/explore/state/selectors.ts","webpack://grafana/./public/app/features/explore/QueryRows.tsx","webpack://grafana/./public/app/features/explore/TableContainer.tsx","webpack://grafana/./public/app/features/explore/RichHistory/RichHistorySettings.tsx","webpack://grafana/./public/app/features/explore/RichHistory/RichHistoryCard.tsx","webpack://grafana/./public/app/features/explore/RichHistory/RichHistoryQueriesTab.tsx","webpack://grafana/./public/app/features/explore/RichHistory/RichHistoryStarredTab.tsx","webpack://grafana/./public/app/features/explore/RichHistory/RichHistory.tsx","webpack://grafana/./.yarn/__virtual__/re-resizable-virtual-ea246c6580/3/opt/drone/yarncache/re-resizable-npm-6.9.1-79ca365a45-b164f6b956.zip/node_modules/re-resizable/lib/resizer.js","webpack://grafana/./.yarn/__virtual__/re-resizable-virtual-ea246c6580/3/opt/drone/yarncache/re-resizable-npm-6.9.1-79ca365a45-b164f6b956.zip/node_modules/re-resizable/lib/index.js","webpack://grafana/./public/app/features/explore/ExploreDrawer.tsx","webpack://grafana/./public/app/features/explore/RichHistory/RichHistoryContainer.tsx","webpack://grafana/./public/app/features/explore/ExploreQueryInspector.tsx","webpack://grafana/./public/app/features/explore/TimeSyncButton.tsx","webpack://grafana/./public/app/features/explore/ExploreTimeControls.tsx","webpack://grafana/./public/app/features/explore/LiveTailButton.tsx","webpack://grafana/./public/app/features/explore/RunButton.tsx","webpack://grafana/./public/app/features/explore/ReturnToDashboardButton.tsx","webpack://grafana/./public/app/features/explore/ExploreToolbar.tsx","webpack://grafana/./public/app/features/explore/NoDataSourceCallToAction.tsx","webpack://grafana/./public/app/features/explore/SecondaryActions.tsx","webpack://grafana/./public/app/features/explore/NodeGraphContainer.tsx","webpack://grafana/./public/app/core/components/Animations/FadeIn.tsx","webpack://grafana/./public/app/features/explore/ErrorContainer.tsx","webpack://grafana/./public/app/features/explore/ResponseErrorContainer.tsx","webpack://grafana/./public/app/features/explore/TraceView/createSpanLink.tsx","webpack://grafana/./public/app/features/explore/TraceView/uiElements.tsx","webpack://grafana/./public/app/features/explore/TraceView/useChildrenState.ts","webpack://grafana/./public/app/features/explore/TraceView/useDetailState.ts","webpack://grafana/./public/app/features/explore/TraceView/TraceView.tsx","webpack://grafana/./public/app/features/explore/TraceView/useHoverIndentGuide.ts","webpack://grafana/./public/app/features/explore/TraceView/useViewRange.ts","webpack://grafana/./public/app/features/explore/TraceView/useSearch.ts","webpack://grafana/./public/app/features/explore/TraceView/TraceViewContainer.tsx","webpack://grafana/./public/app/features/explore/LogsVolumePanel.tsx","webpack://grafana/./public/app/features/explore/ExploreGraphLabel.tsx","webpack://grafana/./public/app/features/explore/Explore.tsx","webpack://grafana/./public/app/features/explore/ExplorePaneContainer.tsx","webpack://grafana/./public/app/features/explore/Wrapper.tsx","webpack://grafana/./.yarn/__virtual__/react-transition-group-virtual-08a7713bd0/3/opt/drone/yarncache/react-transition-group-npm-4.4.1-5b62a122ef-0bcd8af483.zip/node_modules/react-transition-group/esm/CSSTransition.js","webpack://grafana/./.yarn/__virtual__/react-use-virtual-ca2705900f/3/opt/drone/yarncache/react-use-npm-17.2.4-c702db5427-3c885c3798.zip/node_modules/react-use/esm/usePrevious.js","webpack://grafana/../../opt/drone/yarncache/fast-memoize-npm-2.5.2-f42a7c6940-79fa759719.zip/node_modules/fast-memoize/src/index.js"],"sourcesContent":["import { useEffect, useRef } from 'react';\nvar useInterval = function (callback, delay) {\n    var savedCallback = useRef(function () { });\n    useEffect(function () {\n        savedCallback.current = callback;\n    });\n    useEffect(function () {\n        if (delay !== null) {\n            var interval_1 = setInterval(function () { return savedCallback.current(); }, delay || 0);\n            return function () { return clearInterval(interval_1); };\n        }\n        return undefined;\n    }, [delay]);\n};\nexport default useInterval;\n","import React, { FC } from 'react';\nimport { toDuration } from '@grafana/data';\n\nexport interface TimeProps {\n  timeInMs: number;\n  className?: string;\n  humanize?: boolean;\n}\n\nexport const Time: FC<TimeProps> = ({ timeInMs, className, humanize }) => {\n  return <span className={`elapsed-time ${className}`}>{formatTime(timeInMs, humanize)}</span>;\n};\n\nconst formatTime = (timeInMs: number, humanize = false): string => {\n  const inSeconds = timeInMs / 1000;\n\n  if (!humanize) {\n    return `${inSeconds.toFixed(1)}s`;\n  }\n\n  const duration = toDuration(inSeconds, 'seconds');\n  const hours = duration.hours();\n  const minutes = duration.minutes();\n  const seconds = duration.seconds();\n\n  if (hours) {\n    return `${hours}h ${minutes}m ${seconds}s`;\n  }\n\n  if (minutes) {\n    return `${minutes}m ${seconds}s`;\n  }\n\n  return `${seconds}s`;\n};\n","import React, { FC, useState, useEffect } from 'react';\nimport { useInterval } from 'react-use';\nimport { Time, TimeProps } from './Time';\n\nconst INTERVAL = 150;\n\nexport interface ElapsedTimeProps extends Omit<TimeProps, 'timeInMs'> {\n  // Use this to reset the timer. Any value is allowed just need to be !== from the previous.\n  // Keep in mind things like [] !== [] or {} !== {}.\n  resetKey?: any;\n}\n\nexport const ElapsedTime: FC<ElapsedTimeProps> = ({ resetKey, humanize, className }) => {\n  const [elapsed, setElapsed] = useState(0); // the current value of elapsed\n\n  // hook that will schedule a interval and then update the elapsed value on every tick.\n  useInterval(() => setElapsed(elapsed + INTERVAL), INTERVAL);\n  // this effect will only be run when resetKey changes. This will reset the elapsed to 0.\n  useEffect(() => setElapsed(0), [resetKey]);\n\n  return <Time timeInMs={elapsed} className={className} humanize={humanize} />;\n};\n","import React, { PureComponent } from 'react';\nimport { css, cx } from '@emotion/css';\nimport tinycolor from 'tinycolor2';\n\nimport { LogMessageAnsi, getLogRowStyles, Icon, Button, Themeable2, withTheme2 } from '@grafana/ui';\nimport { LogRowModel, TimeZone, dateTimeFormat, GrafanaTheme2 } from '@grafana/data';\n\nimport { ElapsedTime } from './ElapsedTime';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  logsRowsLive: css`\n    label: logs-rows-live;\n    font-family: ${theme.typography.fontFamilyMonospace};\n    font-size: ${theme.typography.bodySmall.fontSize};\n    display: flex;\n    flex-flow: column nowrap;\n    height: 60vh;\n    overflow-y: scroll;\n    :first-child {\n      margin-top: auto !important;\n    }\n  `,\n  logsRowFade: css`\n    label: logs-row-fresh;\n    color: ${theme.colors.text};\n    background-color: ${tinycolor(theme.colors.info.transparent).setAlpha(0.25).toString()};\n    animation: fade 1s ease-out 1s 1 normal forwards;\n    @keyframes fade {\n      from {\n        background-color: ${tinycolor(theme.colors.info.transparent).setAlpha(0.25).toString()};\n      }\n      to {\n        background-color: transparent;\n      }\n    }\n  `,\n  logsRowsIndicator: css`\n    font-size: ${theme.typography.h6.fontSize};\n    padding-top: ${theme.spacing(1)};\n    display: flex;\n    align-items: center;\n  `,\n  button: css`\n    margin-right: ${theme.spacing(1)};\n  `,\n  fullWidth: css`\n    width: 100%;\n  `,\n});\n\nexport interface Props extends Themeable2 {\n  logRows?: LogRowModel[];\n  timeZone: TimeZone;\n  stopLive: () => void;\n  onPause: () => void;\n  onResume: () => void;\n  isPaused: boolean;\n}\n\ninterface State {\n  logRowsToRender?: LogRowModel[];\n}\n\nclass LiveLogs extends PureComponent<Props, State> {\n  private liveEndDiv: HTMLDivElement | null = null;\n  private scrollContainerRef = React.createRef<HTMLTableSectionElement>();\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      logRowsToRender: props.logRows,\n    };\n  }\n\n  static getDerivedStateFromProps(nextProps: Props, state: State) {\n    if (!nextProps.isPaused) {\n      return {\n        // We update what we show only if not paused. We keep any background subscriptions running and keep updating\n        // our state, but we do not show the updates, this allows us start again showing correct result after resuming\n        // without creating a gap in the log results.\n        logRowsToRender: nextProps.logRows,\n      };\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Handle pausing when user scrolls up so that we stop resetting his position to the bottom when new row arrives.\n   * We do not need to throttle it here much, adding new rows should be throttled/buffered itself in the query epics\n   * and after you pause we remove the handler and add it after you manually resume, so this should not be fired often.\n   */\n  onScroll = (event: React.SyntheticEvent) => {\n    const { isPaused, onPause } = this.props;\n    const { scrollTop, clientHeight, scrollHeight } = event.currentTarget;\n    const distanceFromBottom = scrollHeight - (scrollTop + clientHeight);\n    if (distanceFromBottom >= 5 && !isPaused) {\n      onPause();\n    }\n  };\n\n  rowsToRender = () => {\n    const { isPaused } = this.props;\n    let { logRowsToRender: rowsToRender = [] } = this.state;\n    if (!isPaused) {\n      // A perf optimisation here. Show just 100 rows when streaming and full length when the streaming is paused.\n      rowsToRender = rowsToRender.slice(-100);\n    }\n    return rowsToRender;\n  };\n\n  render() {\n    const { theme, timeZone, onPause, onResume, isPaused } = this.props;\n    const styles = getStyles(theme);\n    const { logsRow, logsRowLocalTime, logsRowMessage } = getLogRowStyles(theme);\n\n    return (\n      <div>\n        <table className={styles.fullWidth}>\n          <tbody\n            onScroll={isPaused ? undefined : this.onScroll}\n            className={cx(['logs-rows', styles.logsRowsLive])}\n            ref={this.scrollContainerRef}\n          >\n            {this.rowsToRender().map((row: LogRowModel) => {\n              return (\n                <tr className={cx(logsRow, styles.logsRowFade)} key={row.uid}>\n                  <td className={cx(logsRowLocalTime)}>{dateTimeFormat(row.timeEpochMs, { timeZone })}</td>\n                  <td className={cx(logsRowMessage)}>{row.hasAnsi ? <LogMessageAnsi value={row.raw} /> : row.entry}</td>\n                </tr>\n              );\n            })}\n            <tr\n              ref={(element) => {\n                this.liveEndDiv = element;\n                // This is triggered on every update so on every new row. It keeps the view scrolled at the bottom by\n                // default.\n                if (this.liveEndDiv && !isPaused) {\n                  this.scrollContainerRef.current?.scrollTo(0, this.scrollContainerRef.current.scrollHeight);\n                }\n              }}\n            />\n          </tbody>\n        </table>\n        <div className={styles.logsRowsIndicator}>\n          <Button variant=\"secondary\" onClick={isPaused ? onResume : onPause} className={styles.button}>\n            <Icon name={isPaused ? 'play' : 'pause'} />\n            &nbsp;\n            {isPaused ? 'Resume' : 'Pause'}\n          </Button>\n          <Button variant=\"secondary\" onClick={this.props.stopLive} className={styles.button}>\n            <Icon name=\"square-shape\" size=\"lg\" type=\"mono\" />\n            &nbsp; Exit live mode\n          </Button>\n          {isPaused || (\n            <span>\n              Last line received: <ElapsedTime resetKey={this.props.logRows} humanize={true} /> ago\n            </span>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport const LiveLogsWithTheme = withTheme2(LiveLogs);\n","import React, { memo } from 'react';\nimport { css } from '@emotion/css';\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  metaContainer: css`\n    flex: 1;\n    color: ${theme.colors.text.secondary};\n    margin-bottom: ${theme.spacing(2)};\n    min-width: 30%;\n    display: flex;\n    flex-wrap: wrap;\n  `,\n  metaItem: css`\n    margin-right: ${theme.spacing(2)};\n    margin-top: ${theme.spacing(0.5)};\n    display: flex;\n    align-items: baseline;\n\n    .logs-meta-item__error {\n      color: ${theme.colors.error.text};\n    }\n  `,\n  metaLabel: css`\n    margin-right: calc(${theme.spacing(2)} / 2);\n    font-size: ${theme.typography.bodySmall.fontSize};\n    font-weight: ${theme.typography.fontWeightMedium};\n  `,\n  metaValue: css`\n    font-family: ${theme.typography.fontFamilyMonospace};\n    font-size: ${theme.typography.bodySmall.fontSize};\n  `,\n});\n\nexport interface MetaItemProps {\n  label?: string;\n  value: string | JSX.Element;\n}\n\nconst MetaInfoItem = memo(function MetaInfoItem(props: MetaItemProps) {\n  const style = useStyles2(getStyles);\n  const { label, value } = props;\n\n  return (\n    <div className={style.metaItem}>\n      {label && <span className={style.metaLabel}>{label}:</span>}\n      <span className={style.metaValue}>{value}</span>\n    </div>\n  );\n});\n\ninterface MetaInfoTextProps {\n  metaItems: MetaItemProps[];\n}\n\nexport const MetaInfoText = memo(function MetaInfoText(props: MetaInfoTextProps) {\n  const style = useStyles2(getStyles);\n  const { metaItems } = props;\n\n  return (\n    <div className={style.metaContainer}>\n      {metaItems.map((item, index) => (\n        <MetaInfoItem key={`${index}-${item.label}`} label={item.label} value={item.value} />\n      ))}\n    </div>\n  );\n});\n","import React from 'react';\nimport { LogsDedupStrategy, LogsMetaItem, LogsMetaKind, LogRowModel } from '@grafana/data';\nimport { Button, Tooltip, Icon, LogLabels } from '@grafana/ui';\nimport { MAX_CHARACTERS } from '@grafana/ui/src/components/Logs/LogRowMessage';\nimport { MetaInfoText, MetaItemProps } from './MetaInfoText';\n\nexport type Props = {\n  meta: LogsMetaItem[];\n  dedupStrategy: LogsDedupStrategy;\n  dedupCount: number;\n  showDetectedFields: string[];\n  hasUnescapedContent: boolean;\n  forceEscape: boolean;\n  logRows: LogRowModel[];\n  onEscapeNewlines: () => void;\n  clearDetectedFields: () => void;\n};\n\nexport const LogsMetaRow: React.FC<Props> = React.memo(\n  ({\n    meta,\n    dedupStrategy,\n    dedupCount,\n    showDetectedFields,\n    clearDetectedFields,\n    hasUnescapedContent,\n    forceEscape,\n    onEscapeNewlines,\n    logRows,\n  }) => {\n    const logsMetaItem: Array<LogsMetaItem | MetaItemProps> = [...meta];\n\n    // Add deduplication info\n    if (dedupStrategy !== LogsDedupStrategy.none) {\n      logsMetaItem.push({\n        label: 'Dedup count',\n        value: dedupCount,\n        kind: LogsMetaKind.Number,\n      });\n    }\n    // Add info about limit for highlighting\n    if (logRows.some((r) => r.entry.length > MAX_CHARACTERS)) {\n      logsMetaItem.push({\n        label: 'Info',\n        value: 'Logs with more than 100,000 characters could not be parsed and highlighted',\n        kind: LogsMetaKind.String,\n      });\n    }\n\n    // Add detected fields info\n    if (showDetectedFields?.length > 0) {\n      logsMetaItem.push(\n        {\n          label: 'Showing only detected fields',\n          value: renderMetaItem(showDetectedFields, LogsMetaKind.LabelsMap),\n        },\n        {\n          label: '',\n          value: (\n            <Button variant=\"secondary\" size=\"sm\" onClick={clearDetectedFields}>\n              Show all detected fields\n            </Button>\n          ),\n        }\n      );\n    }\n\n    // Add unescaped content info\n    if (hasUnescapedContent) {\n      logsMetaItem.push({\n        label: 'Your logs might have incorrectly escaped content',\n        value: (\n          <Tooltip\n            content=\"We suggest to try to fix the escaping of your log lines first. This is an experimental feature, your logs might not be correctly escaped.\"\n            placement=\"right\"\n          >\n            <Button variant=\"secondary\" size=\"sm\" onClick={onEscapeNewlines}>\n              <span>{forceEscape ? 'Remove escaping' : 'Escape newlines'}&nbsp;</span>\n              <Icon name=\"exclamation-triangle\" className=\"muted\" size=\"sm\" />\n            </Button>\n          </Tooltip>\n        ),\n      });\n    }\n\n    return (\n      <>\n        {logsMetaItem && (\n          <MetaInfoText\n            metaItems={logsMetaItem.map((item) => {\n              return {\n                label: item.label,\n                value: 'kind' in item ? renderMetaItem(item.value, item.kind) : item.value,\n              };\n            })}\n          />\n        )}\n      </>\n    );\n  }\n);\n\nLogsMetaRow.displayName = 'LogsMetaRow';\n\nfunction renderMetaItem(value: any, kind: LogsMetaKind) {\n  if (kind === LogsMetaKind.LabelsMap) {\n    return (\n      <span className=\"logs-meta-item__labels\">\n        <LogLabels labels={value} />\n      </span>\n    );\n  } else if (kind === LogsMetaKind.Error) {\n    return <span className=\"logs-meta-item__error\">{value}</span>;\n  }\n  return value;\n}\n","import React from 'react';\nimport { css, cx } from '@emotion/css';\nimport { dateTimeFormat, systemDateFormats, TimeZone, AbsoluteTimeRange, GrafanaTheme2 } from '@grafana/data';\nimport { CustomScrollbar, Spinner, useTheme2 } from '@grafana/ui';\nimport { LogsPage } from './LogsNavigation';\n\ntype Props = {\n  pages: LogsPage[];\n  currentPageIndex: number;\n  oldestLogsFirst: boolean;\n  timeZone: TimeZone;\n  loading: boolean;\n  changeTime: (range: AbsoluteTimeRange) => void;\n};\n\nexport function LogsNavigationPages({\n  pages,\n  currentPageIndex,\n  oldestLogsFirst,\n  timeZone,\n  loading,\n  changeTime,\n}: Props) {\n  const formatTime = (time: number) => {\n    return `${dateTimeFormat(time, {\n      format: systemDateFormats.interval.second,\n      timeZone: timeZone,\n    })}`;\n  };\n\n  const createPageContent = (page: LogsPage, index: number) => {\n    if (currentPageIndex === index && loading) {\n      return <Spinner />;\n    }\n    const topContent = formatTime(oldestLogsFirst ? page.logsRange.from : page.logsRange.to);\n    const bottomContent = formatTime(oldestLogsFirst ? page.logsRange.to : page.logsRange.from);\n    return `${topContent}  ${bottomContent}`;\n  };\n\n  const theme = useTheme2();\n  const styles = getStyles(theme, loading);\n\n  return (\n    <CustomScrollbar autoHide>\n      <div className={styles.pagesWrapper} data-testid=\"logsNavigationPages\">\n        <div className={styles.pagesContainer}>\n          {pages.map((page: LogsPage, index: number) => (\n            <div\n              data-testid={`page${index + 1}`}\n              className={styles.page}\n              key={page.queryRange.to}\n              onClick={() => !loading && changeTime({ from: page.queryRange.from, to: page.queryRange.to })}\n            >\n              <div className={cx(styles.line, { selectedBg: currentPageIndex === index })} />\n              <div className={cx(styles.time, { selectedText: currentPageIndex === index })}>\n                {createPageContent(page, index)}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </CustomScrollbar>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2, loading: boolean) => {\n  return {\n    pagesWrapper: css`\n      height: 100%;\n      padding-left: ${theme.spacing(0.5)};\n      display: flex;\n      flex-direction: column;\n      overflow-y: scroll;\n      &::after {\n        content: '';\n        display: block;\n        background: repeating-linear-gradient(\n          135deg,\n          ${theme.colors.background.primary},\n          ${theme.colors.background.primary} 5px,\n          ${theme.colors.background.secondary} 5px,\n          ${theme.colors.background.secondary} 15px\n        );\n        width: 3px;\n        height: inherit;\n        margin-bottom: 8px;\n      }\n    `,\n    pagesContainer: css`\n      display: flex;\n      padding: 0;\n      flex-direction: column;\n    `,\n    page: css`\n      display: flex;\n      margin: ${theme.spacing(2)} 0;\n      cursor: ${loading ? 'auto' : 'pointer'};\n      white-space: normal;\n      .selectedBg {\n        background: ${theme.colors.primary.main};\n      }\n      .selectedText {\n        color: ${theme.colors.primary.main};\n      }\n    `,\n    line: css`\n      width: 3px;\n      height: 100%;\n      align-items: center;\n      background: ${theme.colors.text.secondary};\n    `,\n    time: css`\n      width: 60px;\n      min-height: 80px;\n      font-size: ${theme.v1.typography.size.sm};\n      padding-left: ${theme.spacing(0.5)};\n      display: flex;\n      align-items: center;\n    `,\n  };\n};\n","import React, { memo, useState, useEffect, useRef } from 'react';\nimport { isEqual } from 'lodash';\nimport { css } from '@emotion/css';\nimport { LogsSortOrder, AbsoluteTimeRange, TimeZone, DataQuery, GrafanaTheme2 } from '@grafana/data';\nimport { Button, Icon, Spinner, useTheme2 } from '@grafana/ui';\nimport { LogsNavigationPages } from './LogsNavigationPages';\n\ntype Props = {\n  absoluteRange: AbsoluteTimeRange;\n  timeZone: TimeZone;\n  queries: DataQuery[];\n  loading: boolean;\n  visibleRange: AbsoluteTimeRange;\n  logsSortOrder?: LogsSortOrder | null;\n  onChangeTime: (range: AbsoluteTimeRange) => void;\n  scrollToTopLogs: () => void;\n  addResultsToCache: () => void;\n  clearCache: () => void;\n};\n\nexport type LogsPage = {\n  logsRange: AbsoluteTimeRange;\n  queryRange: AbsoluteTimeRange;\n};\n\nfunction LogsNavigation({\n  absoluteRange,\n  logsSortOrder,\n  timeZone,\n  loading,\n  onChangeTime,\n  scrollToTopLogs,\n  visibleRange,\n  queries,\n  clearCache,\n  addResultsToCache,\n}: Props) {\n  const [pages, setPages] = useState<LogsPage[]>([]);\n  const [currentPageIndex, setCurrentPageIndex] = useState(0);\n\n  // These refs are to determine, if we want to clear up logs navigation when totally new query is run\n  const expectedQueriesRef = useRef<DataQuery[]>();\n  const expectedRangeRef = useRef<AbsoluteTimeRange>();\n  // This ref is to store range span for future queres based on firstly selected time range\n  // e.g. if last 5 min selected, always run 5 min range\n  const rangeSpanRef = useRef(0);\n\n  const oldestLogsFirst = logsSortOrder === LogsSortOrder.Ascending;\n  const onFirstPage = oldestLogsFirst ? currentPageIndex === pages.length - 1 : currentPageIndex === 0;\n  const onLastPage = oldestLogsFirst ? currentPageIndex === 0 : currentPageIndex === pages.length - 1;\n  const theme = useTheme2();\n  const styles = getStyles(theme, oldestLogsFirst, loading);\n\n  // Main effect to set pages and index\n  useEffect(() => {\n    const newPage = { logsRange: visibleRange, queryRange: absoluteRange };\n    let newPages: LogsPage[] = [];\n    // We want to start new pagination if queries change or if absolute range is different than expected\n    if (!isEqual(expectedRangeRef.current, absoluteRange) || !isEqual(expectedQueriesRef.current, queries)) {\n      clearCache();\n      setPages([newPage]);\n      setCurrentPageIndex(0);\n      expectedQueriesRef.current = queries;\n      rangeSpanRef.current = absoluteRange.to - absoluteRange.from;\n    } else {\n      setPages((pages) => {\n        // Remove duplicates with new query\n        newPages = pages.filter((page) => !isEqual(newPage.queryRange, page.queryRange));\n        // Sort pages based on logsOrder so they visually align with displayed logs\n        newPages = [...newPages, newPage].sort((a, b) => sortPages(a, b, logsSortOrder));\n        // Set new pages\n\n        return newPages;\n      });\n\n      // Set current page index\n      const index = newPages.findIndex((page) => page.queryRange.to === absoluteRange.to);\n      setCurrentPageIndex(index);\n    }\n    addResultsToCache();\n  }, [visibleRange, absoluteRange, logsSortOrder, queries, clearCache, addResultsToCache]);\n\n  useEffect(() => {\n    return () => clearCache();\n    // We can't enforce the eslint rule here because we only want to run when component unmounts.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const changeTime = ({ from, to }: AbsoluteTimeRange) => {\n    expectedRangeRef.current = { from, to };\n    onChangeTime({ from, to });\n  };\n\n  const sortPages = (a: LogsPage, b: LogsPage, logsSortOrder?: LogsSortOrder | null) => {\n    if (logsSortOrder === LogsSortOrder.Ascending) {\n      return a.queryRange.to > b.queryRange.to ? 1 : -1;\n    }\n    return a.queryRange.to > b.queryRange.to ? -1 : 1;\n  };\n\n  const olderLogsButton = (\n    <Button\n      data-testid=\"olderLogsButton\"\n      className={styles.navButton}\n      variant=\"secondary\"\n      onClick={() => {\n        //If we are not on the last page, use next page's range\n        if (!onLastPage) {\n          const indexChange = oldestLogsFirst ? -1 : 1;\n          changeTime({\n            from: pages[currentPageIndex + indexChange].queryRange.from,\n            to: pages[currentPageIndex + indexChange].queryRange.to,\n          });\n        } else {\n          //If we are on the last page, create new range\n          changeTime({ from: visibleRange.from - rangeSpanRef.current, to: visibleRange.from });\n        }\n      }}\n      disabled={loading}\n    >\n      <div className={styles.navButtonContent}>\n        {loading ? <Spinner /> : <Icon name={oldestLogsFirst ? 'angle-up' : 'angle-down'} size=\"lg\" />}\n        Older logs\n      </div>\n    </Button>\n  );\n\n  const newerLogsButton = (\n    <Button\n      data-testid=\"newerLogsButton\"\n      className={styles.navButton}\n      variant=\"secondary\"\n      onClick={() => {\n        //If we are not on the first page, use previous page's range\n        if (!onFirstPage) {\n          const indexChange = oldestLogsFirst ? 1 : -1;\n          changeTime({\n            from: pages[currentPageIndex + indexChange].queryRange.from,\n            to: pages[currentPageIndex + indexChange].queryRange.to,\n          });\n        }\n        //If we are on the first page, button is disabled and we do nothing\n      }}\n      disabled={loading || onFirstPage}\n    >\n      <div className={styles.navButtonContent}>\n        {loading && <Spinner />}\n        {onFirstPage || loading ? null : <Icon name={oldestLogsFirst ? 'angle-down' : 'angle-up'} size=\"lg\" />}\n        {onFirstPage ? 'Start of range' : 'Newer logs'}\n      </div>\n    </Button>\n  );\n\n  return (\n    <div className={styles.navContainer}>\n      {oldestLogsFirst ? olderLogsButton : newerLogsButton}\n      <LogsNavigationPages\n        pages={pages}\n        currentPageIndex={currentPageIndex}\n        oldestLogsFirst={oldestLogsFirst}\n        timeZone={timeZone}\n        loading={loading}\n        changeTime={changeTime}\n      />\n      {oldestLogsFirst ? newerLogsButton : olderLogsButton}\n      <Button\n        data-testid=\"scrollToTop\"\n        className={styles.scrollToTopButton}\n        variant=\"secondary\"\n        onClick={scrollToTopLogs}\n        title=\"Scroll to top\"\n      >\n        <Icon name=\"arrow-up\" size=\"lg\" />\n      </Button>\n    </div>\n  );\n}\n\nexport default memo(LogsNavigation);\n\nconst getStyles = (theme: GrafanaTheme2, oldestLogsFirst: boolean, loading: boolean) => {\n  return {\n    navContainer: css`\n      max-height: 95vh;\n      display: flex;\n      flex-direction: column;\n      justify-content: ${oldestLogsFirst ? 'flex-start' : 'space-between'};\n      position: sticky;\n      top: ${theme.spacing(2)};\n      right: 0;\n    `,\n    navButton: css`\n      width: 58px;\n      height: 68px;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      line-height: 1;\n    `,\n    navButtonContent: css`\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      width: 100%;\n      height: 100%;\n      white-space: normal;\n    `,\n    scrollToTopButton: css`\n      width: 40px;\n      height: 40px;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      margin-top: ${theme.spacing(1)};\n    `,\n  };\n};\n","import { css, cx } from '@emotion/css';\nimport {\n  AbsoluteTimeRange,\n  applyFieldOverrides,\n  compareArrayValues,\n  compareDataFrameStructures,\n  createFieldConfigRegistry,\n  DataFrame,\n  dateTime,\n  FieldColorModeId,\n  FieldConfigSource,\n  getFrameDisplayName,\n  GrafanaTheme2,\n  LoadingState,\n  SplitOpen,\n  TimeZone,\n} from '@grafana/data';\nimport { PanelRenderer } from '@grafana/runtime';\nimport { GraphDrawStyle, LegendDisplayMode, TooltipDisplayMode } from '@grafana/schema';\nimport {\n  Icon,\n  PanelContext,\n  PanelContextProvider,\n  SeriesVisibilityChangeMode,\n  useStyles2,\n  useTheme2,\n} from '@grafana/ui';\nimport appEvents from 'app/core/app_events';\nimport { ExploreGraphStyle } from 'app/core/utils/explore';\nimport { defaultGraphConfig, getGraphFieldConfig } from 'app/plugins/panel/timeseries/config';\nimport { TimeSeriesOptions } from 'app/plugins/panel/timeseries/types';\nimport { identity } from 'lodash';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { usePrevious } from 'react-use';\nimport { seriesVisibilityConfigFactory } from '../dashboard/dashgrid/SeriesVisibilityConfigFactory';\nimport { applyGraphStyle } from './exploreGraphStyleUtils';\n\nconst MAX_NUMBER_OF_TIME_SERIES = 20;\n\ninterface Props {\n  data: DataFrame[];\n  height: number;\n  width: number;\n  absoluteRange: AbsoluteTimeRange;\n  timeZone: TimeZone;\n  loadingState: LoadingState;\n  annotations?: DataFrame[];\n  onHiddenSeriesChanged?: (hiddenSeries: string[]) => void;\n  tooltipDisplayMode?: TooltipDisplayMode;\n  splitOpenFn?: SplitOpen;\n  onChangeTime: (timeRange: AbsoluteTimeRange) => void;\n  graphStyle: ExploreGraphStyle;\n}\n\nexport function ExploreGraph({\n  data,\n  height,\n  width,\n  timeZone,\n  absoluteRange,\n  onChangeTime,\n  loadingState,\n  annotations,\n  onHiddenSeriesChanged,\n  splitOpenFn,\n  graphStyle,\n  tooltipDisplayMode = TooltipDisplayMode.Single,\n}: Props) {\n  const theme = useTheme2();\n  const [showAllTimeSeries, setShowAllTimeSeries] = useState(false);\n  const [baseStructureRev, setBaseStructureRev] = useState(1);\n\n  const previousData = usePrevious(data);\n  const structureChangesRef = useRef(0);\n\n  if (data && previousData && !compareArrayValues(previousData, data, compareDataFrameStructures)) {\n    structureChangesRef.current++;\n  }\n\n  const structureRev = baseStructureRev + structureChangesRef.current;\n\n  const [fieldConfig, setFieldConfig] = useState<FieldConfigSource>({\n    defaults: {\n      color: {\n        mode: FieldColorModeId.PaletteClassic,\n      },\n      custom: {\n        drawStyle: GraphDrawStyle.Line,\n        fillOpacity: 0,\n        pointSize: 5,\n      },\n    },\n    overrides: [],\n  });\n\n  const style = useStyles2(getStyles);\n  const timeRange = {\n    from: dateTime(absoluteRange.from),\n    to: dateTime(absoluteRange.to),\n    raw: {\n      from: dateTime(absoluteRange.from),\n      to: dateTime(absoluteRange.to),\n    },\n  };\n\n  const dataWithConfig = useMemo(() => {\n    const registry = createFieldConfigRegistry(getGraphFieldConfig(defaultGraphConfig), 'Explore');\n    const styledFieldConfig = applyGraphStyle(fieldConfig, graphStyle);\n    return applyFieldOverrides({\n      fieldConfig: styledFieldConfig,\n      data,\n      timeZone,\n      replaceVariables: (value) => value, // We don't need proper replace here as it is only used in getLinks and we use getFieldLinks\n      theme,\n      fieldConfigRegistry: registry,\n    });\n  }, [fieldConfig, graphStyle, data, timeZone, theme]);\n\n  useEffect(() => {\n    if (onHiddenSeriesChanged) {\n      const hiddenFrames: string[] = [];\n      dataWithConfig.forEach((frame) => {\n        const allFieldsHidden = frame.fields.map((field) => field.config?.custom?.hideFrom?.viz).every(identity);\n        if (allFieldsHidden) {\n          hiddenFrames.push(getFrameDisplayName(frame));\n        }\n      });\n      onHiddenSeriesChanged(hiddenFrames);\n    }\n  }, [dataWithConfig, onHiddenSeriesChanged]);\n\n  const seriesToShow = showAllTimeSeries ? dataWithConfig : dataWithConfig.slice(0, MAX_NUMBER_OF_TIME_SERIES);\n\n  const panelContext: PanelContext = {\n    eventBus: appEvents,\n    onSplitOpen: splitOpenFn,\n    onToggleSeriesVisibility(label: string, mode: SeriesVisibilityChangeMode) {\n      setBaseStructureRev((r) => r + 1);\n      setFieldConfig(seriesVisibilityConfigFactory(label, mode, fieldConfig, data));\n    },\n  };\n\n  return (\n    <PanelContextProvider value={panelContext}>\n      {dataWithConfig.length > MAX_NUMBER_OF_TIME_SERIES && !showAllTimeSeries && (\n        <div className={cx([style.timeSeriesDisclaimer])}>\n          <Icon className={style.disclaimerIcon} name=\"exclamation-triangle\" />\n          {`Showing only ${MAX_NUMBER_OF_TIME_SERIES} time series. `}\n          <span\n            className={cx([style.showAllTimeSeries])}\n            onClick={() => {\n              structureChangesRef.current++;\n              setShowAllTimeSeries(true);\n            }}\n          >{`Show all ${dataWithConfig.length}`}</span>\n        </div>\n      )}\n      <PanelRenderer\n        data={{ series: seriesToShow, timeRange, structureRev, state: loadingState, annotations }}\n        pluginId=\"timeseries\"\n        title=\"\"\n        width={width}\n        height={height}\n        onChangeTimeRange={onChangeTime}\n        timeZone={timeZone}\n        options={\n          {\n            tooltip: { mode: tooltipDisplayMode },\n            legend: { displayMode: LegendDisplayMode.List, placement: 'bottom', calcs: [] },\n          } as TimeSeriesOptions\n        }\n      />\n    </PanelContextProvider>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  timeSeriesDisclaimer: css`\n    label: time-series-disclaimer;\n    width: 300px;\n    margin: ${theme.spacing(1)} auto;\n    padding: 10px 0;\n    border-radius: ${theme.spacing(2)};\n    text-align: center;\n    background-color: ${theme.colors.background.primary};\n  `,\n  disclaimerIcon: css`\n    label: disclaimer-icon;\n    color: ${theme.colors.warning.main};\n    margin-right: ${theme.spacing(0.5)};\n  `,\n  showAllTimeSeries: css`\n    label: show-all-time-series;\n    cursor: pointer;\n    color: ${theme.colors.text.link};\n  `,\n});\n","import produce from 'immer';\nimport { FieldConfigSource } from '@grafana/data';\nimport { GraphDrawStyle, GraphFieldConfig, StackingMode } from '@grafana/schema';\nimport { ExploreGraphStyle } from 'app/core/utils/explore';\n\nexport type FieldConfig = FieldConfigSource<GraphFieldConfig>;\n\nexport function applyGraphStyle(config: FieldConfig, style: ExploreGraphStyle): FieldConfig {\n  return produce(config, (draft) => {\n    if (draft.defaults.custom === undefined) {\n      draft.defaults.custom = {};\n    }\n\n    const { custom } = draft.defaults;\n\n    if (custom.stacking === undefined) {\n      custom.stacking = { group: 'A' };\n    }\n\n    switch (style) {\n      case 'lines':\n        custom.drawStyle = GraphDrawStyle.Line;\n        custom.stacking.mode = StackingMode.None;\n        custom.fillOpacity = 0;\n        break;\n      case 'bars':\n        custom.drawStyle = GraphDrawStyle.Bars;\n        custom.stacking.mode = StackingMode.None;\n        custom.fillOpacity = 100;\n        break;\n      case 'points':\n        custom.drawStyle = GraphDrawStyle.Points;\n        custom.stacking.mode = StackingMode.None;\n        custom.fillOpacity = 0;\n        break;\n      case 'stacked_lines':\n        custom.drawStyle = GraphDrawStyle.Line;\n        custom.stacking.mode = StackingMode.Normal;\n        custom.fillOpacity = 100;\n        break;\n      case 'stacked_bars':\n        custom.drawStyle = GraphDrawStyle.Bars;\n        custom.stacking.mode = StackingMode.Normal;\n        custom.fillOpacity = 100;\n        break;\n      default: {\n        // should never happen\n        // NOTE: casting to `never` will cause typescript\n        // to verify that the switch statement checks every possible\n        // enum-value\n        const invalidValue: never = style;\n        throw new Error(`Invalid graph-style: ${invalidValue}`);\n      }\n    }\n  });\n}\n","import React, { PureComponent, createRef } from 'react';\nimport { css } from '@emotion/css';\nimport { capitalize } from 'lodash';\nimport memoizeOne from 'memoize-one';\nimport { TooltipDisplayMode } from '@grafana/schema';\nimport {\n  rangeUtil,\n  RawTimeRange,\n  LogLevel,\n  TimeZone,\n  AbsoluteTimeRange,\n  LogsDedupStrategy,\n  LogRowModel,\n  LogsDedupDescription,\n  LogsMetaItem,\n  LogsSortOrder,\n  LinkModel,\n  Field,\n  DataQuery,\n  DataFrame,\n  GrafanaTheme2,\n  LoadingState,\n} from '@grafana/data';\nimport {\n  RadioButtonGroup,\n  LogRows,\n  Button,\n  InlineField,\n  InlineFieldRow,\n  InlineSwitch,\n  withTheme2,\n  Themeable2,\n} from '@grafana/ui';\nimport store from 'app/core/store';\nimport { dedupLogRows, filterLogLevels } from 'app/core/logs_model';\nimport { LogsMetaRow } from './LogsMetaRow';\nimport LogsNavigation from './LogsNavigation';\nimport { RowContextOptions } from '@grafana/ui/src/components/Logs/LogRowContextProvider';\nimport { ExploreGraph } from './ExploreGraph';\n\nconst SETTINGS_KEYS = {\n  showLabels: 'grafana.explore.logs.showLabels',\n  showTime: 'grafana.explore.logs.showTime',\n  wrapLogMessage: 'grafana.explore.logs.wrapLogMessage',\n  prettifyLogMessage: 'grafana.explore.logs.prettifyLogMessage',\n};\n\ninterface Props extends Themeable2 {\n  width: number;\n  logRows: LogRowModel[];\n  logsMeta?: LogsMetaItem[];\n  logsSeries?: DataFrame[];\n  logsQueries?: DataQuery[];\n  visibleRange?: AbsoluteTimeRange;\n  theme: GrafanaTheme2;\n  loading: boolean;\n  loadingState: LoadingState;\n  absoluteRange: AbsoluteTimeRange;\n  timeZone: TimeZone;\n  scanning?: boolean;\n  scanRange?: RawTimeRange;\n  showContextToggle?: (row?: LogRowModel) => boolean;\n  onChangeTime: (range: AbsoluteTimeRange) => void;\n  onClickFilterLabel?: (key: string, value: string) => void;\n  onClickFilterOutLabel?: (key: string, value: string) => void;\n  onStartScanning?: () => void;\n  onStopScanning?: () => void;\n  getRowContext?: (row: LogRowModel, options?: RowContextOptions) => Promise<any>;\n  getFieldLinks: (field: Field, rowIndex: number) => Array<LinkModel<Field>>;\n  addResultsToCache: () => void;\n  clearCache: () => void;\n}\n\ninterface State {\n  showLabels: boolean;\n  showTime: boolean;\n  wrapLogMessage: boolean;\n  prettifyLogMessage: boolean;\n  dedupStrategy: LogsDedupStrategy;\n  hiddenLogLevels: LogLevel[];\n  logsSortOrder: LogsSortOrder | null;\n  isFlipping: boolean;\n  showDetectedFields: string[];\n  forceEscape: boolean;\n}\n\nclass UnthemedLogs extends PureComponent<Props, State> {\n  flipOrderTimer?: number;\n  cancelFlippingTimer?: number;\n  topLogsRef = createRef<HTMLDivElement>();\n\n  state: State = {\n    showLabels: store.getBool(SETTINGS_KEYS.showLabels, false),\n    showTime: store.getBool(SETTINGS_KEYS.showTime, true),\n    wrapLogMessage: store.getBool(SETTINGS_KEYS.wrapLogMessage, true),\n    prettifyLogMessage: store.getBool(SETTINGS_KEYS.prettifyLogMessage, false),\n    dedupStrategy: LogsDedupStrategy.none,\n    hiddenLogLevels: [],\n    logsSortOrder: null,\n    isFlipping: false,\n    showDetectedFields: [],\n    forceEscape: false,\n  };\n\n  componentWillUnmount() {\n    if (this.flipOrderTimer) {\n      window.clearTimeout(this.flipOrderTimer);\n    }\n\n    if (this.cancelFlippingTimer) {\n      window.clearTimeout(this.cancelFlippingTimer);\n    }\n  }\n\n  onChangeLogsSortOrder = () => {\n    this.setState({ isFlipping: true });\n    // we are using setTimeout here to make sure that disabled button is rendered before the rendering of reordered logs\n    this.flipOrderTimer = window.setTimeout(() => {\n      this.setState((prevState) => {\n        if (prevState.logsSortOrder === null || prevState.logsSortOrder === LogsSortOrder.Descending) {\n          return { logsSortOrder: LogsSortOrder.Ascending };\n        }\n        return { logsSortOrder: LogsSortOrder.Descending };\n      });\n    }, 0);\n    this.cancelFlippingTimer = window.setTimeout(() => this.setState({ isFlipping: false }), 1000);\n  };\n\n  onEscapeNewlines = () => {\n    this.setState((prevState) => ({\n      forceEscape: !prevState.forceEscape,\n    }));\n  };\n\n  onChangeDedup = (dedupStrategy: LogsDedupStrategy) => {\n    this.setState({ dedupStrategy });\n  };\n\n  onChangeLabels = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { target } = event;\n    if (target) {\n      const showLabels = target.checked;\n      this.setState({\n        showLabels,\n      });\n      store.set(SETTINGS_KEYS.showLabels, showLabels);\n    }\n  };\n\n  onChangeTime = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { target } = event;\n    if (target) {\n      const showTime = target.checked;\n      this.setState({\n        showTime,\n      });\n      store.set(SETTINGS_KEYS.showTime, showTime);\n    }\n  };\n\n  onChangewrapLogMessage = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { target } = event;\n    if (target) {\n      const wrapLogMessage = target.checked;\n      this.setState({\n        wrapLogMessage,\n      });\n      store.set(SETTINGS_KEYS.wrapLogMessage, wrapLogMessage);\n    }\n  };\n\n  onChangePrettifyLogMessage = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { target } = event;\n    if (target) {\n      const prettifyLogMessage = target.checked;\n      this.setState({\n        prettifyLogMessage,\n      });\n      store.set(SETTINGS_KEYS.prettifyLogMessage, prettifyLogMessage);\n    }\n  };\n\n  onToggleLogLevel = (hiddenRawLevels: string[]) => {\n    const hiddenLogLevels = hiddenRawLevels.map((level) => LogLevel[level as LogLevel]);\n    this.setState({ hiddenLogLevels });\n  };\n\n  onClickScan = (event: React.SyntheticEvent) => {\n    event.preventDefault();\n    if (this.props.onStartScanning) {\n      this.props.onStartScanning();\n    }\n  };\n\n  onClickStopScan = (event: React.SyntheticEvent) => {\n    event.preventDefault();\n    if (this.props.onStopScanning) {\n      this.props.onStopScanning();\n    }\n  };\n\n  showDetectedField = (key: string) => {\n    const index = this.state.showDetectedFields.indexOf(key);\n\n    if (index === -1) {\n      this.setState((state) => {\n        return {\n          showDetectedFields: state.showDetectedFields.concat(key),\n        };\n      });\n    }\n  };\n\n  hideDetectedField = (key: string) => {\n    const index = this.state.showDetectedFields.indexOf(key);\n    if (index > -1) {\n      this.setState((state) => {\n        return {\n          showDetectedFields: state.showDetectedFields.filter((k) => key !== k),\n        };\n      });\n    }\n  };\n\n  clearDetectedFields = () => {\n    this.setState((state) => {\n      return {\n        showDetectedFields: [],\n      };\n    });\n  };\n\n  checkUnescapedContent = memoizeOne((logRows: LogRowModel[]) => {\n    return !!logRows.some((r) => r.hasUnescapedContent);\n  });\n\n  dedupRows = memoizeOne((logRows: LogRowModel[], dedupStrategy: LogsDedupStrategy) => {\n    const dedupedRows = dedupLogRows(logRows, dedupStrategy);\n    const dedupCount = dedupedRows.reduce((sum, row) => (row.duplicates ? sum + row.duplicates : sum), 0);\n    return { dedupedRows, dedupCount };\n  });\n\n  filterRows = memoizeOne((logRows: LogRowModel[], hiddenLogLevels: LogLevel[]) => {\n    return filterLogLevels(logRows, new Set(hiddenLogLevels));\n  });\n\n  scrollToTopLogs = () => this.topLogsRef.current?.scrollIntoView();\n\n  render() {\n    const {\n      width,\n      logRows,\n      logsMeta,\n      logsSeries,\n      visibleRange,\n      loading = false,\n      loadingState,\n      onClickFilterLabel,\n      onClickFilterOutLabel,\n      timeZone,\n      scanning,\n      scanRange,\n      showContextToggle,\n      absoluteRange,\n      onChangeTime,\n      getFieldLinks,\n      theme,\n      logsQueries,\n      clearCache,\n      addResultsToCache,\n    } = this.props;\n\n    const {\n      showLabels,\n      showTime,\n      wrapLogMessage,\n      prettifyLogMessage,\n      dedupStrategy,\n      hiddenLogLevels,\n      logsSortOrder,\n      isFlipping,\n      showDetectedFields,\n      forceEscape,\n    } = this.state;\n\n    const styles = getStyles(theme, wrapLogMessage);\n    const hasData = logRows && logRows.length > 0;\n    const hasUnescapedContent = this.checkUnescapedContent(logRows);\n\n    const filteredLogs = this.filterRows(logRows, hiddenLogLevels);\n    const { dedupedRows, dedupCount } = this.dedupRows(filteredLogs, dedupStrategy);\n\n    const scanText = scanRange ? `Scanning ${rangeUtil.describeTimeRange(scanRange)}` : 'Scanning...';\n\n    return (\n      <>\n        {logsSeries && logsSeries.length ? (\n          <>\n            <div className={styles.infoText}>\n              This datasource does not support full-range histograms. The graph is based on the logs seen in the\n              response.\n            </div>\n            <ExploreGraph\n              graphStyle=\"lines\"\n              data={logsSeries}\n              height={150}\n              width={width}\n              tooltipDisplayMode={TooltipDisplayMode.Multi}\n              absoluteRange={visibleRange || absoluteRange}\n              timeZone={timeZone}\n              loadingState={loadingState}\n              onChangeTime={onChangeTime}\n              onHiddenSeriesChanged={this.onToggleLogLevel}\n            />\n          </>\n        ) : undefined}\n        <div className={styles.logOptions} ref={this.topLogsRef}>\n          <InlineFieldRow>\n            <InlineField label=\"Time\" transparent>\n              <InlineSwitch value={showTime} onChange={this.onChangeTime} transparent id=\"show-time\" />\n            </InlineField>\n            <InlineField label=\"Unique labels\" transparent>\n              <InlineSwitch value={showLabels} onChange={this.onChangeLabels} transparent id=\"unique-labels\" />\n            </InlineField>\n            <InlineField label=\"Wrap lines\" transparent>\n              <InlineSwitch value={wrapLogMessage} onChange={this.onChangewrapLogMessage} transparent id=\"wrap-lines\" />\n            </InlineField>\n            <InlineField label=\"Prettify JSON\" transparent>\n              <InlineSwitch\n                value={prettifyLogMessage}\n                onChange={this.onChangePrettifyLogMessage}\n                transparent\n                id=\"prettify\"\n              />\n            </InlineField>\n            <InlineField label=\"Dedup\" transparent>\n              <RadioButtonGroup\n                options={Object.values(LogsDedupStrategy).map((dedupType) => ({\n                  label: capitalize(dedupType),\n                  value: dedupType,\n                  description: LogsDedupDescription[dedupType],\n                }))}\n                value={dedupStrategy}\n                onChange={this.onChangeDedup}\n                className={styles.radioButtons}\n              />\n            </InlineField>\n          </InlineFieldRow>\n          <div>\n            <Button\n              variant=\"secondary\"\n              disabled={isFlipping}\n              title={logsSortOrder === LogsSortOrder.Ascending ? 'Change to newest first' : 'Change to oldest first'}\n              aria-label=\"Flip results order\"\n              className={styles.headerButton}\n              onClick={this.onChangeLogsSortOrder}\n            >\n              {isFlipping ? 'Flipping...' : 'Flip results order'}\n            </Button>\n          </div>\n        </div>\n        <LogsMetaRow\n          logRows={logRows}\n          meta={logsMeta || []}\n          dedupStrategy={dedupStrategy}\n          dedupCount={dedupCount}\n          hasUnescapedContent={hasUnescapedContent}\n          forceEscape={forceEscape}\n          showDetectedFields={showDetectedFields}\n          onEscapeNewlines={this.onEscapeNewlines}\n          clearDetectedFields={this.clearDetectedFields}\n        />\n        <div className={styles.logsSection}>\n          <div className={styles.logRows}>\n            <LogRows\n              logRows={logRows}\n              deduplicatedRows={dedupedRows}\n              dedupStrategy={dedupStrategy}\n              getRowContext={this.props.getRowContext}\n              onClickFilterLabel={onClickFilterLabel}\n              onClickFilterOutLabel={onClickFilterOutLabel}\n              showContextToggle={showContextToggle}\n              showLabels={showLabels}\n              showTime={showTime}\n              enableLogDetails={true}\n              forceEscape={forceEscape}\n              wrapLogMessage={wrapLogMessage}\n              prettifyLogMessage={prettifyLogMessage}\n              timeZone={timeZone}\n              getFieldLinks={getFieldLinks}\n              logsSortOrder={logsSortOrder}\n              showDetectedFields={showDetectedFields}\n              onClickShowDetectedField={this.showDetectedField}\n              onClickHideDetectedField={this.hideDetectedField}\n            />\n          </div>\n          <LogsNavigation\n            logsSortOrder={logsSortOrder}\n            visibleRange={visibleRange ?? absoluteRange}\n            absoluteRange={absoluteRange}\n            timeZone={timeZone}\n            onChangeTime={onChangeTime}\n            loading={loading}\n            queries={logsQueries ?? []}\n            scrollToTopLogs={this.scrollToTopLogs}\n            addResultsToCache={addResultsToCache}\n            clearCache={clearCache}\n          />\n        </div>\n        {!loading && !hasData && !scanning && (\n          <div className={styles.noData}>\n            No logs found.\n            <Button size=\"xs\" fill=\"text\" onClick={this.onClickScan}>\n              Scan for older logs\n            </Button>\n          </div>\n        )}\n\n        {scanning && (\n          <div className={styles.noData}>\n            <span>{scanText}</span>\n            <Button size=\"xs\" fill=\"text\" onClick={this.onClickStopScan}>\n              Stop scan\n            </Button>\n          </div>\n        )}\n      </>\n    );\n  }\n}\n\nexport const Logs = withTheme2(UnthemedLogs);\n\nconst getStyles = (theme: GrafanaTheme2, wrapLogMessage: boolean) => {\n  return {\n    noData: css`\n      > * {\n        margin-left: 0.5em;\n      }\n    `,\n    logOptions: css`\n      display: flex;\n      justify-content: space-between;\n      align-items: baseline;\n      flex-wrap: wrap;\n      background-color: ${theme.colors.background.primary};\n      padding: ${theme.spacing(1, 2)};\n      border-radius: ${theme.shape.borderRadius()};\n      margin: ${theme.spacing(2, 0, 1)};\n      border: 1px solid ${theme.colors.border.medium};\n    `,\n    headerButton: css`\n      margin: ${theme.spacing(0.5, 0, 0, 1)};\n    `,\n    radioButtons: css`\n      margin: 0 ${theme.spacing(1)};\n    `,\n    logsSection: css`\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n    `,\n    logRows: css`\n      overflow-x: ${wrapLogMessage ? 'unset' : 'scroll'};\n      overflow-y: visible;\n      width: 100%;\n    `,\n    infoText: css`\n      font-size: ${theme.typography.size.sm};\n      color: ${theme.colors.text.secondary};\n    `,\n  };\n};\n","import React from 'react';\nimport memoizeOne from 'memoize-one';\nimport { css } from '@emotion/css';\nimport { CSSTransition } from 'react-transition-group';\n\nconst transitionDuration = 500;\n// We add a bit of delay to the transition as another perf optimisation. As at the start we need to render\n// quite a bit of new rows, if we start transition at the same time there can be frame rate drop. This gives time\n// for react to first render them and then do the animation.\nconst transitionDelay = 100;\n\nconst getStyles = memoizeOne(() => {\n  return {\n    logsEnter: css`\n      label: logsEnter;\n      position: absolute;\n      opacity: 0;\n      height: auto;\n      width: 100%;\n    `,\n    logsEnterActive: css`\n      label: logsEnterActive;\n      opacity: 1;\n      transition: opacity ${transitionDuration}ms ease-out ${transitionDelay}ms;\n    `,\n    logsExit: css`\n      label: logsExit;\n      position: absolute;\n      opacity: 1;\n      height: auto;\n      width: 100%;\n    `,\n    logsExitActive: css`\n      label: logsExitActive;\n      opacity: 0;\n      transition: opacity ${transitionDuration}ms ease-out ${transitionDelay}ms;\n    `,\n  };\n});\n\ntype Props = {\n  children: React.ReactNode;\n  visible: boolean;\n};\n\n/**\n * Cross fade transition component that is tied a bit too much to the logs containers so not very useful elsewhere\n * right now.\n */\nexport function LogsCrossFadeTransition(props: Props) {\n  const { visible, children } = props;\n  const styles = getStyles();\n  return (\n    <CSSTransition\n      in={visible}\n      mountOnEnter={true}\n      unmountOnExit={true}\n      timeout={transitionDuration + transitionDelay}\n      classNames={{\n        enter: styles.logsEnter,\n        enterActive: styles.logsEnterActive,\n        exit: styles.logsExit,\n        exitActive: styles.logsExitActive,\n      }}\n    >\n      {children}\n    </CSSTransition>\n  );\n}\n","import React, { useCallback } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { RefreshPicker } from '@grafana/ui';\n\nimport { changeRefreshInterval } from './state/time';\nimport { setPausedStateAction, runQueries } from './state/query';\nimport { ExploreId } from '../../types';\n\n/**\n * Hook that gives you all the functions needed to control the live tailing.\n */\nexport function useLiveTailControls(exploreId: ExploreId) {\n  const dispatch = useDispatch();\n\n  const pause = useCallback(() => {\n    dispatch(setPausedStateAction({ exploreId, isPaused: true }));\n  }, [exploreId, dispatch]);\n\n  const resume = useCallback(() => {\n    dispatch(setPausedStateAction({ exploreId, isPaused: false }));\n  }, [exploreId, dispatch]);\n\n  const stop = useCallback(() => {\n    // We need to pause here first because there is transition where we are not live but live logs are still shown\n    // to cross fade with the normal view. This will prevent reordering of the logs in the live view during the\n    // transition.\n    pause();\n\n    // TODO referencing this from perspective of refresh picker when there is designated button for it now is not\n    //  great. Needs a bit of refactoring.\n    dispatch(changeRefreshInterval(exploreId, RefreshPicker.offOption.value));\n    dispatch(runQueries(exploreId));\n  }, [exploreId, dispatch, pause]);\n\n  const start = useCallback(() => {\n    dispatch(changeRefreshInterval(exploreId, RefreshPicker.liveOption.value));\n  }, [exploreId, dispatch]);\n\n  return {\n    pause,\n    resume,\n    stop,\n    start,\n  };\n}\n\ntype Props = {\n  exploreId: ExploreId;\n  children: (controls: ReturnType<typeof useLiveTailControls>) => React.ReactElement;\n};\n\n/**\n * If you can't use the hook you can use this as a render prop pattern.\n */\nexport function LiveTailControls(props: Props) {\n  const controls = useLiveTailControls(props.exploreId);\n  return props.children(controls);\n}\n","import React, { PureComponent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { css } from '@emotion/css';\nimport { Collapse } from '@grafana/ui';\nimport {\n  AbsoluteTimeRange,\n  Field,\n  hasLogsContextSupport,\n  LoadingState,\n  LogRowModel,\n  RawTimeRange,\n} from '@grafana/data';\nimport { ExploreId, ExploreItemState } from 'app/types/explore';\nimport { StoreState } from 'app/types';\nimport { splitOpen } from './state/main';\nimport { addResultsToCache, clearCache } from './state/query';\nimport { updateTimeRange } from './state/time';\nimport { getTimeZone } from '../profile/state/selectors';\nimport { LiveLogsWithTheme } from './LiveLogs';\nimport { Logs } from './Logs';\nimport { LogsCrossFadeTransition } from './utils/LogsCrossFadeTransition';\nimport { LiveTailControls } from './useLiveTailControls';\nimport { getFieldLinksForExplore } from './utils/links';\n\ninterface LogsContainerProps extends PropsFromRedux {\n  width: number;\n  exploreId: ExploreId;\n  scanRange?: RawTimeRange;\n  syncedTimes: boolean;\n  loadingState: LoadingState;\n  onClickFilterLabel?: (key: string, value: string) => void;\n  onClickFilterOutLabel?: (key: string, value: string) => void;\n  onStartScanning: () => void;\n  onStopScanning: () => void;\n}\n\nclass LogsContainer extends PureComponent<LogsContainerProps> {\n  onChangeTime = (absoluteRange: AbsoluteTimeRange) => {\n    const { exploreId, updateTimeRange } = this.props;\n    updateTimeRange({ exploreId, absoluteRange });\n  };\n\n  getLogRowContext = async (row: LogRowModel, options?: any): Promise<any> => {\n    const { datasourceInstance } = this.props;\n\n    if (hasLogsContextSupport(datasourceInstance)) {\n      return datasourceInstance.getLogRowContext(row, options);\n    }\n\n    return [];\n  };\n\n  showContextToggle = (row?: LogRowModel): boolean => {\n    const { datasourceInstance } = this.props;\n\n    if (hasLogsContextSupport(datasourceInstance)) {\n      return datasourceInstance.showContextToggle(row);\n    }\n\n    return false;\n  };\n\n  getFieldLinks = (field: Field, rowIndex: number) => {\n    const { splitOpen: splitOpenFn, range } = this.props;\n    return getFieldLinksForExplore({ field, rowIndex, splitOpenFn, range });\n  };\n\n  render() {\n    const {\n      loading,\n      loadingState,\n      logRows,\n      logsMeta,\n      logsSeries,\n      logsQueries,\n      onClickFilterLabel,\n      onClickFilterOutLabel,\n      onStartScanning,\n      onStopScanning,\n      absoluteRange,\n      timeZone,\n      visibleRange,\n      scanning,\n      range,\n      width,\n      isLive,\n      exploreId,\n      addResultsToCache,\n      clearCache,\n    } = this.props;\n\n    if (!logRows) {\n      return null;\n    }\n\n    // We need to override css overflow of divs in Collapse element to enable sticky Logs navigation\n    const styleOverridesForStickyNavigation = css`\n      & > div {\n        overflow: visible;\n        & > div {\n          overflow: visible;\n        }\n      }\n    `;\n\n    return (\n      <>\n        <LogsCrossFadeTransition visible={isLive}>\n          <Collapse label=\"Logs\" loading={false} isOpen>\n            <LiveTailControls exploreId={exploreId}>\n              {(controls) => (\n                <LiveLogsWithTheme\n                  logRows={logRows}\n                  timeZone={timeZone}\n                  stopLive={controls.stop}\n                  isPaused={this.props.isPaused}\n                  onPause={controls.pause}\n                  onResume={controls.resume}\n                />\n              )}\n            </LiveTailControls>\n          </Collapse>\n        </LogsCrossFadeTransition>\n        <LogsCrossFadeTransition visible={!isLive}>\n          <Collapse label=\"Logs\" loading={loading} isOpen className={styleOverridesForStickyNavigation}>\n            <Logs\n              logRows={logRows}\n              logsMeta={logsMeta}\n              logsSeries={logsSeries}\n              logsQueries={logsQueries}\n              width={width}\n              loading={loading}\n              loadingState={loadingState}\n              onChangeTime={this.onChangeTime}\n              onClickFilterLabel={onClickFilterLabel}\n              onClickFilterOutLabel={onClickFilterOutLabel}\n              onStartScanning={onStartScanning}\n              onStopScanning={onStopScanning}\n              absoluteRange={absoluteRange}\n              visibleRange={visibleRange}\n              timeZone={timeZone}\n              scanning={scanning}\n              scanRange={range.raw}\n              showContextToggle={this.showContextToggle}\n              getRowContext={this.getLogRowContext}\n              getFieldLinks={this.getFieldLinks}\n              addResultsToCache={() => addResultsToCache(exploreId)}\n              clearCache={() => clearCache(exploreId)}\n            />\n          </Collapse>\n        </LogsCrossFadeTransition>\n      </>\n    );\n  }\n}\n\nfunction mapStateToProps(state: StoreState, { exploreId }: { exploreId: string }) {\n  const explore = state.explore;\n  // @ts-ignore\n  const item: ExploreItemState = explore[exploreId];\n  const {\n    logsResult,\n    loading,\n    scanning,\n    datasourceInstance,\n    isLive,\n    isPaused,\n    range,\n    absoluteRange,\n    logsVolumeDataProvider,\n    logsVolumeData,\n  } = item;\n  const timeZone = getTimeZone(state.user);\n\n  return {\n    loading,\n    logRows: logsResult?.rows,\n    logsMeta: logsResult?.meta,\n    logsSeries: logsResult?.series,\n    logsQueries: logsResult?.queries,\n    visibleRange: logsResult?.visibleRange,\n    scanning,\n    timeZone,\n    datasourceInstance,\n    isLive,\n    isPaused,\n    range,\n    absoluteRange,\n    logsVolumeDataProvider,\n    logsVolumeData,\n  };\n}\n\nconst mapDispatchToProps = {\n  updateTimeRange,\n  splitOpen,\n  addResultsToCache,\n  clearCache,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nexport default connector(LogsContainer);\n","import { ExploreId, StoreState } from 'app/types';\n\nexport const isSplit = (state: StoreState) => Boolean(state.explore[ExploreId.left] && state.explore[ExploreId.right]);\n\nexport const getExploreItemSelector = (exploreId: ExploreId) => (state: StoreState) => state.explore[exploreId];\n","import React, { useCallback, useMemo } from 'react';\nimport { ExploreId } from 'app/types/explore';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getDatasourceSrv } from '../plugins/datasource_srv';\nimport { runQueries, changeQueriesAction } from './state/query';\nimport { CoreApp, DataQuery } from '@grafana/data';\nimport { getNextRefIdChar } from 'app/core/utils/query';\nimport { QueryEditorRows } from '../query/components/QueryEditorRows';\nimport { createSelector } from '@reduxjs/toolkit';\nimport { getExploreItemSelector } from './state/selectors';\n\ninterface Props {\n  exploreId: ExploreId;\n}\n\nconst makeSelectors = (exploreId: ExploreId) => {\n  const exploreItemSelector = getExploreItemSelector(exploreId);\n  return {\n    getQueries: createSelector(exploreItemSelector, (s) => s!.queries),\n    getQueryResponse: createSelector(exploreItemSelector, (s) => s!.queryResponse),\n    getHistory: createSelector(exploreItemSelector, (s) => s!.history),\n    getEventBridge: createSelector(exploreItemSelector, (s) => s!.eventBridge),\n    getDatasourceInstanceSettings: createSelector(\n      exploreItemSelector,\n      (s) => getDatasourceSrv().getInstanceSettings(s!.datasourceInstance?.uid)!\n    ),\n  };\n};\n\nexport const QueryRows = ({ exploreId }: Props) => {\n  const dispatch = useDispatch();\n  const { getQueries, getDatasourceInstanceSettings, getQueryResponse, getHistory, getEventBridge } = useMemo(\n    () => makeSelectors(exploreId),\n    [exploreId]\n  );\n\n  const queries = useSelector(getQueries)!;\n  const dsSettings = useSelector(getDatasourceInstanceSettings)!;\n  const queryResponse = useSelector(getQueryResponse)!;\n  const history = useSelector(getHistory);\n  const eventBridge = useSelector(getEventBridge);\n\n  const onRunQueries = useCallback(() => {\n    dispatch(runQueries(exploreId));\n  }, [dispatch, exploreId]);\n\n  const onChange = useCallback(\n    (newQueries: DataQuery[]) => {\n      dispatch(changeQueriesAction({ queries: newQueries, exploreId }));\n\n      // if we are removing a query we want to run the remaining ones\n      if (newQueries.length < queries.length) {\n        onRunQueries();\n      }\n    },\n    [dispatch, exploreId, onRunQueries, queries]\n  );\n\n  const onAddQuery = useCallback(\n    (query: DataQuery) => {\n      onChange([...queries, { ...query, refId: getNextRefIdChar(queries) }]);\n    },\n    [onChange, queries]\n  );\n\n  return (\n    <QueryEditorRows\n      dsSettings={dsSettings}\n      queries={queries}\n      onQueriesChange={onChange}\n      onAddQuery={onAddQuery}\n      onRunQueries={onRunQueries}\n      data={queryResponse}\n      app={CoreApp.Explore}\n      history={history}\n      eventBus={eventBridge}\n    />\n  );\n};\n","import React, { PureComponent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { ValueLinkConfig, applyFieldOverrides, TimeZone } from '@grafana/data';\nimport { Collapse, Table } from '@grafana/ui';\nimport { ExploreId, ExploreItemState } from 'app/types/explore';\nimport { StoreState } from 'app/types';\nimport { splitOpen } from './state/main';\nimport { config } from 'app/core/config';\nimport { PANEL_BORDER } from 'app/core/constants';\nimport { MetaInfoText } from './MetaInfoText';\nimport { FilterItem } from '@grafana/ui/src/components/Table/types';\nimport { getFieldLinksForExplore } from './utils/links';\n\ninterface TableContainerProps {\n  ariaLabel?: string;\n  exploreId: ExploreId;\n  width: number;\n  timeZone: TimeZone;\n  onCellFilterAdded?: (filter: FilterItem) => void;\n}\n\nfunction mapStateToProps(state: StoreState, { exploreId }: TableContainerProps) {\n  const explore = state.explore;\n  // @ts-ignore\n  const item: ExploreItemState = explore[exploreId];\n  const { loading: loadingInState, tableResult, range } = item;\n  const loading = tableResult && tableResult.length > 0 ? false : loadingInState;\n  return { loading, tableResult, range };\n}\n\nconst mapDispatchToProps = {\n  splitOpen,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype Props = TableContainerProps & ConnectedProps<typeof connector>;\n\nexport class TableContainer extends PureComponent<Props> {\n  getTableHeight() {\n    const { tableResult } = this.props;\n\n    if (!tableResult || tableResult.length === 0) {\n      return 200;\n    }\n\n    // tries to estimate table height\n    return Math.max(Math.min(600, tableResult.length * 35) + 35);\n  }\n\n  render() {\n    const { loading, onCellFilterAdded, tableResult, width, splitOpen, range, ariaLabel, timeZone } = this.props;\n    const height = this.getTableHeight();\n    const tableWidth = width - config.theme.panelPadding * 2 - PANEL_BORDER;\n\n    let dataFrame = tableResult;\n\n    if (dataFrame?.length) {\n      dataFrame = applyFieldOverrides({\n        data: [dataFrame],\n        timeZone,\n        theme: config.theme2,\n        replaceVariables: (v: string) => v,\n        fieldConfig: {\n          defaults: {},\n          overrides: [],\n        },\n      })[0];\n      // Bit of code smell here. We need to add links here to the frame modifying the frame on every render.\n      // Should work fine in essence but still not the ideal way to pass props. In logs container we do this\n      // differently and sidestep this getLinks API on a dataframe\n      for (const field of dataFrame.fields) {\n        field.getLinks = (config: ValueLinkConfig) => {\n          return getFieldLinksForExplore({ field, rowIndex: config.valueRowIndex!, splitOpenFn: splitOpen, range });\n        };\n      }\n    }\n\n    return (\n      <Collapse label=\"Table\" loading={loading} isOpen>\n        {dataFrame?.length ? (\n          <Table\n            ariaLabel={ariaLabel}\n            data={dataFrame}\n            width={tableWidth}\n            height={height}\n            onCellFilterAdded={onCellFilterAdded}\n          />\n        ) : (\n          <MetaInfoText metaItems={[{ value: '0 series returned' }]} />\n        )}\n      </Collapse>\n    );\n  }\n}\n\nexport default connector(TableContainer);\n","import React from 'react';\nimport { css } from '@emotion/css';\nimport { stylesFactory, useTheme, Select, Button, Switch, Field } from '@grafana/ui';\nimport { GrafanaTheme, SelectableValue } from '@grafana/data';\nimport appEvents from 'app/core/app_events';\nimport { ShowConfirmModalEvent } from '../../../types/events';\nimport { dispatch } from 'app/store/store';\nimport { notifyApp } from 'app/core/actions';\nimport { createSuccessNotification } from 'app/core/copy/appNotification';\nimport { MAX_HISTORY_ITEMS } from '../../../core/utils/richHistory';\n\nexport interface RichHistorySettingsProps {\n  retentionPeriod: number;\n  starredTabAsFirstTab: boolean;\n  activeDatasourceOnly: boolean;\n  onChangeRetentionPeriod: (option: SelectableValue<number>) => void;\n  toggleStarredTabAsFirstTab: () => void;\n  toggleactiveDatasourceOnly: () => void;\n  deleteRichHistory: () => void;\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme) => {\n  return {\n    container: css`\n      font-size: ${theme.typography.size.sm};\n      .space-between {\n        margin-bottom: ${theme.spacing.lg};\n      }\n    `,\n    input: css`\n      max-width: 200px;\n    `,\n    switch: css`\n      display: flex;\n      align-items: center;\n    `,\n    label: css`\n      margin-left: ${theme.spacing.md};\n    `,\n  };\n});\n\nconst retentionPeriodOptions = [\n  { value: 2, label: '2 days' },\n  { value: 5, label: '5 days' },\n  { value: 7, label: '1 week' },\n  { value: 14, label: '2 weeks' },\n];\n\nexport function RichHistorySettings(props: RichHistorySettingsProps) {\n  const {\n    retentionPeriod,\n    starredTabAsFirstTab,\n    activeDatasourceOnly,\n    onChangeRetentionPeriod,\n    toggleStarredTabAsFirstTab,\n    toggleactiveDatasourceOnly,\n    deleteRichHistory,\n  } = props;\n  const theme = useTheme();\n  const styles = getStyles(theme);\n  const selectedOption = retentionPeriodOptions.find((v) => v.value === retentionPeriod);\n\n  const onDelete = () => {\n    appEvents.publish(\n      new ShowConfirmModalEvent({\n        title: 'Delete',\n        text: 'Are you sure you want to permanently delete your query history?',\n        yesText: 'Delete',\n        icon: 'trash-alt',\n        onConfirm: () => {\n          deleteRichHistory();\n          dispatch(notifyApp(createSuccessNotification('Query history deleted')));\n        },\n      })\n    );\n  };\n\n  return (\n    <div className={styles.container}>\n      <Field\n        label=\"History time span\"\n        description={`Select the period of time for which Grafana will save your query history. Up to ${MAX_HISTORY_ITEMS} entries will be stored.`}\n        className=\"space-between\"\n      >\n        <div className={styles.input}>\n          <Select\n            menuShouldPortal\n            value={selectedOption}\n            options={retentionPeriodOptions}\n            onChange={onChangeRetentionPeriod}\n          ></Select>\n        </div>\n      </Field>\n      <Field label=\"Default active tab\" description=\" \" className=\"space-between\">\n        <div className={styles.switch}>\n          <Switch value={starredTabAsFirstTab} onChange={toggleStarredTabAsFirstTab}></Switch>\n          <div className={styles.label}>Change the default active tab from Query history to Starred</div>\n        </div>\n      </Field>\n      <Field label=\"Data source behaviour\" description=\" \" className=\"space-between\">\n        <div className={styles.switch}>\n          <Switch value={activeDatasourceOnly} onChange={toggleactiveDatasourceOnly}></Switch>\n          <div className={styles.label}>Only show queries for data source currently active in Explore</div>\n        </div>\n      </Field>\n      <div\n        className={css`\n          font-weight: ${theme.typography.weight.bold};\n        `}\n      >\n        Clear query history\n      </div>\n      <div\n        className={css`\n          margin-bottom: ${theme.spacing.sm};\n        `}\n      >\n        Delete all of your query history, permanently.\n      </div>\n      <Button variant=\"destructive\" onClick={onDelete}>\n        Clear query history\n      </Button>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { css, cx } from '@emotion/css';\nimport { stylesFactory, useTheme, TextArea, Button, IconButton } from '@grafana/ui';\nimport { getDataSourceSrv } from '@grafana/runtime';\nimport { GrafanaTheme, DataSourceApi } from '@grafana/data';\nimport { RichHistoryQuery, ExploreId } from 'app/types/explore';\nimport { createUrlFromRichHistory, createQueryText } from 'app/core/utils/richHistory';\nimport { createAndCopyShortLink } from 'app/core/utils/shortLinks';\nimport { copyStringToClipboard } from 'app/core/utils/explore';\nimport appEvents from 'app/core/app_events';\nimport { dispatch } from 'app/store/store';\nimport { notifyApp } from 'app/core/actions';\nimport { createSuccessNotification } from 'app/core/copy/appNotification';\nimport { StoreState } from 'app/types';\n\nimport { updateRichHistory } from '../state/history';\nimport { changeDatasource } from '../state/datasource';\nimport { setQueries } from '../state/query';\nimport { ShowConfirmModalEvent } from '../../../types/events';\n\nfunction mapStateToProps(state: StoreState, { exploreId }: { exploreId: ExploreId }) {\n  const explore = state.explore;\n  const { datasourceInstance } = explore[exploreId]!;\n  return {\n    exploreId,\n    datasourceInstance,\n  };\n}\n\nconst mapDispatchToProps = {\n  changeDatasource,\n  updateRichHistory,\n  setQueries,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ninterface OwnProps {\n  query: RichHistoryQuery;\n  dsImg: string;\n  isRemoved: boolean;\n}\n\nexport type Props = ConnectedProps<typeof connector> & OwnProps;\n\nconst getStyles = stylesFactory((theme: GrafanaTheme, isRemoved: boolean) => {\n  /* Hard-coded value so all buttons and icons on right side of card are aligned */\n  const rigtColumnWidth = '240px';\n  const rigtColumnContentWidth = '170px';\n\n  /* If datasource was removed, card will have inactive color */\n  const cardColor = theme.colors.bg2;\n\n  return {\n    queryCard: css`\n      display: flex;\n      flex-direction: column;\n      border: 1px solid ${theme.colors.border1};\n      margin: ${theme.spacing.sm} 0;\n      background-color: ${cardColor};\n      border-radius: ${theme.border.radius.sm};\n      .starred {\n        color: ${theme.palette.orange};\n      }\n    `,\n    cardRow: css`\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: ${theme.spacing.sm};\n      border-bottom: none;\n      :first-of-type {\n        border-bottom: 1px solid ${theme.colors.border1};\n        padding: ${theme.spacing.xs} ${theme.spacing.sm};\n      }\n      img {\n        height: ${theme.typography.size.base};\n        max-width: ${theme.typography.size.base};\n        margin-right: ${theme.spacing.sm};\n      }\n    `,\n    datasourceContainer: css`\n      display: flex;\n      align-items: center;\n      font-size: ${theme.typography.size.sm};\n      font-weight: ${theme.typography.weight.semibold};\n    `,\n    queryActionButtons: css`\n      max-width: ${rigtColumnContentWidth};\n      display: flex;\n      justify-content: flex-end;\n      font-size: ${theme.typography.size.base};\n      button {\n        margin-left: ${theme.spacing.sm};\n      }\n    `,\n    queryContainer: css`\n      font-weight: ${theme.typography.weight.semibold};\n      width: calc(100% - ${rigtColumnWidth});\n    `,\n    queryRow: css`\n      border-top: 1px solid ${theme.colors.border1};\n      word-break: break-all;\n      padding: 4px 2px;\n      :first-child {\n        border-top: none;\n        padding: 0 0 4px 0;\n      }\n    `,\n    updateCommentContainer: css`\n      width: calc(100% + ${rigtColumnWidth});\n      margin-top: ${theme.spacing.sm};\n    `,\n    comment: css`\n      overflow-wrap: break-word;\n      font-size: ${theme.typography.size.sm};\n      font-weight: ${theme.typography.weight.regular};\n      margin-top: ${theme.spacing.xs};\n    `,\n    commentButtonRow: css`\n      > * {\n        margin-right: ${theme.spacing.sm};\n      }\n    `,\n    textArea: css`\n      width: 100%;\n    `,\n    runButton: css`\n      max-width: ${rigtColumnContentWidth};\n      display: flex;\n      justify-content: flex-end;\n      button {\n        height: auto;\n        padding: ${theme.spacing.xs} ${theme.spacing.md};\n        line-height: 1.4;\n        span {\n          white-space: normal !important;\n        }\n      }\n    `,\n  };\n});\n\nexport function RichHistoryCard(props: Props) {\n  const {\n    query,\n    dsImg,\n    isRemoved,\n    updateRichHistory,\n    changeDatasource,\n    exploreId,\n    datasourceInstance,\n    setQueries,\n  } = props;\n  const [activeUpdateComment, setActiveUpdateComment] = useState(false);\n  const [comment, setComment] = useState<string | undefined>(query.comment);\n  const [queryDsInstance, setQueryDsInstance] = useState<DataSourceApi | undefined>(undefined);\n\n  useEffect(() => {\n    const getQueryDsInstance = async () => {\n      const ds = await getDataSourceSrv().get(query.datasourceName);\n      setQueryDsInstance(ds);\n    };\n\n    getQueryDsInstance();\n  }, [query.datasourceName]);\n\n  const theme = useTheme();\n  const styles = getStyles(theme, isRemoved);\n\n  const onRunQuery = async () => {\n    const queriesToRun = query.queries;\n    if (query.datasourceName !== datasourceInstance?.name) {\n      await changeDatasource(exploreId, query.datasourceName, { importQueries: true });\n      setQueries(exploreId, queriesToRun);\n    } else {\n      setQueries(exploreId, queriesToRun);\n    }\n  };\n\n  const onCopyQuery = () => {\n    const queriesToCopy = query.queries.map((q) => createQueryText(q, queryDsInstance)).join('\\n');\n    copyStringToClipboard(queriesToCopy);\n    dispatch(notifyApp(createSuccessNotification('Query copied to clipboard')));\n  };\n\n  const onCreateShortLink = async () => {\n    const link = createUrlFromRichHistory(query);\n    await createAndCopyShortLink(link);\n  };\n\n  const onDeleteQuery = () => {\n    // For starred queries, we want confirmation. For non-starred, we don't.\n    if (query.starred) {\n      appEvents.publish(\n        new ShowConfirmModalEvent({\n          title: 'Delete',\n          text: 'Are you sure you want to permanently delete your starred query?',\n          yesText: 'Delete',\n          icon: 'trash-alt',\n          onConfirm: () => {\n            updateRichHistory(query.ts, 'delete');\n            dispatch(notifyApp(createSuccessNotification('Query deleted')));\n          },\n        })\n      );\n    } else {\n      updateRichHistory(query.ts, 'delete');\n      dispatch(notifyApp(createSuccessNotification('Query deleted')));\n    }\n  };\n\n  const onStarrQuery = () => {\n    updateRichHistory(query.ts, 'starred');\n  };\n\n  const toggleActiveUpdateComment = () => setActiveUpdateComment(!activeUpdateComment);\n\n  const onUpdateComment = () => {\n    updateRichHistory(query.ts, 'comment', comment);\n    setActiveUpdateComment(false);\n  };\n\n  const onCancelUpdateComment = () => {\n    setActiveUpdateComment(false);\n    setComment(query.comment);\n  };\n\n  const onKeyDown = (keyEvent: React.KeyboardEvent) => {\n    if (keyEvent.key === 'Enter' && (keyEvent.shiftKey || keyEvent.ctrlKey)) {\n      onUpdateComment();\n    }\n\n    if (keyEvent.key === 'Escape') {\n      onCancelUpdateComment();\n    }\n  };\n\n  const updateComment = (\n    <div className={styles.updateCommentContainer} aria-label={comment ? 'Update comment form' : 'Add comment form'}>\n      <TextArea\n        value={comment}\n        placeholder={comment ? undefined : 'An optional description of what the query does.'}\n        onChange={(e) => setComment(e.currentTarget.value)}\n        className={styles.textArea}\n      />\n      <div className={styles.commentButtonRow}>\n        <Button onClick={onUpdateComment} aria-label=\"Submit button\">\n          Save comment\n        </Button>\n        <Button variant=\"secondary\" onClick={onCancelUpdateComment}>\n          Cancel\n        </Button>\n      </div>\n    </div>\n  );\n\n  const queryActionButtons = (\n    <div className={styles.queryActionButtons}>\n      <IconButton\n        name=\"comment-alt\"\n        onClick={toggleActiveUpdateComment}\n        title={query.comment?.length > 0 ? 'Edit comment' : 'Add comment'}\n      />\n      <IconButton name=\"copy\" onClick={onCopyQuery} title=\"Copy query to clipboard\" />\n      {!isRemoved && (\n        <IconButton name=\"share-alt\" onClick={onCreateShortLink} title=\"Copy shortened link to clipboard\" />\n      )}\n      <IconButton name=\"trash-alt\" title={'Delete query'} onClick={onDeleteQuery} />\n      <IconButton\n        name={query.starred ? 'favorite' : 'star'}\n        iconType={query.starred ? 'mono' : 'default'}\n        onClick={onStarrQuery}\n        title={query.starred ? 'Unstar query' : 'Star query'}\n      />\n    </div>\n  );\n\n  return (\n    <div className={styles.queryCard} onKeyDown={onKeyDown}>\n      <div className={styles.cardRow}>\n        <div className={styles.datasourceContainer}>\n          <img src={dsImg} aria-label=\"Data source icon\" />\n          <div aria-label=\"Data source name\">\n            {isRemoved ? 'Data source does not exist anymore' : query.datasourceName}\n          </div>\n        </div>\n        {queryActionButtons}\n      </div>\n      <div className={cx(styles.cardRow)}>\n        <div className={styles.queryContainer}>\n          {query.queries.map((q, i) => {\n            const queryText = createQueryText(q, queryDsInstance);\n            return (\n              <div aria-label=\"Query text\" key={`${q}-${i}`} className={styles.queryRow}>\n                {queryText}\n              </div>\n            );\n          })}\n          {!activeUpdateComment && query.comment && (\n            <div aria-label=\"Query comment\" className={styles.comment}>\n              {query.comment}\n            </div>\n          )}\n          {activeUpdateComment && updateComment}\n        </div>\n        {!activeUpdateComment && (\n          <div className={styles.runButton}>\n            <Button variant=\"secondary\" onClick={onRunQuery} disabled={isRemoved}>\n              {datasourceInstance?.name === query.datasourceName ? 'Run query' : 'Switch data source and run query'}\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default connector(RichHistoryCard);\n","import React, { useState, useEffect } from 'react';\nimport { css } from '@emotion/css';\nimport { uniqBy } from 'lodash';\n\n// Types\nimport { RichHistoryQuery, ExploreId } from 'app/types/explore';\n\n// Utils\nimport { stylesFactory, useTheme, RangeSlider, MultiSelect, Select, FilterInput } from '@grafana/ui';\nimport { GrafanaTheme, SelectableValue } from '@grafana/data';\n\nimport {\n  SortOrder,\n  mapNumbertoTimeInSlider,\n  mapQueriesToHeadings,\n  createDatasourcesList,\n  filterAndSortQueries,\n} from 'app/core/utils/richHistory';\n\n// Components\nimport RichHistoryCard from './RichHistoryCard';\nimport { sortOrderOptions } from './RichHistory';\nimport { useDebounce } from 'react-use';\n\nexport interface Props {\n  queries: RichHistoryQuery[];\n  sortOrder: SortOrder;\n  activeDatasourceOnly: boolean;\n  datasourceFilters: SelectableValue[];\n  retentionPeriod: number;\n  exploreId: ExploreId;\n  height: number;\n  onChangeSortOrder: (sortOrder: SortOrder) => void;\n  onSelectDatasourceFilters: (value: SelectableValue[]) => void;\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme, height: number) => {\n  const bgColor = theme.isLight ? theme.palette.gray5 : theme.palette.dark4;\n\n  /* 134px is based on the width of the Query history tabs bar, so the content is aligned to right side of the tab */\n  const cardWidth = '100% - 134px';\n  const sliderHeight = `${height - 180}px`;\n  return {\n    container: css`\n      display: flex;\n      .label-slider {\n        font-size: ${theme.typography.size.sm};\n        &:last-of-type {\n          margin-top: ${theme.spacing.lg};\n        }\n        &:first-of-type {\n          font-weight: ${theme.typography.weight.semibold};\n          margin-bottom: ${theme.spacing.md};\n        }\n      }\n    `,\n    containerContent: css`\n      width: calc(${cardWidth});\n    `,\n    containerSlider: css`\n      width: 129px;\n      margin-right: ${theme.spacing.sm};\n      .slider {\n        bottom: 10px;\n        height: ${sliderHeight};\n        width: 129px;\n        padding: ${theme.spacing.sm} 0;\n      }\n    `,\n    slider: css`\n      position: fixed;\n    `,\n    selectors: css`\n      display: flex;\n      justify-content: space-between;\n      flex-wrap: wrap;\n    `,\n    filterInput: css`\n      margin-bottom: ${theme.spacing.sm};\n    `,\n    multiselect: css`\n      width: 100%;\n      margin-bottom: ${theme.spacing.sm};\n      .gf-form-select-box__multi-value {\n        background-color: ${bgColor};\n        padding: ${theme.spacing.xxs} ${theme.spacing.xs} ${theme.spacing.xxs} ${theme.spacing.sm};\n        border-radius: ${theme.border.radius.sm};\n      }\n    `,\n    sort: css`\n      width: 170px;\n    `,\n    sessionName: css`\n      display: flex;\n      align-items: flex-start;\n      justify-content: flex-start;\n      margin-top: ${theme.spacing.lg};\n      h4 {\n        margin: 0 10px 0 0;\n      }\n    `,\n    heading: css`\n      font-size: ${theme.typography.heading.h4};\n      margin: ${theme.spacing.md} ${theme.spacing.xxs} ${theme.spacing.sm} ${theme.spacing.xxs};\n    `,\n    footer: css`\n      height: 60px;\n      margin: ${theme.spacing.lg} auto;\n      display: flex;\n      justify-content: center;\n      font-weight: ${theme.typography.weight.light};\n      font-size: ${theme.typography.size.sm};\n      a {\n        font-weight: ${theme.typography.weight.semibold};\n        margin-left: ${theme.spacing.xxs};\n      }\n    `,\n    queries: css`\n      font-size: ${theme.typography.size.sm};\n      font-weight: ${theme.typography.weight.regular};\n      margin-left: ${theme.spacing.xs};\n    `,\n  };\n});\n\nexport function RichHistoryQueriesTab(props: Props) {\n  const {\n    datasourceFilters,\n    onSelectDatasourceFilters,\n    queries,\n    onChangeSortOrder,\n    sortOrder,\n    activeDatasourceOnly,\n    retentionPeriod,\n    exploreId,\n    height,\n  } = props;\n\n  const [timeFilter, setTimeFilter] = useState<[number, number]>([0, retentionPeriod]);\n  const [data, setData] = useState<[RichHistoryQuery[], ReturnType<typeof createDatasourcesList>]>([[], []]);\n  const [searchInput, setSearchInput] = useState('');\n  const [debouncedSearchInput, setDebouncedSearchInput] = useState('');\n\n  const theme = useTheme();\n  const styles = getStyles(theme, height);\n\n  useDebounce(\n    () => {\n      setDebouncedSearchInput(searchInput);\n    },\n    300,\n    [searchInput]\n  );\n\n  useEffect(() => {\n    const datasourcesRetrievedFromQueryHistory = uniqBy(queries, 'datasourceName').map((d) => d.datasourceName);\n    const listOfDatasources = createDatasourcesList(datasourcesRetrievedFromQueryHistory);\n\n    setData([\n      filterAndSortQueries(\n        queries,\n        sortOrder,\n        datasourceFilters.map((d) => d.value),\n        debouncedSearchInput,\n        timeFilter\n      ),\n      listOfDatasources,\n    ]);\n  }, [timeFilter, queries, sortOrder, datasourceFilters, debouncedSearchInput]);\n\n  const [filteredQueries, listOfDatasources] = data;\n\n  /* mappedQueriesToHeadings is an object where query headings (stringified dates/data sources)\n   * are keys and arrays with queries that belong to that headings are values.\n   */\n  const mappedQueriesToHeadings = mapQueriesToHeadings(filteredQueries, sortOrder);\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.containerSlider}>\n        <div className={styles.slider}>\n          <div className=\"label-slider\">Filter history</div>\n          <div className=\"label-slider\">{mapNumbertoTimeInSlider(timeFilter[0])}</div>\n          <div className=\"slider\">\n            <RangeSlider\n              tooltipAlwaysVisible={false}\n              min={0}\n              max={retentionPeriod}\n              value={timeFilter}\n              orientation=\"vertical\"\n              formatTooltipResult={mapNumbertoTimeInSlider}\n              reverse={true}\n              onAfterChange={setTimeFilter as () => number[]}\n            />\n          </div>\n          <div className=\"label-slider\">{mapNumbertoTimeInSlider(timeFilter[1])}</div>\n        </div>\n      </div>\n\n      <div className={styles.containerContent}>\n        <div className={styles.selectors}>\n          {!activeDatasourceOnly && (\n            <div aria-label=\"Filter datasources\" className={styles.multiselect}>\n              <MultiSelect\n                menuShouldPortal\n                options={listOfDatasources}\n                value={datasourceFilters}\n                placeholder=\"Filter queries for data sources(s)\"\n                onChange={onSelectDatasourceFilters}\n              />\n            </div>\n          )}\n          <div className={styles.filterInput}>\n            <FilterInput\n              placeholder=\"Search queries\"\n              value={searchInput}\n              onChange={(value: string) => {\n                setSearchInput(value);\n              }}\n            />\n          </div>\n          <div aria-label=\"Sort queries\" className={styles.sort}>\n            <Select\n              menuShouldPortal\n              value={sortOrderOptions.filter((order) => order.value === sortOrder)}\n              options={sortOrderOptions}\n              placeholder=\"Sort queries by\"\n              onChange={(e) => onChangeSortOrder(e.value as SortOrder)}\n            />\n          </div>\n        </div>\n        {Object.keys(mappedQueriesToHeadings).map((heading) => {\n          return (\n            <div key={heading}>\n              <div className={styles.heading}>\n                {heading} <span className={styles.queries}>{mappedQueriesToHeadings[heading].length} queries</span>\n              </div>\n              {mappedQueriesToHeadings[heading].map((q: RichHistoryQuery) => {\n                const idx = listOfDatasources.findIndex((d) => d.label === q.datasourceName);\n                return (\n                  <RichHistoryCard\n                    query={q}\n                    key={q.ts}\n                    exploreId={exploreId}\n                    dsImg={listOfDatasources[idx].imgUrl}\n                    isRemoved={listOfDatasources[idx].isRemoved}\n                  />\n                );\n              })}\n            </div>\n          );\n        })}\n        <div className={styles.footer}>The history is local to your browser and is not shared with others.</div>\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { css } from '@emotion/css';\nimport { uniqBy } from 'lodash';\n\n// Types\nimport { RichHistoryQuery, ExploreId } from 'app/types/explore';\n\n// Utils\nimport { stylesFactory, useTheme, Select, MultiSelect, FilterInput } from '@grafana/ui';\nimport { GrafanaTheme, SelectableValue } from '@grafana/data';\nimport { filterAndSortQueries, createDatasourcesList, SortOrder } from 'app/core/utils/richHistory';\n\n// Components\nimport RichHistoryCard from './RichHistoryCard';\nimport { sortOrderOptions } from './RichHistory';\nimport { useDebounce } from 'react-use';\n\nexport interface Props {\n  queries: RichHistoryQuery[];\n  sortOrder: SortOrder;\n  activeDatasourceOnly: boolean;\n  datasourceFilters: SelectableValue[];\n  exploreId: ExploreId;\n  onChangeSortOrder: (sortOrder: SortOrder) => void;\n  onSelectDatasourceFilters: (value: SelectableValue[]) => void;\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme) => {\n  const bgColor = theme.isLight ? theme.palette.gray5 : theme.palette.dark4;\n  return {\n    container: css`\n      display: flex;\n    `,\n    containerContent: css`\n      width: 100%;\n    `,\n    selectors: css`\n      display: flex;\n      justify-content: space-between;\n      flex-wrap: wrap;\n    `,\n    multiselect: css`\n      width: 100%;\n      margin-bottom: ${theme.spacing.sm};\n      .gf-form-select-box__multi-value {\n        background-color: ${bgColor};\n        padding: ${theme.spacing.xxs} ${theme.spacing.xs} ${theme.spacing.xxs} ${theme.spacing.sm};\n        border-radius: ${theme.border.radius.sm};\n      }\n    `,\n    filterInput: css`\n      margin-bottom: ${theme.spacing.sm};\n    `,\n    sort: css`\n      width: 170px;\n    `,\n    footer: css`\n      height: 60px;\n      margin-top: ${theme.spacing.lg};\n      display: flex;\n      justify-content: center;\n      font-weight: ${theme.typography.weight.light};\n      font-size: ${theme.typography.size.sm};\n      a {\n        font-weight: ${theme.typography.weight.semibold};\n        margin-left: ${theme.spacing.xxs};\n      }\n    `,\n  };\n});\n\nexport function RichHistoryStarredTab(props: Props) {\n  const {\n    datasourceFilters,\n    onSelectDatasourceFilters,\n    queries,\n    onChangeSortOrder,\n    sortOrder,\n    activeDatasourceOnly,\n    exploreId,\n  } = props;\n\n  const [data, setData] = useState<[RichHistoryQuery[], ReturnType<typeof createDatasourcesList>]>([[], []]);\n  const [searchInput, setSearchInput] = useState('');\n  const [debouncedSearchInput, setDebouncedSearchInput] = useState('');\n\n  const theme = useTheme();\n  const styles = getStyles(theme);\n\n  useDebounce(\n    () => {\n      setDebouncedSearchInput(searchInput);\n    },\n    300,\n    [searchInput]\n  );\n\n  useEffect(() => {\n    const datasourcesRetrievedFromQueryHistory = uniqBy(queries, 'datasourceName').map((d) => d.datasourceName);\n    const listOfDatasources = createDatasourcesList(datasourcesRetrievedFromQueryHistory);\n    const starredQueries = queries.filter((q) => q.starred === true);\n    setData([\n      filterAndSortQueries(\n        starredQueries,\n        sortOrder,\n        datasourceFilters.map((d) => d.value),\n        debouncedSearchInput\n      ),\n      listOfDatasources,\n    ]);\n  }, [queries, sortOrder, datasourceFilters, debouncedSearchInput]);\n\n  const [filteredQueries, listOfDatasources] = data;\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.containerContent}>\n        <div className={styles.selectors}>\n          {!activeDatasourceOnly && (\n            <div aria-label=\"Filter datasources\" className={styles.multiselect}>\n              <MultiSelect\n                menuShouldPortal\n                options={listOfDatasources}\n                value={datasourceFilters}\n                placeholder=\"Filter queries for specific data sources(s)\"\n                onChange={onSelectDatasourceFilters}\n              />\n            </div>\n          )}\n          <div className={styles.filterInput}>\n            <FilterInput\n              placeholder=\"Search queries\"\n              value={searchInput}\n              onChange={(value: string) => {\n                setSearchInput(value);\n              }}\n            />\n          </div>\n          <div aria-label=\"Sort queries\" className={styles.sort}>\n            <Select\n              menuShouldPortal\n              options={sortOrderOptions}\n              value={sortOrderOptions.filter((order) => order.value === sortOrder)}\n              placeholder=\"Sort queries by\"\n              onChange={(e) => onChangeSortOrder(e.value as SortOrder)}\n            />\n          </div>\n        </div>\n        {filteredQueries.map((q) => {\n          const idx = listOfDatasources.findIndex((d) => d.label === q.datasourceName);\n          return (\n            <RichHistoryCard\n              query={q}\n              key={q.ts}\n              exploreId={exploreId}\n              dsImg={listOfDatasources[idx].imgUrl}\n              isRemoved={listOfDatasources[idx].isRemoved}\n            />\n          );\n        })}\n        <div className={styles.footer}>The history is local to your browser and is not shared with others.</div>\n      </div>\n    </div>\n  );\n}\n","import React, { PureComponent } from 'react';\n\n//Services & Utils\nimport { RICH_HISTORY_SETTING_KEYS, SortOrder } from 'app/core/utils/richHistory';\nimport store from 'app/core/store';\nimport { Themeable, withTheme, TabbedContainer, TabConfig } from '@grafana/ui';\n\n//Types\nimport { RichHistoryQuery, ExploreId } from 'app/types/explore';\nimport { SelectableValue } from '@grafana/data';\n\n//Components\nimport { RichHistorySettings } from './RichHistorySettings';\nimport { RichHistoryQueriesTab } from './RichHistoryQueriesTab';\nimport { RichHistoryStarredTab } from './RichHistoryStarredTab';\n\nexport enum Tabs {\n  RichHistory = 'Query history',\n  Starred = 'Starred',\n  Settings = 'Settings',\n}\n\nexport const sortOrderOptions = [\n  { label: 'Newest first', value: SortOrder.Descending },\n  { label: 'Oldest first', value: SortOrder.Ascending },\n  { label: 'Data source A-Z', value: SortOrder.DatasourceAZ },\n  { label: 'Data source Z-A', value: SortOrder.DatasourceZA },\n];\n\nexport interface RichHistoryProps extends Themeable {\n  richHistory: RichHistoryQuery[];\n  activeDatasourceInstance?: string;\n  firstTab: Tabs;\n  exploreId: ExploreId;\n  height: number;\n  deleteRichHistory: () => void;\n  onClose: () => void;\n}\n\ninterface RichHistoryState {\n  sortOrder: SortOrder;\n  retentionPeriod: number;\n  starredTabAsFirstTab: boolean;\n  activeDatasourceOnly: boolean;\n  datasourceFilters: SelectableValue[];\n}\n\nclass UnThemedRichHistory extends PureComponent<RichHistoryProps, RichHistoryState> {\n  constructor(props: RichHistoryProps) {\n    super(props);\n    this.state = {\n      sortOrder: SortOrder.Descending,\n      datasourceFilters: store.getObject(RICH_HISTORY_SETTING_KEYS.datasourceFilters, []),\n      retentionPeriod: store.getObject(RICH_HISTORY_SETTING_KEYS.retentionPeriod, 7),\n      starredTabAsFirstTab: store.getBool(RICH_HISTORY_SETTING_KEYS.starredTabAsFirstTab, false),\n      activeDatasourceOnly: store.getBool(RICH_HISTORY_SETTING_KEYS.activeDatasourceOnly, true),\n    };\n  }\n\n  onChangeRetentionPeriod = (retentionPeriod: SelectableValue<number>) => {\n    if (retentionPeriod.value !== undefined) {\n      this.setState({\n        retentionPeriod: retentionPeriod.value,\n      });\n      store.set(RICH_HISTORY_SETTING_KEYS.retentionPeriod, retentionPeriod.value);\n    }\n  };\n\n  toggleStarredTabAsFirstTab = () => {\n    const starredTabAsFirstTab = !this.state.starredTabAsFirstTab;\n    this.setState({\n      starredTabAsFirstTab,\n    });\n    store.set(RICH_HISTORY_SETTING_KEYS.starredTabAsFirstTab, starredTabAsFirstTab);\n  };\n\n  toggleActiveDatasourceOnly = () => {\n    const activeDatasourceOnly = !this.state.activeDatasourceOnly;\n    this.setState({\n      activeDatasourceOnly,\n    });\n    store.set(RICH_HISTORY_SETTING_KEYS.activeDatasourceOnly, activeDatasourceOnly);\n  };\n\n  onSelectDatasourceFilters = (value: SelectableValue[]) => {\n    try {\n      store.setObject(RICH_HISTORY_SETTING_KEYS.datasourceFilters, value);\n    } catch (error) {\n      console.error(error);\n    }\n    /* Set data source filters to state even though they were not successfully saved in\n     * localStorage to allow interaction and filtering.\n     **/\n    this.setState({ datasourceFilters: value });\n  };\n\n  onChangeSortOrder = (sortOrder: SortOrder) => this.setState({ sortOrder });\n\n  /* If user selects activeDatasourceOnly === true, set datasource filter to currently active datasource.\n   * Filtering based on datasource won't be available. Otherwise set to null, as filtering will be\n   * available for user.\n   */\n  updateFilters() {\n    this.state.activeDatasourceOnly && this.props.activeDatasourceInstance\n      ? this.onSelectDatasourceFilters([\n          { label: this.props.activeDatasourceInstance, value: this.props.activeDatasourceInstance },\n        ])\n      : this.onSelectDatasourceFilters(this.state.datasourceFilters);\n  }\n\n  componentDidMount() {\n    this.updateFilters();\n  }\n\n  componentDidUpdate(prevProps: RichHistoryProps, prevState: RichHistoryState) {\n    if (\n      this.props.activeDatasourceInstance !== prevProps.activeDatasourceInstance ||\n      this.state.activeDatasourceOnly !== prevState.activeDatasourceOnly\n    ) {\n      this.updateFilters();\n    }\n  }\n\n  render() {\n    const { datasourceFilters, sortOrder, activeDatasourceOnly, retentionPeriod } = this.state;\n    const { richHistory, height, exploreId, deleteRichHistory, onClose, firstTab } = this.props;\n\n    const QueriesTab: TabConfig = {\n      label: 'Query history',\n      value: Tabs.RichHistory,\n      content: (\n        <RichHistoryQueriesTab\n          queries={richHistory}\n          sortOrder={sortOrder}\n          datasourceFilters={datasourceFilters}\n          activeDatasourceOnly={activeDatasourceOnly}\n          retentionPeriod={retentionPeriod}\n          onChangeSortOrder={this.onChangeSortOrder}\n          onSelectDatasourceFilters={this.onSelectDatasourceFilters}\n          exploreId={exploreId}\n          height={height}\n        />\n      ),\n      icon: 'history',\n    };\n\n    const StarredTab: TabConfig = {\n      label: 'Starred',\n      value: Tabs.Starred,\n      content: (\n        <RichHistoryStarredTab\n          queries={richHistory}\n          sortOrder={sortOrder}\n          datasourceFilters={datasourceFilters}\n          activeDatasourceOnly={activeDatasourceOnly}\n          onChangeSortOrder={this.onChangeSortOrder}\n          onSelectDatasourceFilters={this.onSelectDatasourceFilters}\n          exploreId={exploreId}\n        />\n      ),\n      icon: 'star',\n    };\n\n    const SettingsTab: TabConfig = {\n      label: 'Settings',\n      value: Tabs.Settings,\n      content: (\n        <RichHistorySettings\n          retentionPeriod={this.state.retentionPeriod}\n          starredTabAsFirstTab={this.state.starredTabAsFirstTab}\n          activeDatasourceOnly={this.state.activeDatasourceOnly}\n          onChangeRetentionPeriod={this.onChangeRetentionPeriod}\n          toggleStarredTabAsFirstTab={this.toggleStarredTabAsFirstTab}\n          toggleactiveDatasourceOnly={this.toggleActiveDatasourceOnly}\n          deleteRichHistory={deleteRichHistory}\n        />\n      ),\n      icon: 'sliders-v-alt',\n    };\n\n    let tabs = [QueriesTab, StarredTab, SettingsTab];\n    return (\n      <TabbedContainer tabs={tabs} onClose={onClose} defaultTab={firstTab} closeIconTooltip=\"Close query history\" />\n    );\n  }\n}\n\nexport const RichHistory = withTheme(UnThemedRichHistory);\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nvar styles = {\n    top: {\n        width: '100%',\n        height: '10px',\n        top: '-5px',\n        left: '0px',\n        cursor: 'row-resize',\n    },\n    right: {\n        width: '10px',\n        height: '100%',\n        top: '0px',\n        right: '-5px',\n        cursor: 'col-resize',\n    },\n    bottom: {\n        width: '100%',\n        height: '10px',\n        bottom: '-5px',\n        left: '0px',\n        cursor: 'row-resize',\n    },\n    left: {\n        width: '10px',\n        height: '100%',\n        top: '0px',\n        left: '-5px',\n        cursor: 'col-resize',\n    },\n    topRight: {\n        width: '20px',\n        height: '20px',\n        position: 'absolute',\n        right: '-10px',\n        top: '-10px',\n        cursor: 'ne-resize',\n    },\n    bottomRight: {\n        width: '20px',\n        height: '20px',\n        position: 'absolute',\n        right: '-10px',\n        bottom: '-10px',\n        cursor: 'se-resize',\n    },\n    bottomLeft: {\n        width: '20px',\n        height: '20px',\n        position: 'absolute',\n        left: '-10px',\n        bottom: '-10px',\n        cursor: 'sw-resize',\n    },\n    topLeft: {\n        width: '20px',\n        height: '20px',\n        position: 'absolute',\n        left: '-10px',\n        top: '-10px',\n        cursor: 'nw-resize',\n    },\n};\nvar Resizer = /** @class */ (function (_super) {\n    __extends(Resizer, _super);\n    function Resizer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.onMouseDown = function (e) {\n            _this.props.onResizeStart(e, _this.props.direction);\n        };\n        _this.onTouchStart = function (e) {\n            _this.props.onResizeStart(e, _this.props.direction);\n        };\n        return _this;\n    }\n    Resizer.prototype.render = function () {\n        return (React.createElement(\"div\", { className: this.props.className || '', style: __assign(__assign({ position: 'absolute', userSelect: 'none' }, styles[this.props.direction]), (this.props.replaceStyles || {})), onMouseDown: this.onMouseDown, onTouchStart: this.onTouchStart }, this.props.children));\n    };\n    return Resizer;\n}(React.PureComponent));\nexport { Resizer };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport { Resizer } from './resizer';\nimport memoize from 'fast-memoize';\nvar DEFAULT_SIZE = {\n    width: 'auto',\n    height: 'auto',\n};\nvar clamp = memoize(function (n, min, max) { return Math.max(Math.min(n, max), min); });\nvar snap = memoize(function (n, size) { return Math.round(n / size) * size; });\nvar hasDirection = memoize(function (dir, target) {\n    return new RegExp(dir, 'i').test(target);\n});\n// INFO: In case of window is a Proxy and does not porxy Events correctly, use isTouchEvent & isMouseEvent to distinguish event type instead of `instanceof`.\nvar isTouchEvent = function (event) {\n    return Boolean(event.touches && event.touches.length);\n};\nvar isMouseEvent = function (event) {\n    return Boolean((event.clientX || event.clientX === 0) &&\n        (event.clientY || event.clientY === 0));\n};\nvar findClosestSnap = memoize(function (n, snapArray, snapGap) {\n    if (snapGap === void 0) { snapGap = 0; }\n    var closestGapIndex = snapArray.reduce(function (prev, curr, index) { return (Math.abs(curr - n) < Math.abs(snapArray[prev] - n) ? index : prev); }, 0);\n    var gap = Math.abs(snapArray[closestGapIndex] - n);\n    return snapGap === 0 || gap < snapGap ? snapArray[closestGapIndex] : n;\n});\nvar endsWith = memoize(function (str, searchStr) {\n    return str.substr(str.length - searchStr.length, searchStr.length) === searchStr;\n});\nvar getStringSize = memoize(function (n) {\n    n = n.toString();\n    if (n === 'auto') {\n        return n;\n    }\n    if (endsWith(n, 'px')) {\n        return n;\n    }\n    if (endsWith(n, '%')) {\n        return n;\n    }\n    if (endsWith(n, 'vh')) {\n        return n;\n    }\n    if (endsWith(n, 'vw')) {\n        return n;\n    }\n    if (endsWith(n, 'vmax')) {\n        return n;\n    }\n    if (endsWith(n, 'vmin')) {\n        return n;\n    }\n    return n + \"px\";\n});\nvar getPixelSize = function (size, parentSize, innerWidth, innerHeight) {\n    if (size && typeof size === 'string') {\n        if (endsWith(size, 'px')) {\n            return Number(size.replace('px', ''));\n        }\n        if (endsWith(size, '%')) {\n            var ratio = Number(size.replace('%', '')) / 100;\n            return parentSize * ratio;\n        }\n        if (endsWith(size, 'vw')) {\n            var ratio = Number(size.replace('vw', '')) / 100;\n            return innerWidth * ratio;\n        }\n        if (endsWith(size, 'vh')) {\n            var ratio = Number(size.replace('vh', '')) / 100;\n            return innerHeight * ratio;\n        }\n    }\n    return size;\n};\nvar calculateNewMax = memoize(function (parentSize, innerWidth, innerHeight, maxWidth, maxHeight, minWidth, minHeight) {\n    maxWidth = getPixelSize(maxWidth, parentSize.width, innerWidth, innerHeight);\n    maxHeight = getPixelSize(maxHeight, parentSize.height, innerWidth, innerHeight);\n    minWidth = getPixelSize(minWidth, parentSize.width, innerWidth, innerHeight);\n    minHeight = getPixelSize(minHeight, parentSize.height, innerWidth, innerHeight);\n    return {\n        maxWidth: typeof maxWidth === 'undefined' ? undefined : Number(maxWidth),\n        maxHeight: typeof maxHeight === 'undefined' ? undefined : Number(maxHeight),\n        minWidth: typeof minWidth === 'undefined' ? undefined : Number(minWidth),\n        minHeight: typeof minHeight === 'undefined' ? undefined : Number(minHeight),\n    };\n});\nvar definedProps = [\n    'as',\n    'style',\n    'className',\n    'grid',\n    'snap',\n    'bounds',\n    'boundsByDirection',\n    'size',\n    'defaultSize',\n    'minWidth',\n    'minHeight',\n    'maxWidth',\n    'maxHeight',\n    'lockAspectRatio',\n    'lockAspectRatioExtraWidth',\n    'lockAspectRatioExtraHeight',\n    'enable',\n    'handleStyles',\n    'handleClasses',\n    'handleWrapperStyle',\n    'handleWrapperClass',\n    'children',\n    'onResizeStart',\n    'onResize',\n    'onResizeStop',\n    'handleComponent',\n    'scale',\n    'resizeRatio',\n    'snapGap',\n];\n// HACK: This class is used to calculate % size.\nvar baseClassName = '__resizable_base__';\nvar Resizable = /** @class */ (function (_super) {\n    __extends(Resizable, _super);\n    function Resizable(props) {\n        var _this = _super.call(this, props) || this;\n        _this.ratio = 1;\n        _this.resizable = null;\n        // For parent boundary\n        _this.parentLeft = 0;\n        _this.parentTop = 0;\n        // For boundary\n        _this.resizableLeft = 0;\n        _this.resizableRight = 0;\n        _this.resizableTop = 0;\n        _this.resizableBottom = 0;\n        // For target boundary\n        _this.targetLeft = 0;\n        _this.targetTop = 0;\n        _this.appendBase = function () {\n            if (!_this.resizable || !_this.window) {\n                return null;\n            }\n            var parent = _this.parentNode;\n            if (!parent) {\n                return null;\n            }\n            var element = _this.window.document.createElement('div');\n            element.style.width = '100%';\n            element.style.height = '100%';\n            element.style.position = 'absolute';\n            element.style.transform = 'scale(0, 0)';\n            element.style.left = '0';\n            element.style.flex = '0';\n            if (element.classList) {\n                element.classList.add(baseClassName);\n            }\n            else {\n                element.className += baseClassName;\n            }\n            parent.appendChild(element);\n            return element;\n        };\n        _this.removeBase = function (base) {\n            var parent = _this.parentNode;\n            if (!parent) {\n                return;\n            }\n            parent.removeChild(base);\n        };\n        _this.ref = function (c) {\n            if (c) {\n                _this.resizable = c;\n            }\n        };\n        _this.state = {\n            isResizing: false,\n            width: typeof (_this.propsSize && _this.propsSize.width) === 'undefined'\n                ? 'auto'\n                : _this.propsSize && _this.propsSize.width,\n            height: typeof (_this.propsSize && _this.propsSize.height) === 'undefined'\n                ? 'auto'\n                : _this.propsSize && _this.propsSize.height,\n            direction: 'right',\n            original: {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0,\n            },\n            backgroundStyle: {\n                height: '100%',\n                width: '100%',\n                backgroundColor: 'rgba(0,0,0,0)',\n                cursor: 'auto',\n                opacity: 0,\n                position: 'fixed',\n                zIndex: 9999,\n                top: '0',\n                left: '0',\n                bottom: '0',\n                right: '0',\n            },\n            flexBasis: undefined,\n        };\n        _this.onResizeStart = _this.onResizeStart.bind(_this);\n        _this.onMouseMove = _this.onMouseMove.bind(_this);\n        _this.onMouseUp = _this.onMouseUp.bind(_this);\n        return _this;\n    }\n    Object.defineProperty(Resizable.prototype, \"parentNode\", {\n        get: function () {\n            if (!this.resizable) {\n                return null;\n            }\n            return this.resizable.parentNode;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Resizable.prototype, \"window\", {\n        get: function () {\n            if (!this.resizable) {\n                return null;\n            }\n            if (!this.resizable.ownerDocument) {\n                return null;\n            }\n            return this.resizable.ownerDocument.defaultView;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Resizable.prototype, \"propsSize\", {\n        get: function () {\n            return this.props.size || this.props.defaultSize || DEFAULT_SIZE;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Resizable.prototype, \"size\", {\n        get: function () {\n            var width = 0;\n            var height = 0;\n            if (this.resizable && this.window) {\n                var orgWidth = this.resizable.offsetWidth;\n                var orgHeight = this.resizable.offsetHeight;\n                // HACK: Set position `relative` to get parent size.\n                //       This is because when re-resizable set `absolute`, I can not get base width correctly.\n                var orgPosition = this.resizable.style.position;\n                if (orgPosition !== 'relative') {\n                    this.resizable.style.position = 'relative';\n                }\n                // INFO: Use original width or height if set auto.\n                width = this.resizable.style.width !== 'auto' ? this.resizable.offsetWidth : orgWidth;\n                height = this.resizable.style.height !== 'auto' ? this.resizable.offsetHeight : orgHeight;\n                // Restore original position\n                this.resizable.style.position = orgPosition;\n            }\n            return { width: width, height: height };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Resizable.prototype, \"sizeStyle\", {\n        get: function () {\n            var _this = this;\n            var size = this.props.size;\n            var getSize = function (key) {\n                if (typeof _this.state[key] === 'undefined' || _this.state[key] === 'auto') {\n                    return 'auto';\n                }\n                if (_this.propsSize && _this.propsSize[key] && endsWith(_this.propsSize[key].toString(), '%')) {\n                    if (endsWith(_this.state[key].toString(), '%')) {\n                        return _this.state[key].toString();\n                    }\n                    var parentSize = _this.getParentSize();\n                    var value = Number(_this.state[key].toString().replace('px', ''));\n                    var percent = (value / parentSize[key]) * 100;\n                    return percent + \"%\";\n                }\n                return getStringSize(_this.state[key]);\n            };\n            var width = size && typeof size.width !== 'undefined' && !this.state.isResizing\n                ? getStringSize(size.width)\n                : getSize('width');\n            var height = size && typeof size.height !== 'undefined' && !this.state.isResizing\n                ? getStringSize(size.height)\n                : getSize('height');\n            return { width: width, height: height };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Resizable.prototype.getParentSize = function () {\n        if (!this.parentNode) {\n            if (!this.window) {\n                return { width: 0, height: 0 };\n            }\n            return { width: this.window.innerWidth, height: this.window.innerHeight };\n        }\n        var base = this.appendBase();\n        if (!base) {\n            return { width: 0, height: 0 };\n        }\n        // INFO: To calculate parent width with flex layout\n        var wrapChanged = false;\n        var wrap = this.parentNode.style.flexWrap;\n        if (wrap !== 'wrap') {\n            wrapChanged = true;\n            this.parentNode.style.flexWrap = 'wrap';\n            // HACK: Use relative to get parent padding size\n        }\n        base.style.position = 'relative';\n        base.style.minWidth = '100%';\n        var size = {\n            width: base.offsetWidth,\n            height: base.offsetHeight,\n        };\n        if (wrapChanged) {\n            this.parentNode.style.flexWrap = wrap;\n        }\n        this.removeBase(base);\n        return size;\n    };\n    Resizable.prototype.bindEvents = function () {\n        if (this.window) {\n            this.window.addEventListener('mouseup', this.onMouseUp);\n            this.window.addEventListener('mousemove', this.onMouseMove);\n            this.window.addEventListener('mouseleave', this.onMouseUp);\n            this.window.addEventListener('touchmove', this.onMouseMove, {\n                capture: true,\n                passive: false,\n            });\n            this.window.addEventListener('touchend', this.onMouseUp);\n        }\n    };\n    Resizable.prototype.unbindEvents = function () {\n        if (this.window) {\n            this.window.removeEventListener('mouseup', this.onMouseUp);\n            this.window.removeEventListener('mousemove', this.onMouseMove);\n            this.window.removeEventListener('mouseleave', this.onMouseUp);\n            this.window.removeEventListener('touchmove', this.onMouseMove, true);\n            this.window.removeEventListener('touchend', this.onMouseUp);\n        }\n    };\n    Resizable.prototype.componentDidMount = function () {\n        if (!this.resizable || !this.window) {\n            return;\n        }\n        var computedStyle = this.window.getComputedStyle(this.resizable);\n        this.setState({\n            width: this.state.width || this.size.width,\n            height: this.state.height || this.size.height,\n            flexBasis: computedStyle.flexBasis !== 'auto' ? computedStyle.flexBasis : undefined,\n        });\n    };\n    Resizable.prototype.componentWillUnmount = function () {\n        if (this.window) {\n            this.unbindEvents();\n        }\n    };\n    Resizable.prototype.createSizeForCssProperty = function (newSize, kind) {\n        var propsSize = this.propsSize && this.propsSize[kind];\n        return this.state[kind] === 'auto' &&\n            this.state.original[kind] === newSize &&\n            (typeof propsSize === 'undefined' || propsSize === 'auto')\n            ? 'auto'\n            : newSize;\n    };\n    Resizable.prototype.calculateNewMaxFromBoundary = function (maxWidth, maxHeight) {\n        var boundsByDirection = this.props.boundsByDirection;\n        var direction = this.state.direction;\n        var widthByDirection = boundsByDirection && hasDirection('left', direction);\n        var heightByDirection = boundsByDirection && hasDirection('top', direction);\n        var boundWidth;\n        var boundHeight;\n        if (this.props.bounds === 'parent') {\n            var parent_1 = this.parentNode;\n            if (parent_1) {\n                boundWidth = widthByDirection\n                    ? this.resizableRight - this.parentLeft\n                    : parent_1.offsetWidth + (this.parentLeft - this.resizableLeft);\n                boundHeight = heightByDirection\n                    ? this.resizableBottom - this.parentTop\n                    : parent_1.offsetHeight + (this.parentTop - this.resizableTop);\n            }\n        }\n        else if (this.props.bounds === 'window') {\n            if (this.window) {\n                boundWidth = widthByDirection ? this.resizableRight : this.window.innerWidth - this.resizableLeft;\n                boundHeight = heightByDirection ? this.resizableBottom : this.window.innerHeight - this.resizableTop;\n            }\n        }\n        else if (this.props.bounds) {\n            boundWidth = widthByDirection\n                ? this.resizableRight - this.targetLeft\n                : this.props.bounds.offsetWidth + (this.targetLeft - this.resizableLeft);\n            boundHeight = heightByDirection\n                ? this.resizableBottom - this.targetTop\n                : this.props.bounds.offsetHeight + (this.targetTop - this.resizableTop);\n        }\n        if (boundWidth && Number.isFinite(boundWidth)) {\n            maxWidth = maxWidth && maxWidth < boundWidth ? maxWidth : boundWidth;\n        }\n        if (boundHeight && Number.isFinite(boundHeight)) {\n            maxHeight = maxHeight && maxHeight < boundHeight ? maxHeight : boundHeight;\n        }\n        return { maxWidth: maxWidth, maxHeight: maxHeight };\n    };\n    Resizable.prototype.calculateNewSizeFromDirection = function (clientX, clientY) {\n        var scale = this.props.scale || 1;\n        var resizeRatio = this.props.resizeRatio || 1;\n        var _a = this.state, direction = _a.direction, original = _a.original;\n        var _b = this.props, lockAspectRatio = _b.lockAspectRatio, lockAspectRatioExtraHeight = _b.lockAspectRatioExtraHeight, lockAspectRatioExtraWidth = _b.lockAspectRatioExtraWidth;\n        var newWidth = original.width;\n        var newHeight = original.height;\n        var extraHeight = lockAspectRatioExtraHeight || 0;\n        var extraWidth = lockAspectRatioExtraWidth || 0;\n        if (hasDirection('right', direction)) {\n            newWidth = original.width + ((clientX - original.x) * resizeRatio) / scale;\n            if (lockAspectRatio) {\n                newHeight = (newWidth - extraWidth) / this.ratio + extraHeight;\n            }\n        }\n        if (hasDirection('left', direction)) {\n            newWidth = original.width - ((clientX - original.x) * resizeRatio) / scale;\n            if (lockAspectRatio) {\n                newHeight = (newWidth - extraWidth) / this.ratio + extraHeight;\n            }\n        }\n        if (hasDirection('bottom', direction)) {\n            newHeight = original.height + ((clientY - original.y) * resizeRatio) / scale;\n            if (lockAspectRatio) {\n                newWidth = (newHeight - extraHeight) * this.ratio + extraWidth;\n            }\n        }\n        if (hasDirection('top', direction)) {\n            newHeight = original.height - ((clientY - original.y) * resizeRatio) / scale;\n            if (lockAspectRatio) {\n                newWidth = (newHeight - extraHeight) * this.ratio + extraWidth;\n            }\n        }\n        return { newWidth: newWidth, newHeight: newHeight };\n    };\n    Resizable.prototype.calculateNewSizeFromAspectRatio = function (newWidth, newHeight, max, min) {\n        var _a = this.props, lockAspectRatio = _a.lockAspectRatio, lockAspectRatioExtraHeight = _a.lockAspectRatioExtraHeight, lockAspectRatioExtraWidth = _a.lockAspectRatioExtraWidth;\n        var computedMinWidth = typeof min.width === 'undefined' ? 10 : min.width;\n        var computedMaxWidth = typeof max.width === 'undefined' || max.width < 0 ? newWidth : max.width;\n        var computedMinHeight = typeof min.height === 'undefined' ? 10 : min.height;\n        var computedMaxHeight = typeof max.height === 'undefined' || max.height < 0 ? newHeight : max.height;\n        var extraHeight = lockAspectRatioExtraHeight || 0;\n        var extraWidth = lockAspectRatioExtraWidth || 0;\n        if (lockAspectRatio) {\n            var extraMinWidth = (computedMinHeight - extraHeight) * this.ratio + extraWidth;\n            var extraMaxWidth = (computedMaxHeight - extraHeight) * this.ratio + extraWidth;\n            var extraMinHeight = (computedMinWidth - extraWidth) / this.ratio + extraHeight;\n            var extraMaxHeight = (computedMaxWidth - extraWidth) / this.ratio + extraHeight;\n            var lockedMinWidth = Math.max(computedMinWidth, extraMinWidth);\n            var lockedMaxWidth = Math.min(computedMaxWidth, extraMaxWidth);\n            var lockedMinHeight = Math.max(computedMinHeight, extraMinHeight);\n            var lockedMaxHeight = Math.min(computedMaxHeight, extraMaxHeight);\n            newWidth = clamp(newWidth, lockedMinWidth, lockedMaxWidth);\n            newHeight = clamp(newHeight, lockedMinHeight, lockedMaxHeight);\n        }\n        else {\n            newWidth = clamp(newWidth, computedMinWidth, computedMaxWidth);\n            newHeight = clamp(newHeight, computedMinHeight, computedMaxHeight);\n        }\n        return { newWidth: newWidth, newHeight: newHeight };\n    };\n    Resizable.prototype.setBoundingClientRect = function () {\n        // For parent boundary\n        if (this.props.bounds === 'parent') {\n            var parent_2 = this.parentNode;\n            if (parent_2) {\n                var parentRect = parent_2.getBoundingClientRect();\n                this.parentLeft = parentRect.left;\n                this.parentTop = parentRect.top;\n            }\n        }\n        // For target(html element) boundary\n        if (this.props.bounds && typeof this.props.bounds !== 'string') {\n            var targetRect = this.props.bounds.getBoundingClientRect();\n            this.targetLeft = targetRect.left;\n            this.targetTop = targetRect.top;\n        }\n        // For boundary\n        if (this.resizable) {\n            var _a = this.resizable.getBoundingClientRect(), left = _a.left, top_1 = _a.top, right = _a.right, bottom = _a.bottom;\n            this.resizableLeft = left;\n            this.resizableRight = right;\n            this.resizableTop = top_1;\n            this.resizableBottom = bottom;\n        }\n    };\n    Resizable.prototype.onResizeStart = function (event, direction) {\n        if (!this.resizable || !this.window) {\n            return;\n        }\n        var clientX = 0;\n        var clientY = 0;\n        if (event.nativeEvent && isMouseEvent(event.nativeEvent)) {\n            clientX = event.nativeEvent.clientX;\n            clientY = event.nativeEvent.clientY;\n        }\n        else if (event.nativeEvent && isTouchEvent(event.nativeEvent)) {\n            clientX = event.nativeEvent.touches[0].clientX;\n            clientY = event.nativeEvent.touches[0].clientY;\n        }\n        if (this.props.onResizeStart) {\n            if (this.resizable) {\n                var startResize = this.props.onResizeStart(event, direction, this.resizable);\n                if (startResize === false) {\n                    return;\n                }\n            }\n        }\n        // Fix #168\n        if (this.props.size) {\n            if (typeof this.props.size.height !== 'undefined' && this.props.size.height !== this.state.height) {\n                this.setState({ height: this.props.size.height });\n            }\n            if (typeof this.props.size.width !== 'undefined' && this.props.size.width !== this.state.width) {\n                this.setState({ width: this.props.size.width });\n            }\n        }\n        // For lockAspectRatio case\n        this.ratio =\n            typeof this.props.lockAspectRatio === 'number' ? this.props.lockAspectRatio : this.size.width / this.size.height;\n        var flexBasis;\n        var computedStyle = this.window.getComputedStyle(this.resizable);\n        if (computedStyle.flexBasis !== 'auto') {\n            var parent_3 = this.parentNode;\n            if (parent_3) {\n                var dir = this.window.getComputedStyle(parent_3).flexDirection;\n                this.flexDir = dir.startsWith('row') ? 'row' : 'column';\n                flexBasis = computedStyle.flexBasis;\n            }\n        }\n        // For boundary\n        this.setBoundingClientRect();\n        this.bindEvents();\n        var state = {\n            original: {\n                x: clientX,\n                y: clientY,\n                width: this.size.width,\n                height: this.size.height,\n            },\n            isResizing: true,\n            backgroundStyle: __assign(__assign({}, this.state.backgroundStyle), { cursor: this.window.getComputedStyle(event.target).cursor || 'auto' }),\n            direction: direction,\n            flexBasis: flexBasis,\n        };\n        this.setState(state);\n    };\n    Resizable.prototype.onMouseMove = function (event) {\n        if (!this.state.isResizing || !this.resizable || !this.window) {\n            return;\n        }\n        if (this.window.TouchEvent && isTouchEvent(event)) {\n            try {\n                event.preventDefault();\n                event.stopPropagation();\n            }\n            catch (e) {\n                // Ignore on fail\n            }\n        }\n        var _a = this.props, maxWidth = _a.maxWidth, maxHeight = _a.maxHeight, minWidth = _a.minWidth, minHeight = _a.minHeight;\n        var clientX = isTouchEvent(event) ? event.touches[0].clientX : event.clientX;\n        var clientY = isTouchEvent(event) ? event.touches[0].clientY : event.clientY;\n        var _b = this.state, direction = _b.direction, original = _b.original, width = _b.width, height = _b.height;\n        var parentSize = this.getParentSize();\n        var max = calculateNewMax(parentSize, this.window.innerWidth, this.window.innerHeight, maxWidth, maxHeight, minWidth, minHeight);\n        maxWidth = max.maxWidth;\n        maxHeight = max.maxHeight;\n        minWidth = max.minWidth;\n        minHeight = max.minHeight;\n        // Calculate new size\n        var _c = this.calculateNewSizeFromDirection(clientX, clientY), newHeight = _c.newHeight, newWidth = _c.newWidth;\n        // Calculate max size from boundary settings\n        var boundaryMax = this.calculateNewMaxFromBoundary(maxWidth, maxHeight);\n        // Calculate new size from aspect ratio\n        var newSize = this.calculateNewSizeFromAspectRatio(newWidth, newHeight, { width: boundaryMax.maxWidth, height: boundaryMax.maxHeight }, { width: minWidth, height: minHeight });\n        newWidth = newSize.newWidth;\n        newHeight = newSize.newHeight;\n        if (this.props.grid) {\n            var newGridWidth = snap(newWidth, this.props.grid[0]);\n            var newGridHeight = snap(newHeight, this.props.grid[1]);\n            var gap = this.props.snapGap || 0;\n            newWidth = gap === 0 || Math.abs(newGridWidth - newWidth) <= gap ? newGridWidth : newWidth;\n            newHeight = gap === 0 || Math.abs(newGridHeight - newHeight) <= gap ? newGridHeight : newHeight;\n        }\n        if (this.props.snap && this.props.snap.x) {\n            newWidth = findClosestSnap(newWidth, this.props.snap.x, this.props.snapGap);\n        }\n        if (this.props.snap && this.props.snap.y) {\n            newHeight = findClosestSnap(newHeight, this.props.snap.y, this.props.snapGap);\n        }\n        var delta = {\n            width: newWidth - original.width,\n            height: newHeight - original.height,\n        };\n        if (width && typeof width === 'string') {\n            if (endsWith(width, '%')) {\n                var percent = (newWidth / parentSize.width) * 100;\n                newWidth = percent + \"%\";\n            }\n            else if (endsWith(width, 'vw')) {\n                var vw = (newWidth / this.window.innerWidth) * 100;\n                newWidth = vw + \"vw\";\n            }\n            else if (endsWith(width, 'vh')) {\n                var vh = (newWidth / this.window.innerHeight) * 100;\n                newWidth = vh + \"vh\";\n            }\n        }\n        if (height && typeof height === 'string') {\n            if (endsWith(height, '%')) {\n                var percent = (newHeight / parentSize.height) * 100;\n                newHeight = percent + \"%\";\n            }\n            else if (endsWith(height, 'vw')) {\n                var vw = (newHeight / this.window.innerWidth) * 100;\n                newHeight = vw + \"vw\";\n            }\n            else if (endsWith(height, 'vh')) {\n                var vh = (newHeight / this.window.innerHeight) * 100;\n                newHeight = vh + \"vh\";\n            }\n        }\n        var newState = {\n            width: this.createSizeForCssProperty(newWidth, 'width'),\n            height: this.createSizeForCssProperty(newHeight, 'height'),\n        };\n        if (this.flexDir === 'row') {\n            newState.flexBasis = newState.width;\n        }\n        else if (this.flexDir === 'column') {\n            newState.flexBasis = newState.height;\n        }\n        this.setState(newState);\n        if (this.props.onResize) {\n            this.props.onResize(event, direction, this.resizable, delta);\n        }\n    };\n    Resizable.prototype.onMouseUp = function (event) {\n        var _a = this.state, isResizing = _a.isResizing, direction = _a.direction, original = _a.original;\n        if (!isResizing || !this.resizable) {\n            return;\n        }\n        var delta = {\n            width: this.size.width - original.width,\n            height: this.size.height - original.height,\n        };\n        if (this.props.onResizeStop) {\n            this.props.onResizeStop(event, direction, this.resizable, delta);\n        }\n        if (this.props.size) {\n            this.setState(this.props.size);\n        }\n        this.unbindEvents();\n        this.setState({\n            isResizing: false,\n            backgroundStyle: __assign(__assign({}, this.state.backgroundStyle), { cursor: 'auto' }),\n        });\n    };\n    Resizable.prototype.updateSize = function (size) {\n        this.setState({ width: size.width, height: size.height });\n    };\n    Resizable.prototype.renderResizer = function () {\n        var _this = this;\n        var _a = this.props, enable = _a.enable, handleStyles = _a.handleStyles, handleClasses = _a.handleClasses, handleWrapperStyle = _a.handleWrapperStyle, handleWrapperClass = _a.handleWrapperClass, handleComponent = _a.handleComponent;\n        if (!enable) {\n            return null;\n        }\n        var resizers = Object.keys(enable).map(function (dir) {\n            if (enable[dir] !== false) {\n                return (React.createElement(Resizer, { key: dir, direction: dir, onResizeStart: _this.onResizeStart, replaceStyles: handleStyles && handleStyles[dir], className: handleClasses && handleClasses[dir] }, handleComponent && handleComponent[dir] ? handleComponent[dir] : null));\n            }\n            return null;\n        });\n        // #93 Wrap the resize box in span (will not break 100% width/height)\n        return (React.createElement(\"div\", { className: handleWrapperClass, style: handleWrapperStyle }, resizers));\n    };\n    Resizable.prototype.render = function () {\n        var _this = this;\n        var extendsProps = Object.keys(this.props).reduce(function (acc, key) {\n            if (definedProps.indexOf(key) !== -1) {\n                return acc;\n            }\n            acc[key] = _this.props[key];\n            return acc;\n        }, {});\n        var style = __assign(__assign(__assign({ position: 'relative', userSelect: this.state.isResizing ? 'none' : 'auto' }, this.props.style), this.sizeStyle), { maxWidth: this.props.maxWidth, maxHeight: this.props.maxHeight, minWidth: this.props.minWidth, minHeight: this.props.minHeight, boxSizing: 'border-box', flexShrink: 0 });\n        if (this.state.flexBasis) {\n            style.flexBasis = this.state.flexBasis;\n        }\n        var Wrapper = this.props.as || 'div';\n        return (React.createElement(Wrapper, __assign({ ref: this.ref, style: style, className: this.props.className }, extendsProps),\n            this.state.isResizing && React.createElement(\"div\", { style: this.state.backgroundStyle }),\n            this.props.children,\n            this.renderResizer()));\n    };\n    Resizable.defaultProps = {\n        as: 'div',\n        onResizeStart: function () { },\n        onResize: function () { },\n        onResizeStop: function () { },\n        enable: {\n            top: true,\n            right: true,\n            bottom: true,\n            left: true,\n            topRight: true,\n            bottomRight: true,\n            bottomLeft: true,\n            topLeft: true,\n        },\n        style: {},\n        grid: [1, 1],\n        lockAspectRatio: false,\n        lockAspectRatioExtraWidth: 0,\n        lockAspectRatioExtraHeight: 0,\n        scale: 1,\n        resizeRatio: 1,\n        snapGap: 0,\n    };\n    return Resizable;\n}(React.PureComponent));\nexport { Resizable };\n","// Libraries\nimport React from 'react';\nimport { Resizable, ResizeCallback } from 're-resizable';\nimport { css, cx, keyframes } from '@emotion/css';\n\n// Services & Utils\nimport { stylesFactory, useTheme2 } from '@grafana/ui';\n\n// Types\nimport { GrafanaTheme2 } from '@grafana/data';\n\nconst drawerSlide = keyframes`\n  0% {\n    transform: translateY(400px);\n  }\n\n  100% {\n    transform: translateY(0px);\n  }\n`;\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2) => {\n  return {\n    container: css`\n      position: fixed !important;\n      bottom: 0;\n      background: ${theme.colors.background.primary};\n      border-top: 1px solid ${theme.colors.border.weak};\n      margin: ${theme.spacing(0, -2, 0, -2)};\n      box-shadow: ${theme.shadows.z3};\n      z-index: ${theme.zIndex.sidemenu};\n    `,\n    drawerActive: css`\n      opacity: 1;\n      animation: 0.5s ease-out ${drawerSlide};\n    `,\n    rzHandle: css`\n      background: ${theme.colors.secondary.main};\n      transition: 0.3s background ease-in-out;\n      position: relative;\n      width: 200px !important;\n      height: 7px !important;\n      left: calc(50% - 100px) !important;\n      top: -4px !important;\n      cursor: grab;\n      border-radius: 4px;\n      &:hover {\n        background: ${theme.colors.secondary.shade};\n      }\n    `,\n  };\n});\n\nexport interface Props {\n  width: number;\n  children: React.ReactNode;\n  onResize?: ResizeCallback;\n}\n\nexport function ExploreDrawer(props: Props) {\n  const { width, children, onResize } = props;\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n  const drawerWidth = `${width + 31.5}px`;\n\n  return (\n    <Resizable\n      className={cx(styles.container, styles.drawerActive)}\n      defaultSize={{ width: drawerWidth, height: '400px' }}\n      handleClasses={{ top: styles.rzHandle }}\n      enable={{\n        top: true,\n        right: false,\n        bottom: false,\n        left: false,\n        topRight: false,\n        bottomRight: false,\n        bottomLeft: false,\n        topLeft: false,\n      }}\n      maxHeight=\"100vh\"\n      maxWidth={drawerWidth}\n      minWidth={drawerWidth}\n      onResize={onResize}\n    >\n      {children}\n    </Resizable>\n  );\n}\n","// Libraries\nimport React, { useState } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\n// Services & Utils\nimport store from 'app/core/store';\nimport { RICH_HISTORY_SETTING_KEYS } from 'app/core/utils/richHistory';\n\n// Types\nimport { ExploreItemState, StoreState } from 'app/types';\nimport { ExploreId } from 'app/types/explore';\n\n// Components, enums\nimport { RichHistory, Tabs } from './RichHistory';\n\n//Actions\nimport { deleteRichHistory } from '../state/history';\nimport { ExploreDrawer } from '../ExploreDrawer';\n\nfunction mapStateToProps(state: StoreState, { exploreId }: { exploreId: ExploreId }) {\n  const explore = state.explore;\n  // @ts-ignore\n  const item: ExploreItemState = explore[exploreId];\n  const { datasourceInstance } = item;\n  const firstTab = store.getBool(RICH_HISTORY_SETTING_KEYS.starredTabAsFirstTab, false)\n    ? Tabs.Starred\n    : Tabs.RichHistory;\n  const { richHistory } = explore;\n  return {\n    richHistory,\n    firstTab,\n    activeDatasourceInstance: datasourceInstance?.name,\n  };\n}\n\nconst mapDispatchToProps = {\n  deleteRichHistory,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ninterface OwnProps {\n  width: number;\n  exploreId: ExploreId;\n  onClose: () => void;\n}\nexport type Props = ConnectedProps<typeof connector> & OwnProps;\n\nexport function RichHistoryContainer(props: Props) {\n  const [height, setHeight] = useState(400);\n\n  const { richHistory, width, firstTab, activeDatasourceInstance, exploreId, deleteRichHistory, onClose } = props;\n\n  return (\n    <ExploreDrawer\n      width={width}\n      onResize={(_e, _dir, ref) => {\n        setHeight(Number(ref.style.height.slice(0, -2)));\n      }}\n    >\n      <RichHistory\n        richHistory={richHistory}\n        firstTab={firstTab}\n        activeDatasourceInstance={activeDatasourceInstance}\n        exploreId={exploreId}\n        deleteRichHistory={deleteRichHistory}\n        onClose={onClose}\n        height={height}\n      />\n    </ExploreDrawer>\n  );\n}\n\nexport default connector(RichHistoryContainer);\n","import React from 'react';\nimport { TabbedContainer, TabConfig } from '@grafana/ui';\nimport { TimeZone } from '@grafana/data';\nimport { runQueries } from './state/query';\nimport { StoreState, ExploreItemState, ExploreId } from 'app/types';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { ExploreDrawer } from 'app/features/explore/ExploreDrawer';\nimport { InspectJSONTab } from 'app/features/inspector/InspectJSONTab';\nimport { QueryInspector } from 'app/features/inspector/QueryInspector';\nimport { InspectStatsTab } from 'app/features/inspector/InspectStatsTab';\nimport { InspectDataTab } from 'app/features/inspector/InspectDataTab';\nimport { InspectErrorTab } from 'app/features/inspector/InspectErrorTab';\n\ninterface DispatchProps {\n  width: number;\n  exploreId: ExploreId;\n  timeZone: TimeZone;\n  onClose: () => void;\n}\n\ntype Props = DispatchProps & ConnectedProps<typeof connector>;\n\nexport function ExploreQueryInspector(props: Props) {\n  const { loading, width, onClose, queryResponse, timeZone } = props;\n  const dataFrames = queryResponse?.series || [];\n  const error = queryResponse?.error;\n\n  const statsTab: TabConfig = {\n    label: 'Stats',\n    value: 'stats',\n    icon: 'chart-line',\n    content: <InspectStatsTab data={queryResponse!} timeZone={queryResponse?.request?.timezone as TimeZone} />,\n  };\n\n  const jsonTab: TabConfig = {\n    label: 'JSON',\n    value: 'json',\n    icon: 'brackets-curly',\n    content: <InspectJSONTab data={queryResponse} onClose={onClose} />,\n  };\n\n  const dataTab: TabConfig = {\n    label: 'Data',\n    value: 'data',\n    icon: 'database',\n    content: (\n      <InspectDataTab\n        data={dataFrames}\n        isLoading={loading}\n        options={{ withTransforms: false, withFieldConfig: false }}\n        timeZone={timeZone}\n      />\n    ),\n  };\n\n  const queryTab: TabConfig = {\n    label: 'Query',\n    value: 'query',\n    icon: 'info-circle',\n    content: <QueryInspector data={dataFrames} onRefreshQuery={() => props.runQueries(props.exploreId)} />,\n  };\n\n  const tabs = [statsTab, queryTab, jsonTab, dataTab];\n  if (error) {\n    const errorTab: TabConfig = {\n      label: 'Error',\n      value: 'error',\n      icon: 'exclamation-triangle',\n      content: <InspectErrorTab error={error} />,\n    };\n    tabs.push(errorTab);\n  }\n  return (\n    <ExploreDrawer width={width} onResize={() => {}}>\n      <TabbedContainer tabs={tabs} onClose={onClose} closeIconTooltip=\"Close query inspector\" />\n    </ExploreDrawer>\n  );\n}\n\nfunction mapStateToProps(state: StoreState, { exploreId }: { exploreId: ExploreId }) {\n  const explore = state.explore;\n  const item: ExploreItemState = explore[exploreId]!;\n  const { loading, queryResponse } = item;\n\n  return {\n    loading,\n    queryResponse,\n  };\n}\n\nconst mapDispatchToProps = {\n  runQueries,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport default connector(ExploreQueryInspector);\n","import React from 'react';\nimport { Tooltip, ToolbarButton } from '@grafana/ui';\n\ninterface TimeSyncButtonProps {\n  isSynced: boolean;\n  onClick: () => void;\n}\n\nexport function TimeSyncButton(props: TimeSyncButtonProps) {\n  const { onClick, isSynced } = props;\n\n  const syncTimesTooltip = () => {\n    const { isSynced } = props;\n    const tooltip = isSynced ? 'Unsync all views' : 'Sync all views to this time range';\n    return <>{tooltip}</>;\n  };\n\n  return (\n    <Tooltip content={syncTimesTooltip} placement=\"bottom\">\n      <ToolbarButton\n        icon=\"link\"\n        variant={isSynced ? 'active' : 'default'}\n        aria-label={isSynced ? 'Synced times' : 'Unsynced times'}\n        onClick={onClick}\n      />\n    </Tooltip>\n  );\n}\n","// Libaries\nimport React, { Component } from 'react';\n\n// Types\nimport { ExploreId } from 'app/types';\nimport { TimeRange, TimeZone, RawTimeRange, dateTimeForTimeZone, dateMath } from '@grafana/data';\n\n// State\n\n// Components\nimport { TimeSyncButton } from './TimeSyncButton';\nimport { TimePickerWithHistory } from 'app/core/components/TimePicker/TimePickerWithHistory';\n\n// Utils & Services\nimport { getShiftedTimeRange, getZoomedTimeRange } from 'app/core/utils/timePicker';\n\nexport interface Props {\n  exploreId: ExploreId;\n  hideText?: boolean;\n  range: TimeRange;\n  timeZone: TimeZone;\n  fiscalYearStartMonth: number;\n  splitted: boolean;\n  syncedTimes: boolean;\n  onChangeTimeSync: () => void;\n  onChangeTime: (range: RawTimeRange) => void;\n  onChangeTimeZone: (timeZone: TimeZone) => void;\n  onChangeFiscalYearStartMonth: (fiscalYearStartMonth: number) => void;\n}\n\nexport class ExploreTimeControls extends Component<Props> {\n  onMoveTimePicker = (direction: number) => {\n    const { range, onChangeTime, timeZone } = this.props;\n    const { from, to } = getShiftedTimeRange(direction, range);\n    const nextTimeRange = {\n      from: dateTimeForTimeZone(timeZone, from),\n      to: dateTimeForTimeZone(timeZone, to),\n    };\n\n    onChangeTime(nextTimeRange);\n  };\n\n  onMoveForward = () => this.onMoveTimePicker(1);\n  onMoveBack = () => this.onMoveTimePicker(-1);\n\n  onChangeTimePicker = (timeRange: TimeRange) => {\n    const adjustedFrom = dateMath.isMathString(timeRange.raw.from) ? timeRange.raw.from : timeRange.from;\n    const adjustedTo = dateMath.isMathString(timeRange.raw.to) ? timeRange.raw.to : timeRange.to;\n\n    this.props.onChangeTime({\n      from: adjustedFrom,\n      to: adjustedTo,\n    });\n  };\n\n  onZoom = () => {\n    const { range, onChangeTime, timeZone } = this.props;\n    const { from, to } = getZoomedTimeRange(range, 2);\n    const nextTimeRange = {\n      from: dateTimeForTimeZone(timeZone, from),\n      to: dateTimeForTimeZone(timeZone, to),\n    };\n\n    onChangeTime(nextTimeRange);\n  };\n\n  render() {\n    const {\n      range,\n      timeZone,\n      fiscalYearStartMonth,\n      splitted,\n      syncedTimes,\n      onChangeTimeSync,\n      hideText,\n      onChangeTimeZone,\n      onChangeFiscalYearStartMonth,\n    } = this.props;\n    const timeSyncButton = splitted ? <TimeSyncButton onClick={onChangeTimeSync} isSynced={syncedTimes} /> : undefined;\n    const timePickerCommonProps = {\n      value: range,\n      timeZone,\n      fiscalYearStartMonth,\n      onMoveBackward: this.onMoveBack,\n      onMoveForward: this.onMoveForward,\n      onZoom: this.onZoom,\n      hideText,\n    };\n\n    return (\n      <TimePickerWithHistory\n        {...timePickerCommonProps}\n        timeSyncButton={timeSyncButton}\n        isSynced={syncedTimes}\n        onChange={this.onChangeTimePicker}\n        onChangeTimeZone={onChangeTimeZone}\n        onChangeFiscalYearStartMonth={onChangeFiscalYearStartMonth}\n      />\n    );\n  }\n}\n","import React from 'react';\nimport { css } from '@emotion/css';\nimport { CSSTransition } from 'react-transition-group';\nimport { Tooltip, ButtonGroup, ToolbarButton } from '@grafana/ui';\n\ntype LiveTailButtonProps = {\n  splitted: boolean;\n  start: () => void;\n  stop: () => void;\n  pause: () => void;\n  resume: () => void;\n  isLive: boolean;\n  isPaused: boolean;\n};\n\nexport function LiveTailButton(props: LiveTailButtonProps) {\n  const { start, pause, resume, isLive, isPaused, stop, splitted } = props;\n  const buttonVariant = isLive && !isPaused ? 'active' : 'default';\n  const onClickMain = isLive ? (isPaused ? resume : pause) : start;\n\n  return (\n    <ButtonGroup>\n      <Tooltip\n        content={isLive && !isPaused ? <>Pause the live stream</> : <>Start live stream your logs</>}\n        placement=\"bottom\"\n      >\n        <ToolbarButton\n          iconOnly={splitted}\n          variant={buttonVariant}\n          icon={!isLive || isPaused ? 'play' : 'pause'}\n          onClick={onClickMain}\n        >\n          {isLive && isPaused ? 'Paused' : 'Live'}\n        </ToolbarButton>\n      </Tooltip>\n\n      <CSSTransition\n        mountOnEnter={true}\n        unmountOnExit={true}\n        timeout={100}\n        in={isLive}\n        classNames={{\n          enter: styles.stopButtonEnter,\n          enterActive: styles.stopButtonEnterActive,\n          exit: styles.stopButtonExit,\n          exitActive: styles.stopButtonExitActive,\n        }}\n      >\n        <Tooltip content={<>Stop and exit the live stream</>} placement=\"bottom\">\n          <ToolbarButton variant={buttonVariant} onClick={stop} icon=\"square-shape\" />\n        </Tooltip>\n      </CSSTransition>\n    </ButtonGroup>\n  );\n}\n\nconst styles = {\n  stopButtonEnter: css`\n    label: stopButtonEnter;\n    width: 0;\n    opacity: 0;\n    overflow: hidden;\n  `,\n  stopButtonEnterActive: css`\n    label: stopButtonEnterActive;\n    opacity: 1;\n    width: 32px;\n  `,\n  stopButtonExit: css`\n    label: stopButtonExit;\n    width: 32px;\n    opacity: 1;\n    overflow: hidden;\n  `,\n  stopButtonExitActive: css`\n    label: stopButtonExitActive;\n    opacity: 0;\n    width: 0;\n  `,\n};\n","import React from 'react';\nimport { RefreshPicker, defaultIntervals } from '@grafana/ui';\nimport { getTimeSrv } from 'app/features/dashboard/services/TimeSrv';\n\nexport type Props = {\n  isSmall?: boolean;\n  loading: boolean;\n  isLive: boolean;\n  onRun: (loading: boolean) => void;\n  refreshInterval?: string;\n  onChangeRefreshInterval: (interval: string) => void;\n  showDropdown: boolean;\n};\n\nexport function RunButton(props: Props) {\n  const { isSmall, loading, onRun, onChangeRefreshInterval, refreshInterval, showDropdown, isLive } = props;\n  const intervals = getTimeSrv().getValidIntervals(defaultIntervals);\n  let text: string | undefined = loading ? 'Cancel' : 'Run query';\n  let width = '108px';\n\n  if (isLive) {\n    return null;\n  }\n\n  if (isSmall) {\n    text = undefined;\n    width = '35px';\n  }\n\n  return (\n    <RefreshPicker\n      onIntervalChanged={onChangeRefreshInterval}\n      value={refreshInterval}\n      isLoading={loading}\n      text={text}\n      intervals={intervals}\n      isLive={isLive}\n      onRefresh={() => onRun(loading)}\n      noIntervalPicker={!showDropdown}\n      primary={true}\n      width={width}\n    />\n  );\n}\n","import React, { FC } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { ButtonGroup, ButtonSelect, Icon, ToolbarButton, Tooltip } from '@grafana/ui';\nimport { DataQuery, urlUtil } from '@grafana/data';\n\nimport kbn from '../../core/utils/kbn';\nimport config from 'app/core/config';\nimport { getDashboardSrv } from '../dashboard/services/DashboardSrv';\nimport { StoreState } from 'app/types';\nimport { ExploreId } from 'app/types/explore';\nimport { setDashboardQueriesToUpdateOnLoad } from '../dashboard/state/reducers';\nimport { isSplit } from './state/selectors';\nimport { locationService } from '@grafana/runtime';\nimport { contextSrv } from 'app/core/services/context_srv';\n\nfunction mapStateToProps(state: StoreState, { exploreId }: { exploreId: ExploreId }) {\n  const explore = state.explore;\n  const splitted = isSplit(state);\n  const { datasourceInstance, queries, originPanelId } = explore[exploreId]!;\n\n  const roles = ['Editor', 'Admin'];\n  if (config.viewersCanEdit) {\n    roles.push('Viewer');\n  }\n\n  return {\n    exploreId,\n    datasourceInstance,\n    queries,\n    originPanelId,\n    splitted,\n    canEdit: roles.some((r) => contextSrv.hasRole(r)),\n  };\n}\n\nconst mapDispatchToProps = {\n  setDashboardQueriesToUpdateOnLoad,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype Props = ConnectedProps<typeof connector>;\n\nexport const UnconnectedReturnToDashboardButton: FC<Props> = ({\n  originPanelId,\n  setDashboardQueriesToUpdateOnLoad,\n  queries,\n  splitted,\n  canEdit,\n}) => {\n  const withOriginId = originPanelId && Number.isInteger(originPanelId);\n\n  // If in split mode, or no origin id, escape early and return null\n  if (splitted || !withOriginId) {\n    return null;\n  }\n\n  const cleanQueries = (queries: DataQuery[]) => {\n    return queries.map((query: DataQuery & { context?: string }) => {\n      delete query.context;\n      delete query.key;\n      return query;\n    });\n  };\n\n  const returnToPanel = async ({ withChanges = false } = {}) => {\n    const dashboardSrv = getDashboardSrv();\n    const dash = dashboardSrv.getCurrent();\n    if (!dash) {\n      return;\n    }\n\n    const titleSlug = kbn.slugifyForUrl(dash.title);\n\n    if (withChanges) {\n      setDashboardQueriesToUpdateOnLoad({\n        panelId: originPanelId!,\n        queries: cleanQueries(queries),\n      });\n    }\n\n    const query: any = {};\n\n    if (withChanges || dash.panelInEdit) {\n      query.editPanel = originPanelId;\n    } else if (dash.panelInView) {\n      query.viewPanel = originPanelId;\n    }\n\n    locationService.push(urlUtil.renderUrl(`/d/${dash.uid}/:${titleSlug}`, query));\n  };\n\n  return (\n    <ButtonGroup>\n      <Tooltip content={'Return to panel'} placement=\"bottom\">\n        <ToolbarButton data-testid=\"returnButton\" title={'Return to panel'} onClick={() => returnToPanel()}>\n          <Icon name=\"arrow-left\" />\n        </ToolbarButton>\n      </Tooltip>\n      {canEdit && (\n        <ButtonSelect\n          data-testid=\"returnButtonWithChanges\"\n          options={[{ label: 'Return to panel with changes', value: '' }]}\n          onChange={() => returnToPanel({ withChanges: true })}\n        />\n      )}\n    </ButtonGroup>\n  );\n};\n\nexport default connector(UnconnectedReturnToDashboardButton);\n","import React, { PureComponent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { ExploreId, ExploreItemState } from 'app/types/explore';\nimport { PageToolbar, SetInterval, ToolbarButton, ToolbarButtonRow } from '@grafana/ui';\nimport { DataSourceInstanceSettings, RawTimeRange } from '@grafana/data';\nimport { DataSourcePicker } from '@grafana/runtime';\nimport { StoreState } from 'app/types/store';\nimport { createAndCopyShortLink } from 'app/core/utils/shortLinks';\nimport { changeDatasource } from './state/datasource';\nimport { splitClose, splitOpen } from './state/main';\nimport { syncTimes, changeRefreshInterval } from './state/time';\nimport { getFiscalYearStartMonth, getTimeZone } from '../profile/state/selectors';\nimport { updateFiscalYearStartMonthForSession, updateTimeZoneForSession } from '../profile/state/reducers';\nimport { ExploreTimeControls } from './ExploreTimeControls';\nimport { LiveTailButton } from './LiveTailButton';\nimport { RunButton } from './RunButton';\nimport { LiveTailControls } from './useLiveTailControls';\nimport { cancelQueries, runQueries } from './state/query';\nimport ReturnToDashboardButton from './ReturnToDashboardButton';\nimport { isSplit } from './state/selectors';\nimport { DashNavButton } from '../dashboard/components/DashNav/DashNavButton';\n\ninterface OwnProps {\n  exploreId: ExploreId;\n  onChangeTime: (range: RawTimeRange, changedByScanner?: boolean) => void;\n}\n\ntype Props = OwnProps & ConnectedProps<typeof connector>;\n\nclass UnConnectedExploreToolbar extends PureComponent<Props> {\n  onChangeDatasource = async (dsSettings: DataSourceInstanceSettings) => {\n    this.props.changeDatasource(this.props.exploreId, dsSettings.uid, { importQueries: true });\n  };\n\n  onRunQuery = (loading = false) => {\n    const { runQueries, cancelQueries, exploreId } = this.props;\n    if (loading) {\n      return cancelQueries(exploreId);\n    } else {\n      return runQueries(exploreId);\n    }\n  };\n\n  onChangeRefreshInterval = (item: string) => {\n    const { changeRefreshInterval, exploreId } = this.props;\n    changeRefreshInterval(exploreId, item);\n  };\n\n  onChangeTimeSync = () => {\n    const { syncTimes, exploreId } = this.props;\n    syncTimes(exploreId);\n  };\n\n  render() {\n    const {\n      datasourceMissing,\n      closeSplit,\n      exploreId,\n      loading,\n      range,\n      timeZone,\n      fiscalYearStartMonth,\n      splitted,\n      syncedTimes,\n      refreshInterval,\n      onChangeTime,\n      split,\n      hasLiveOption,\n      isLive,\n      isPaused,\n      containerWidth,\n      onChangeTimeZone,\n      onChangeFiscalYearStartMonth,\n    } = this.props;\n\n    const showSmallDataSourcePicker = (splitted ? containerWidth < 700 : containerWidth < 800) || false;\n    const showSmallTimePicker = splitted || containerWidth < 1210;\n\n    return (\n      <PageToolbar\n        title={exploreId === ExploreId.left ? 'Explore' : undefined}\n        pageIcon={exploreId === ExploreId.left ? 'compass' : undefined}\n        leftItems={[\n          exploreId === ExploreId.left && (\n            <DashNavButton\n              key=\"share\"\n              tooltip=\"Copy shortened link\"\n              icon=\"share-alt\"\n              onClick={() => createAndCopyShortLink(window.location.href)}\n              aria-label=\"Copy shortened link\"\n            />\n          ),\n          !datasourceMissing && (\n            <DataSourcePicker\n              key={`${exploreId}-ds-picker`}\n              onChange={this.onChangeDatasource}\n              current={this.props.datasourceName}\n              hideTextValue={showSmallDataSourcePicker}\n              width={showSmallDataSourcePicker ? 8 : undefined}\n            />\n          ),\n        ].filter(Boolean)}\n      >\n        <ToolbarButtonRow>\n          <ReturnToDashboardButton exploreId={exploreId} />\n\n          {!splitted ? (\n            <ToolbarButton title=\"Split\" onClick={() => split()} icon=\"columns\" disabled={isLive}>\n              Split\n            </ToolbarButton>\n          ) : (\n            <ToolbarButton title=\"Close split pane\" onClick={() => closeSplit(exploreId)} icon=\"times\">\n              Close\n            </ToolbarButton>\n          )}\n\n          {!isLive && (\n            <ExploreTimeControls\n              exploreId={exploreId}\n              range={range}\n              timeZone={timeZone}\n              fiscalYearStartMonth={fiscalYearStartMonth}\n              onChangeTime={onChangeTime}\n              splitted={splitted}\n              syncedTimes={syncedTimes}\n              onChangeTimeSync={this.onChangeTimeSync}\n              hideText={showSmallTimePicker}\n              onChangeTimeZone={onChangeTimeZone}\n              onChangeFiscalYearStartMonth={onChangeFiscalYearStartMonth}\n            />\n          )}\n\n          <RunButton\n            refreshInterval={refreshInterval}\n            onChangeRefreshInterval={this.onChangeRefreshInterval}\n            isSmall={splitted || showSmallTimePicker}\n            isLive={isLive}\n            loading={loading || (isLive && !isPaused)}\n            onRun={this.onRunQuery}\n            showDropdown={!isLive}\n          />\n\n          {refreshInterval && <SetInterval func={this.onRunQuery} interval={refreshInterval} loading={loading} />}\n\n          {hasLiveOption && (\n            <LiveTailControls exploreId={exploreId}>\n              {(controls) => (\n                <LiveTailButton\n                  splitted={splitted}\n                  isLive={isLive}\n                  isPaused={isPaused}\n                  start={controls.start}\n                  pause={controls.pause}\n                  resume={controls.resume}\n                  stop={controls.stop}\n                />\n              )}\n            </LiveTailControls>\n          )}\n        </ToolbarButtonRow>\n      </PageToolbar>\n    );\n  }\n}\n\nconst mapStateToProps = (state: StoreState, { exploreId }: OwnProps) => {\n  const { syncedTimes } = state.explore;\n  const exploreItem: ExploreItemState = state.explore[exploreId]!;\n  const {\n    datasourceInstance,\n    datasourceMissing,\n    range,\n    refreshInterval,\n    loading,\n    isLive,\n    isPaused,\n    containerWidth,\n  } = exploreItem;\n\n  const hasLiveOption = !!datasourceInstance?.meta?.streaming;\n\n  return {\n    datasourceMissing,\n    datasourceName: datasourceInstance?.name,\n    loading,\n    range,\n    timeZone: getTimeZone(state.user),\n    fiscalYearStartMonth: getFiscalYearStartMonth(state.user),\n    splitted: isSplit(state),\n    refreshInterval,\n    hasLiveOption,\n    isLive,\n    isPaused,\n    syncedTimes,\n    containerWidth,\n  };\n};\n\nconst mapDispatchToProps = {\n  changeDatasource,\n  changeRefreshInterval,\n  cancelQueries,\n  runQueries,\n  closeSplit: splitClose,\n  split: splitOpen,\n  syncTimes,\n  onChangeTimeZone: updateTimeZoneForSession,\n  onChangeFiscalYearStartMonth: updateFiscalYearStartMonthForSession,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport const ExploreToolbar = connector(UnConnectedExploreToolbar);\n","import React from 'react';\nimport { css } from '@emotion/css';\nimport { LinkButton, CallToActionCard, Icon, useTheme2 } from '@grafana/ui';\n\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction } from 'app/types';\n\nexport const NoDataSourceCallToAction = () => {\n  const theme = useTheme2();\n\n  const canCreateDataSource =\n    contextSrv.hasPermission(AccessControlAction.DataSourcesCreate) &&\n    contextSrv.hasPermission(AccessControlAction.DataSourcesWrite);\n\n  const message =\n    'Explore requires at least one data source. Once you have added a data source, you can query it here.';\n  const footer = (\n    <>\n      <Icon name=\"rocket\" />\n      <> ProTip: You can also define data sources through configuration files. </>\n      <a\n        href=\"http://docs.grafana.org/administration/provisioning/#datasources?utm_source=explore\"\n        target=\"_blank\"\n        rel=\"noreferrer\"\n        className=\"text-link\"\n      >\n        Learn more\n      </a>\n    </>\n  );\n\n  const ctaElement = (\n    <LinkButton size=\"lg\" href=\"datasources/new\" icon=\"database\" disabled={!canCreateDataSource}>\n      Add data source\n    </LinkButton>\n  );\n\n  const cardClassName = css`\n    max-width: ${theme.breakpoints.values.lg}px;\n    margin-top: ${theme.spacing(2)};\n    align-self: center;\n  `;\n\n  return (\n    <CallToActionCard callToActionElement={ctaElement} className={cardClassName} footer={footer} message={message} />\n  );\n};\n","import React from 'react';\nimport { css, cx } from '@emotion/css';\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, HorizontalGroup, useTheme2 } from '@grafana/ui';\n\ntype Props = {\n  addQueryRowButtonDisabled?: boolean;\n  addQueryRowButtonHidden?: boolean;\n  richHistoryButtonActive?: boolean;\n  queryInspectorButtonActive?: boolean;\n\n  onClickAddQueryRowButton: () => void;\n  onClickRichHistoryButton: () => void;\n  onClickQueryInspectorButton: () => void;\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    containerMargin: css`\n      margin-top: ${theme.spacing(2)};\n    `,\n  };\n};\nexport function SecondaryActions(props: Props) {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n  return (\n    <div className={styles.containerMargin}>\n      <HorizontalGroup>\n        {!props.addQueryRowButtonHidden && (\n          <Button\n            variant=\"secondary\"\n            aria-label=\"Add row button\"\n            onClick={props.onClickAddQueryRowButton}\n            disabled={props.addQueryRowButtonDisabled}\n            icon=\"plus\"\n          >\n            Add query\n          </Button>\n        )}\n        <Button\n          variant=\"secondary\"\n          aria-label=\"Rich history button\"\n          className={cx({ ['explore-active-button']: props.richHistoryButtonActive })}\n          onClick={props.onClickRichHistoryButton}\n          icon=\"history\"\n        >\n          Query history\n        </Button>\n        <Button\n          variant=\"secondary\"\n          aria-label=\"Query inspector button\"\n          className={cx({ ['explore-active-button']: props.queryInspectorButtonActive })}\n          onClick={props.onClickQueryInspectorButton}\n          icon=\"info-circle\"\n        >\n          Inspector\n        </Button>\n      </HorizontalGroup>\n    </div>\n  );\n}\n","import React from 'react';\nimport { useToggle } from 'react-use';\nimport { Badge, Collapse, useStyles2, useTheme2 } from '@grafana/ui';\nimport { applyFieldOverrides, DataFrame, GrafanaTheme2 } from '@grafana/data';\nimport { css } from '@emotion/css';\nimport { ExploreId, StoreState } from '../../types';\nimport { splitOpen } from './state/main';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { useLinks } from './utils/links';\nimport { NodeGraph } from '../../plugins/panel/nodeGraph';\nimport { useCategorizeFrames } from '../../plugins/panel/nodeGraph/useCategorizeFrames';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  warningText: css`\n    label: warningText;\n    font-size: ${theme.typography.bodySmall.fontSize};\n    color: ${theme.colors.text.secondary};\n  `,\n});\n\ninterface OwnProps {\n  // Edges and Nodes are separate frames\n  dataFrames: DataFrame[];\n  exploreId: ExploreId;\n  // When showing the node graph together with trace view we do some changes so it works better.\n  withTraceView?: boolean;\n}\n\ntype Props = OwnProps & ConnectedProps<typeof connector>;\n\nexport function UnconnectedNodeGraphContainer(props: Props) {\n  const { dataFrames, range, splitOpen, withTraceView } = props;\n  const getLinks = useLinks(range, splitOpen);\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n\n  // This is implicit dependency that is needed for links to work. At some point when replacing variables in the link\n  // it requires field to have a display property which is added by the overrides even though we don't add any field\n  // overrides in explore.\n  const frames = applyFieldOverrides({\n    fieldConfig: {\n      defaults: {},\n      overrides: [],\n    },\n    data: dataFrames,\n    // We don't need proper replace here as it is only used in getLinks and we use getFieldLinks\n    replaceVariables: (value) => value,\n    theme,\n  });\n\n  const { nodes } = useCategorizeFrames(frames);\n  const [open, toggleOpen] = useToggle(false);\n\n  const countWarning =\n    withTraceView && nodes[0]?.length > 1000 ? (\n      <span className={styles.warningText}> ({nodes[0].length} nodes, can be slow to load)</span>\n    ) : null;\n\n  return (\n    <Collapse\n      label={\n        <span>\n          Node graph{countWarning}{' '}\n          <Badge text={'Beta'} color={'blue'} icon={'rocket'} tooltip={'This visualization is in beta'} />\n        </span>\n      }\n      collapsible={withTraceView}\n      // We allow collapsing this only when it is shown together with trace view.\n      isOpen={withTraceView ? open : true}\n      onToggle={withTraceView ? () => toggleOpen() : undefined}\n    >\n      <div style={{ height: withTraceView ? 500 : 600 }}>\n        <NodeGraph dataFrames={frames} getLinks={getLinks} />\n      </div>\n    </Collapse>\n  );\n}\n\nfunction mapStateToProps(state: StoreState, { exploreId }: OwnProps) {\n  return {\n    range: state.explore[exploreId]!.range,\n  };\n}\n\nconst mapDispatchToProps = {\n  splitOpen,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\nexport const NodeGraphContainer = connector(UnconnectedNodeGraphContainer);\n","import React, { FC, CSSProperties } from 'react';\nimport Transition, { ExitHandler } from 'react-transition-group/Transition';\n\ninterface Props {\n  duration: number;\n  children: JSX.Element;\n  in: boolean;\n  unmountOnExit?: boolean;\n  onExited?: ExitHandler<HTMLDivElement>;\n}\n\nexport const FadeIn: FC<Props> = (props) => {\n  const defaultStyle: CSSProperties = {\n    transition: `opacity ${props.duration}ms linear`,\n    opacity: 0,\n  };\n\n  const transitionStyles: { [str: string]: CSSProperties } = {\n    exited: { opacity: 0, display: 'none' },\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n    exiting: { opacity: 0 },\n  };\n\n  return (\n    <Transition\n      in={props.in}\n      timeout={props.duration}\n      unmountOnExit={props.unmountOnExit || false}\n      onExited={props.onExited}\n    >\n      {(state) => (\n        <div\n          style={{\n            ...defaultStyle,\n            ...transitionStyles[state],\n          }}\n        >\n          {props.children}\n        </div>\n      )}\n    </Transition>\n  );\n};\n","import React, { FunctionComponent } from 'react';\nimport { DataQueryError } from '@grafana/data';\nimport { Alert, useTheme2 } from '@grafana/ui';\nimport { FadeIn } from 'app/core/components/Animations/FadeIn';\nimport { css } from '@emotion/css';\n\nexport interface ErrorContainerProps {\n  queryError?: DataQueryError;\n}\n\nexport const ErrorContainer: FunctionComponent<ErrorContainerProps> = (props) => {\n  const { queryError } = props;\n  const theme = useTheme2();\n  const showError = queryError ? true : false;\n  const duration = showError ? 100 : 10;\n  const title = queryError ? 'Query error' : 'Unknown error';\n  const message = queryError?.message || queryError?.data?.message || null;\n  const alertWithTopMargin = css`\n    margin-top: ${theme.spacing(2)};\n  `;\n\n  return (\n    <FadeIn in={showError} duration={duration}>\n      <Alert severity=\"error\" title={title} className={alertWithTopMargin}>\n        {message}\n      </Alert>\n    </FadeIn>\n  );\n};\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { ExploreId, StoreState } from '../../types';\nimport { LoadingState } from '@grafana/data';\nimport { ErrorContainer } from './ErrorContainer';\n\ninterface Props {\n  exploreId: ExploreId;\n}\nexport function ResponseErrorContainer(props: Props) {\n  const queryResponse = useSelector((state: StoreState) => state.explore[props.exploreId]?.queryResponse);\n\n  const queryError = queryResponse?.state === LoadingState.Error ? queryResponse?.error : undefined;\n\n  return <ErrorContainer queryError={queryError} />;\n}\n","import {\n  DataFrame,\n  DataLink,\n  dateTime,\n  Field,\n  mapInternalLinkToExplore,\n  rangeUtil,\n  SplitOpen,\n  TimeRange,\n} from '@grafana/data';\nimport { getTemplateSrv } from '@grafana/runtime';\nimport { Icon } from '@grafana/ui';\nimport { SpanLinkDef, SpanLinkFunc, TraceSpan } from '@jaegertracing/jaeger-ui-components';\nimport { TraceToLogsOptions } from 'app/core/components/TraceToLogsSettings';\nimport { getDatasourceSrv } from 'app/features/plugins/datasource_srv';\nimport React from 'react';\nimport { LokiQuery } from '../../../plugins/datasource/loki/types';\nimport { getFieldLinksForExplore } from '../utils/links';\n\n/**\n * This is a factory for the link creator. It returns the function mainly so it can return undefined in which case\n * the trace view won't create any links and to capture the datasource and split function making it easier to memoize\n * with useMemo.\n */\nexport function createSpanLinkFactory({\n  splitOpenFn,\n  traceToLogsOptions,\n  dataFrame,\n}: {\n  splitOpenFn: SplitOpen;\n  traceToLogsOptions?: TraceToLogsOptions;\n  dataFrame?: DataFrame;\n}): SpanLinkFunc | undefined {\n  if (!dataFrame || dataFrame.fields.length === 1 || !dataFrame.fields.some((f) => Boolean(f.config.links?.length))) {\n    // if the dataframe contains just a single blob of data (legacy format) or does not have any links configured,\n    // let's try to use the old legacy path.\n    return legacyCreateSpanLinkFactory(splitOpenFn, traceToLogsOptions);\n  } else {\n    return function (span: TraceSpan): SpanLinkDef | undefined {\n      // We should be here only if there are some links in the dataframe\n      const field = dataFrame.fields.find((f) => Boolean(f.config.links?.length))!;\n      try {\n        const links = getFieldLinksForExplore({\n          field,\n          rowIndex: span.dataFrameRowIndex!,\n          splitOpenFn,\n          range: getTimeRangeFromSpan(span),\n          dataFrame,\n        });\n\n        return {\n          href: links[0].href,\n          onClick: links[0].onClick,\n          content: <Icon name=\"gf-logs\" title=\"Explore the logs for this in split view\" />,\n        };\n      } catch (error) {\n        // It's fairly easy to crash here for example if data source defines wrong interpolation in the data link\n        console.error(error);\n        return undefined;\n      }\n    };\n  }\n}\n\nfunction legacyCreateSpanLinkFactory(splitOpenFn: SplitOpen, traceToLogsOptions?: TraceToLogsOptions) {\n  // We should return if dataSourceUid is undefined otherwise getInstanceSettings would return testDataSource.\n  if (!traceToLogsOptions?.datasourceUid) {\n    return undefined;\n  }\n\n  const dataSourceSettings = getDatasourceSrv().getInstanceSettings(traceToLogsOptions.datasourceUid);\n\n  if (!dataSourceSettings) {\n    return undefined;\n  }\n\n  return function (span: TraceSpan): SpanLinkDef {\n    // This is reusing existing code from derived fields which may not be ideal match so some data is a bit faked at\n    // the moment. Issue is that the trace itself isn't clearly mapped to dataFrame (right now it's just a json blob\n    // inside a single field) so the dataLinks as config of that dataFrame abstraction breaks down a bit and we do\n    // it manually here instead of leaving it for the data source to supply the config.\n\n    const dataLink: DataLink<LokiQuery> = {\n      title: dataSourceSettings.name,\n      url: '',\n      internal: {\n        datasourceUid: dataSourceSettings.uid,\n        datasourceName: dataSourceSettings.name,\n        query: {\n          expr: getLokiQueryFromSpan(span, traceToLogsOptions),\n          refId: '',\n        },\n      },\n    };\n\n    const link = mapInternalLinkToExplore({\n      link: dataLink,\n      internalLink: dataLink.internal!,\n      scopedVars: {},\n      range: getTimeRangeFromSpan(span, {\n        startMs: traceToLogsOptions.spanStartTimeShift\n          ? rangeUtil.intervalToMs(traceToLogsOptions.spanStartTimeShift)\n          : 0,\n        endMs: traceToLogsOptions.spanEndTimeShift ? rangeUtil.intervalToMs(traceToLogsOptions.spanEndTimeShift) : 0,\n      }),\n      field: {} as Field,\n      onClickFn: splitOpenFn,\n      replaceVariables: getTemplateSrv().replace.bind(getTemplateSrv()),\n    });\n\n    return {\n      href: link.href,\n      onClick: link.onClick,\n      content: <Icon name=\"gf-logs\" title=\"Explore the logs for this in split view\" />,\n    };\n  };\n}\n\n/**\n * Default keys to use when there are no configured tags.\n */\nconst defaultKeys = ['cluster', 'hostname', 'namespace', 'pod'];\n\nfunction getLokiQueryFromSpan(span: TraceSpan, options: TraceToLogsOptions): string {\n  const { tags: keys, filterByTraceID, filterBySpanID } = options;\n  const keysToCheck = keys?.length ? keys : defaultKeys;\n  const tags = [...span.process.tags, ...span.tags].reduce((acc, tag) => {\n    if (keysToCheck.includes(tag.key)) {\n      acc.push(`${tag.key}=\"${tag.value}\"`);\n    }\n    return acc;\n  }, [] as string[]);\n\n  let query = `{${tags.join(', ')}}`;\n\n  if (filterByTraceID && span.traceID) {\n    query += ` |=\"${span.traceID}\"`;\n  }\n  if (filterBySpanID && span.spanID) {\n    query += ` |=\"${span.spanID}\"`;\n  }\n\n  return query;\n}\n\n/**\n * Gets a time range from the span.\n */\nfunction getTimeRangeFromSpan(\n  span: TraceSpan,\n  timeShift: { startMs: number; endMs: number } = { startMs: 0, endMs: 0 }\n): TimeRange {\n  const adjustedStartTime = Math.floor(span.startTime / 1000 + timeShift.startMs);\n  const from = dateTime(adjustedStartTime);\n  const spanEndMs = (span.startTime + span.duration) / 1000;\n  let adjustedEndTime = Math.floor(spanEndMs + timeShift.endMs);\n\n  // Because we can only pass milliseconds in the url we need to check if they equal.\n  // We need end time to be later than start time\n  if (adjustedStartTime === adjustedEndTime) {\n    adjustedEndTime++;\n  }\n  const to = dateTime(adjustedEndTime);\n\n  // Beware that public/app/features/explore/state/main.ts SplitOpen fn uses the range from here. No matter what is in the url.\n  return {\n    from,\n    to,\n    raw: {\n      from,\n      to,\n    },\n  };\n}\n","import { GrafanaTheme } from '@grafana/data';\nimport {\n  Button,\n  Input,\n  Popover,\n  PopoverController,\n  stylesFactory,\n  Tooltip as GrafanaTooltip,\n  useTheme,\n} from '@grafana/ui';\nimport { ButtonProps, Elements, PopoverProps, TooltipProps } from '@jaegertracing/jaeger-ui-components';\nimport cx from 'classnames';\nimport { css } from '@emotion/css';\nimport React, { useRef } from 'react';\n\n/**\n * Right now Jaeger components need some UI elements to be injected. This is to get rid of AntD UI library that was\n * used by default.\n */\n\n// This needs to be static to prevent remounting on every render.\nexport const UIElements: Elements = {\n  Popover({ children, content, overlayClassName }: PopoverProps) {\n    const popoverRef = useRef<HTMLElement>(null);\n\n    return (\n      <PopoverController content={content} hideAfter={300}>\n        {(showPopper, hidePopper, popperProps) => {\n          return (\n            <>\n              {popoverRef.current && (\n                <Popover\n                  {...popperProps}\n                  referenceElement={popoverRef.current}\n                  wrapperClassName={overlayClassName}\n                  onMouseLeave={hidePopper}\n                  onMouseEnter={showPopper}\n                />\n              )}\n\n              {React.cloneElement(children, {\n                ref: popoverRef,\n                onMouseEnter: showPopper,\n                onMouseLeave: hidePopper,\n              })}\n            </>\n          );\n        }}\n      </PopoverController>\n    );\n  },\n  Tooltip({ children, title }: TooltipProps) {\n    return <GrafanaTooltip content={title}>{children}</GrafanaTooltip>;\n  },\n  Icon: (() => null as any) as any,\n  Dropdown: (() => null as any) as any,\n  Menu: (() => null as any) as any,\n  MenuItem: (() => null as any) as any,\n  Button({ onClick, children, className }: ButtonProps) {\n    return (\n      <Button variant=\"secondary\" onClick={onClick} className={className}>\n        {children}\n      </Button>\n    );\n  },\n  Divider,\n  Input(props) {\n    return <Input {...props} />;\n  },\n  InputGroup({ children, className, style }) {\n    return (\n      <span className={className} style={style}>\n        {children}\n      </span>\n    );\n  },\n};\n\nconst getStyles = stylesFactory((theme: GrafanaTheme) => {\n  return {\n    Divider: css`\n      display: inline-block;\n      background: ${theme.isDark ? '#242424' : '#e8e8e8'};\n      width: 1px;\n      height: 0.9em;\n      margin: 0 8px;\n      vertical-align: middle;\n    `,\n  };\n});\n\nfunction Divider({ className }: { className?: string }) {\n  const styles = getStyles(useTheme());\n  return <div style={{}} className={cx(styles.Divider, className)} />;\n}\n","import { useCallback, useState } from 'react';\nimport { TraceSpan } from '@jaegertracing/jaeger-ui-components';\n\n/**\n * Children state means whether spans are collapsed or not. Also provides some functions to manipulate that state.\n */\nexport function useChildrenState() {\n  const [childrenHiddenIDs, setChildrenHiddenIDs] = useState(new Set<string>());\n\n  const expandOne = useCallback(\n    function expandOne(spans: TraceSpan[]) {\n      if (childrenHiddenIDs.size === 0) {\n        return;\n      }\n      let prevExpandedDepth = -1;\n      let expandNextHiddenSpan = true;\n      const newChildrenHiddenIDs = spans.reduce((res, s) => {\n        if (s.depth <= prevExpandedDepth) {\n          expandNextHiddenSpan = true;\n        }\n        if (expandNextHiddenSpan && res.has(s.spanID)) {\n          res.delete(s.spanID);\n          expandNextHiddenSpan = false;\n          prevExpandedDepth = s.depth;\n        }\n        return res;\n      }, new Set(childrenHiddenIDs));\n      setChildrenHiddenIDs(newChildrenHiddenIDs);\n    },\n    [childrenHiddenIDs]\n  );\n\n  const collapseOne = useCallback(\n    function collapseOne(spans: TraceSpan[]) {\n      if (shouldDisableCollapse(spans, childrenHiddenIDs)) {\n        return;\n      }\n      let nearestCollapsedAncestor: TraceSpan | undefined;\n      const newChildrenHiddenIDs = spans.reduce((res, curSpan) => {\n        if (nearestCollapsedAncestor && curSpan.depth <= nearestCollapsedAncestor.depth) {\n          res.add(nearestCollapsedAncestor.spanID);\n          if (curSpan.hasChildren) {\n            nearestCollapsedAncestor = curSpan;\n          }\n        } else if (curSpan.hasChildren && !res.has(curSpan.spanID)) {\n          nearestCollapsedAncestor = curSpan;\n        }\n        return res;\n      }, new Set(childrenHiddenIDs));\n      // The last one\n      if (nearestCollapsedAncestor) {\n        newChildrenHiddenIDs.add(nearestCollapsedAncestor.spanID);\n      }\n      setChildrenHiddenIDs(newChildrenHiddenIDs);\n    },\n    [childrenHiddenIDs]\n  );\n\n  const expandAll = useCallback(function expandAll() {\n    setChildrenHiddenIDs(new Set<string>());\n  }, []);\n\n  const collapseAll = useCallback(\n    function collapseAll(spans: TraceSpan[]) {\n      if (shouldDisableCollapse(spans, childrenHiddenIDs)) {\n        return;\n      }\n      const newChildrenHiddenIDs = spans.reduce((res, s) => {\n        if (s.hasChildren) {\n          res.add(s.spanID);\n        }\n        return res;\n      }, new Set<string>());\n\n      setChildrenHiddenIDs(newChildrenHiddenIDs);\n    },\n    [childrenHiddenIDs]\n  );\n\n  const childrenToggle = useCallback(\n    function childrenToggle(spanID: string) {\n      const newChildrenHiddenIDs = new Set(childrenHiddenIDs);\n      if (childrenHiddenIDs.has(spanID)) {\n        newChildrenHiddenIDs.delete(spanID);\n      } else {\n        newChildrenHiddenIDs.add(spanID);\n      }\n      setChildrenHiddenIDs(newChildrenHiddenIDs);\n    },\n    [childrenHiddenIDs]\n  );\n\n  return {\n    childrenHiddenIDs,\n    expandOne,\n    collapseOne,\n    expandAll,\n    collapseAll,\n    childrenToggle,\n  };\n}\n\nfunction shouldDisableCollapse(allSpans: TraceSpan[], hiddenSpansIds: Set<string>) {\n  const allParentSpans = allSpans.filter((s) => s.hasChildren);\n  return allParentSpans.length === hiddenSpansIds.size;\n}\n","import { useCallback, useState, useEffect } from 'react';\nimport { DataFrame } from '@grafana/data';\nimport { DetailState } from '@jaegertracing/jaeger-ui-components';\nimport { TraceLog } from '@jaegertracing/jaeger-ui-components/src/types/trace';\n\n/**\n * Keeps state of the span detail. This means whether span details are open but also state of each detail subitem\n * like logs or tags.\n */\nexport function useDetailState(frame: DataFrame) {\n  const [detailStates, setDetailStates] = useState(new Map<string, DetailState>());\n\n  // Clear detail state when new trace arrives\n  useEffect(() => {\n    setDetailStates(new Map<string, DetailState>());\n  }, [frame, setDetailStates]);\n\n  const toggleDetail = useCallback(\n    function toggleDetail(spanID: string) {\n      const newDetailStates = new Map(detailStates);\n      if (newDetailStates.has(spanID)) {\n        newDetailStates.delete(spanID);\n      } else {\n        newDetailStates.set(spanID, new DetailState());\n      }\n      setDetailStates(newDetailStates);\n    },\n    [detailStates]\n  );\n\n  const detailLogItemToggle = useCallback(\n    function detailLogItemToggle(spanID: string, log: TraceLog) {\n      const old = detailStates.get(spanID);\n      if (!old) {\n        return;\n      }\n      const detailState = old.toggleLogItem(log);\n      const newDetailStates = new Map(detailStates);\n      newDetailStates.set(spanID, detailState);\n      return setDetailStates(newDetailStates);\n    },\n    [detailStates]\n  );\n\n  return {\n    detailStates,\n    toggleDetail,\n    detailLogItemToggle,\n    detailLogsToggle: useCallback(\n      (spanID: string) => makeDetailSubsectionToggle('logs', detailStates, setDetailStates)(spanID),\n      [detailStates]\n    ),\n    detailWarningsToggle: useCallback(\n      (spanID: string) => makeDetailSubsectionToggle('warnings', detailStates, setDetailStates)(spanID),\n      [detailStates]\n    ),\n    detailStackTracesToggle: useCallback(\n      (spanID: string) => makeDetailSubsectionToggle('stackTraces', detailStates, setDetailStates)(spanID),\n      [detailStates]\n    ),\n    detailReferencesToggle: useCallback(\n      (spanID: string) => makeDetailSubsectionToggle('references', detailStates, setDetailStates)(spanID),\n      [detailStates]\n    ),\n    detailProcessToggle: useCallback(\n      (spanID: string) => makeDetailSubsectionToggle('process', detailStates, setDetailStates)(spanID),\n      [detailStates]\n    ),\n    detailTagsToggle: useCallback(\n      (spanID: string) => makeDetailSubsectionToggle('tags', detailStates, setDetailStates)(spanID),\n      [detailStates]\n    ),\n  };\n}\n\nfunction makeDetailSubsectionToggle(\n  subSection: 'tags' | 'process' | 'logs' | 'warnings' | 'references' | 'stackTraces',\n  detailStates: Map<string, DetailState>,\n  setDetailStates: (detailStates: Map<string, DetailState>) => void\n) {\n  return (spanID: string) => {\n    const old = detailStates.get(spanID);\n    if (!old) {\n      return;\n    }\n    let detailState;\n    if (subSection === 'tags') {\n      detailState = old.toggleTags();\n    } else if (subSection === 'process') {\n      detailState = old.toggleProcess();\n    } else if (subSection === 'warnings') {\n      detailState = old.toggleWarnings();\n    } else if (subSection === 'references') {\n      detailState = old.toggleReferences();\n    } else if (subSection === 'stackTraces') {\n      detailState = old.toggleStackTraces();\n    } else {\n      detailState = old.toggleLogs();\n    }\n    const newDetailStates = new Map(detailStates);\n    newDetailStates.set(spanID, detailState);\n    setDetailStates(newDetailStates);\n  };\n}\n","import { DataFrame, DataFrameView, SplitOpen, TraceSpanRow } from '@grafana/data';\nimport { colors, useTheme } from '@grafana/ui';\nimport {\n  ThemeOptions,\n  ThemeProvider,\n  ThemeType,\n  Trace,\n  TracePageHeader,\n  TraceProcess,\n  TraceResponse,\n  TraceTimelineViewer,\n  transformTraceData,\n  TTraceTimeline,\n  UIElementsContext,\n} from '@jaegertracing/jaeger-ui-components';\nimport { TraceToLogsData } from 'app/core/components/TraceToLogsSettings';\nimport { getDatasourceSrv } from 'app/features/plugins/datasource_srv';\nimport { getTimeZone } from 'app/features/profile/state/selectors';\nimport { StoreState } from 'app/types';\nimport { ExploreId } from 'app/types/explore';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { createSpanLinkFactory } from './createSpanLink';\nimport { UIElements } from './uiElements';\nimport { useChildrenState } from './useChildrenState';\nimport { useDetailState } from './useDetailState';\nimport { useHoverIndentGuide } from './useHoverIndentGuide';\nimport { useSearch } from './useSearch';\nimport { useViewRange } from './useViewRange';\n\nfunction noop(): {} {\n  return {};\n}\n\ntype Props = {\n  dataFrames: DataFrame[];\n  splitOpenFn: SplitOpen;\n  exploreId: ExploreId;\n  scrollElement?: Element;\n};\n\nexport function TraceView(props: Props) {\n  // At this point we only show single trace\n  const frame = props.dataFrames[0];\n\n  const { expandOne, collapseOne, childrenToggle, collapseAll, childrenHiddenIDs, expandAll } = useChildrenState();\n  const {\n    detailStates,\n    toggleDetail,\n    detailLogItemToggle,\n    detailLogsToggle,\n    detailProcessToggle,\n    detailReferencesToggle,\n    detailTagsToggle,\n    detailWarningsToggle,\n    detailStackTracesToggle,\n  } = useDetailState(frame);\n\n  const { removeHoverIndentGuideId, addHoverIndentGuideId, hoverIndentGuideIds } = useHoverIndentGuide();\n  const { viewRange, updateViewRangeTime, updateNextViewRangeTime } = useViewRange();\n\n  /**\n   * Keeps state of resizable name column width\n   */\n  const [spanNameColumnWidth, setSpanNameColumnWidth] = useState(0.25);\n  /**\n   * State of the top minimap, slim means it is collapsed.\n   */\n  const [slim, setSlim] = useState(false);\n\n  const traceProp = useMemo(() => transformDataFrames(frame), [frame]);\n  const { search, setSearch, spanFindMatches } = useSearch(traceProp?.spans);\n  const dataSourceName = useSelector((state: StoreState) => state.explore[props.exploreId]?.datasourceInstance?.name);\n  const traceToLogsOptions = (getDatasourceSrv().getInstanceSettings(dataSourceName)?.jsonData as TraceToLogsData)\n    ?.tracesToLogs;\n  const timeZone = useSelector((state: StoreState) => getTimeZone(state.user));\n\n  const theme = useTheme();\n  const traceTheme = useMemo(\n    () =>\n      ({\n        type: theme.isDark ? ThemeType.Dark : ThemeType.Light,\n        servicesColorPalette: colors,\n        components: {\n          TraceName: {\n            fontSize: theme.typography.size.lg,\n          },\n        },\n      } as ThemeOptions),\n    [theme]\n  );\n\n  const traceTimeline: TTraceTimeline = useMemo(\n    () => ({\n      childrenHiddenIDs,\n      detailStates,\n      hoverIndentGuideIds,\n      shouldScrollToFirstUiFindMatch: false,\n      spanNameColumnWidth,\n      traceID: traceProp?.traceID,\n    }),\n    [childrenHiddenIDs, detailStates, hoverIndentGuideIds, spanNameColumnWidth, traceProp?.traceID]\n  );\n\n  const createSpanLink = useMemo(\n    () => createSpanLinkFactory({ splitOpenFn: props.splitOpenFn, traceToLogsOptions, dataFrame: frame }),\n    [props.splitOpenFn, traceToLogsOptions, frame]\n  );\n  const onSlimViewClicked = useCallback(() => setSlim(!slim), [slim]);\n\n  if (!props.dataFrames?.length || !traceProp) {\n    return null;\n  }\n\n  return (\n    <ThemeProvider value={traceTheme}>\n      <UIElementsContext.Provider value={UIElements}>\n        <TracePageHeader\n          canCollapse={false}\n          clearSearch={noop}\n          focusUiFindMatches={noop}\n          hideMap={false}\n          hideSummary={false}\n          nextResult={noop}\n          onSlimViewClicked={onSlimViewClicked}\n          onTraceGraphViewClicked={noop}\n          prevResult={noop}\n          resultCount={0}\n          slimView={slim}\n          textFilter={null}\n          trace={traceProp}\n          traceGraphView={false}\n          updateNextViewRangeTime={updateNextViewRangeTime}\n          updateViewRangeTime={updateViewRangeTime}\n          viewRange={viewRange}\n          searchValue={search}\n          onSearchValueChange={setSearch}\n          hideSearchButtons={true}\n          timeZone={timeZone}\n        />\n        <TraceTimelineViewer\n          registerAccessors={noop}\n          scrollToFirstVisibleSpan={noop}\n          findMatchesIDs={spanFindMatches}\n          trace={traceProp}\n          traceTimeline={traceTimeline}\n          updateNextViewRangeTime={updateNextViewRangeTime}\n          updateViewRangeTime={updateViewRangeTime}\n          viewRange={viewRange}\n          focusSpan={noop}\n          createLinkToExternalSpan={noop as any}\n          setSpanNameColumnWidth={setSpanNameColumnWidth}\n          collapseAll={collapseAll}\n          collapseOne={collapseOne}\n          expandAll={expandAll}\n          expandOne={expandOne}\n          childrenToggle={childrenToggle}\n          clearShouldScrollToFirstUiFindMatch={noop}\n          detailLogItemToggle={detailLogItemToggle}\n          detailLogsToggle={detailLogsToggle}\n          detailWarningsToggle={detailWarningsToggle}\n          detailStackTracesToggle={detailStackTracesToggle}\n          detailReferencesToggle={detailReferencesToggle}\n          detailProcessToggle={detailProcessToggle}\n          detailTagsToggle={detailTagsToggle}\n          detailToggle={toggleDetail}\n          setTrace={noop}\n          addHoverIndentGuideId={addHoverIndentGuideId}\n          removeHoverIndentGuideId={removeHoverIndentGuideId}\n          linksGetter={noop as any}\n          uiFind={search}\n          createSpanLink={createSpanLink}\n          scrollElement={props.scrollElement}\n        />\n      </UIElementsContext.Provider>\n    </ThemeProvider>\n  );\n}\n\nfunction transformDataFrames(frame?: DataFrame): Trace | null {\n  if (!frame) {\n    return null;\n  }\n  let data: TraceResponse =\n    frame.fields.length === 1\n      ? // For backward compatibility when we sent whole json response in a single field/value\n        frame.fields[0].values.get(0)\n      : transformTraceDataFrame(frame);\n  return transformTraceData(data);\n}\n\nfunction transformTraceDataFrame(frame: DataFrame): TraceResponse {\n  const view = new DataFrameView<TraceSpanRow>(frame);\n  const processes: Record<string, TraceProcess> = {};\n  for (let i = 0; i < view.length; i++) {\n    const span = view.get(i);\n    if (!processes[span.spanID]) {\n      processes[span.spanID] = {\n        serviceName: span.serviceName,\n        tags: span.serviceTags,\n      };\n    }\n  }\n\n  return {\n    traceID: view.get(0).traceID,\n    processes,\n    spans: view.toArray().map((s, index) => {\n      return {\n        ...s,\n        duration: s.duration * 1000,\n        startTime: s.startTime * 1000,\n        processID: s.spanID,\n        flags: 0,\n        references: s.parentSpanID ? [{ refType: 'CHILD_OF', spanID: s.parentSpanID, traceID: s.traceID }] : undefined,\n        logs: s.logs?.map((l) => ({ ...l, timestamp: l.timestamp * 1000 })) || [],\n        dataFrameRowIndex: index,\n      };\n    }),\n  };\n}\n","import { useCallback, useState } from 'react';\n\n/**\n * This is used internally to handle hover state of indent guide. As indent guides are separate\n * components per each row/span and you need to highlight all in multiple rows to make the effect of single line\n * they need this kind of common imperative state changes.\n *\n * Ideally would be changed to trace view internal state.\n */\nexport function useHoverIndentGuide() {\n  const [hoverIndentGuideIds, setHoverIndentGuideIds] = useState(new Set<string>());\n\n  const addHoverIndentGuideId = useCallback(function addHoverIndentGuideId(spanID: string) {\n    setHoverIndentGuideIds((prevState) => {\n      const newHoverIndentGuideIds = new Set(prevState);\n      newHoverIndentGuideIds.add(spanID);\n      return newHoverIndentGuideIds;\n    });\n  }, []);\n\n  const removeHoverIndentGuideId = useCallback(function removeHoverIndentGuideId(spanID: string) {\n    setHoverIndentGuideIds((prevState) => {\n      const newHoverIndentGuideIds = new Set(prevState);\n      newHoverIndentGuideIds.delete(spanID);\n      return newHoverIndentGuideIds;\n    });\n  }, []);\n\n  return { hoverIndentGuideIds, addHoverIndentGuideId, removeHoverIndentGuideId };\n}\n","import { useCallback, useState } from 'react';\nimport { ViewRangeTimeUpdate, ViewRange } from '@jaegertracing/jaeger-ui-components';\n\n/**\n * Controls state of the zoom function that can be used through minimap in header or on the timeline. ViewRange contains\n * state not only for current range that is showing but range that is currently being selected by the user.\n */\nexport function useViewRange() {\n  const [viewRange, setViewRange] = useState<ViewRange>({\n    time: {\n      current: [0, 1],\n    },\n  });\n\n  const updateNextViewRangeTime = useCallback(function updateNextViewRangeTime(update: ViewRangeTimeUpdate) {\n    setViewRange(\n      (prevRange): ViewRange => {\n        const time = { ...prevRange.time, ...update };\n        return { ...prevRange, time };\n      }\n    );\n  }, []);\n\n  const updateViewRangeTime = useCallback(function updateViewRangeTime(start: number, end: number) {\n    const current: [number, number] = [start, end];\n    const time = { current };\n    setViewRange(\n      (prevRange): ViewRange => {\n        return { ...prevRange, time };\n      }\n    );\n  }, []);\n\n  return { viewRange, updateViewRangeTime, updateNextViewRangeTime };\n}\n","import { useMemo, useState } from 'react';\nimport { filterSpans, TraceSpan } from '@jaegertracing/jaeger-ui-components';\n\n/**\n * Controls the state of search input that highlights spans if they match the search string.\n * @param spans\n */\nexport function useSearch(spans?: TraceSpan[]) {\n  const [search, setSearch] = useState('');\n  const spanFindMatches: Set<string> | undefined | null = useMemo(() => {\n    return search && spans ? filterSpans(search, spans) : undefined;\n  }, [search, spans]);\n\n  return { search, setSearch, spanFindMatches };\n}\n","import React from 'react';\nimport { Collapse } from '@grafana/ui';\nimport { DataFrame, SplitOpen } from '@grafana/data';\nimport { TraceView } from './TraceView';\nimport { ExploreId } from 'app/types/explore';\n\ninterface Props {\n  dataFrames: DataFrame[];\n  splitOpenFn: SplitOpen;\n  exploreId: ExploreId;\n  scrollElement?: Element;\n}\nexport function TraceViewContainer(props: Props) {\n  const { dataFrames, splitOpenFn, exploreId, scrollElement } = props;\n\n  return (\n    <Collapse label=\"Trace View\" isOpen>\n      <TraceView\n        exploreId={exploreId}\n        dataFrames={dataFrames}\n        splitOpenFn={splitOpenFn}\n        scrollElement={scrollElement}\n      />\n    </Collapse>\n  );\n}\n","import { AbsoluteTimeRange, DataQueryResponse, LoadingState, SplitOpen, TimeZone } from '@grafana/data';\nimport { Alert, Button, Collapse, InlineField, TooltipDisplayMode, useStyles2, useTheme2 } from '@grafana/ui';\nimport { ExploreGraph } from './ExploreGraph';\nimport React from 'react';\nimport { css } from '@emotion/css';\n\ntype Props = {\n  logsVolumeData?: DataQueryResponse;\n  absoluteRange: AbsoluteTimeRange;\n  timeZone: TimeZone;\n  splitOpen: SplitOpen;\n  width: number;\n  onUpdateTimeRange: (timeRange: AbsoluteTimeRange) => void;\n  onLoadLogsVolume: () => void;\n};\n\nexport function LogsVolumePanel(props: Props) {\n  const { width, logsVolumeData, absoluteRange, timeZone, splitOpen, onUpdateTimeRange, onLoadLogsVolume } = props;\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const spacing = parseInt(theme.spacing(2).slice(0, -2), 10);\n  const height = 150;\n\n  let LogsVolumePanelContent;\n\n  if (!logsVolumeData) {\n    return null;\n  } else if (logsVolumeData?.error) {\n    return (\n      <Alert title=\"Failed to load log volume for this query\">\n        {logsVolumeData.error.data?.message || logsVolumeData.error.statusText || logsVolumeData.error.message}\n      </Alert>\n    );\n  } else if (logsVolumeData?.state === LoadingState.Loading) {\n    LogsVolumePanelContent = <span>Log volume is loading...</span>;\n  } else if (logsVolumeData?.data) {\n    if (logsVolumeData.data.length > 0) {\n      LogsVolumePanelContent = (\n        <ExploreGraph\n          graphStyle=\"lines\"\n          loadingState={LoadingState.Done}\n          data={logsVolumeData.data}\n          height={height}\n          width={width - spacing}\n          absoluteRange={absoluteRange}\n          onChangeTime={onUpdateTimeRange}\n          timeZone={timeZone}\n          splitOpenFn={splitOpen}\n          tooltipDisplayMode={TooltipDisplayMode.Multi}\n        />\n      );\n    } else {\n      LogsVolumePanelContent = <span>No volume data.</span>;\n    }\n  }\n\n  const zoomRatio = logsLevelZoomRatio(logsVolumeData, absoluteRange);\n  let zoomLevelInfo;\n\n  if (zoomRatio !== undefined && zoomRatio < 1) {\n    zoomLevelInfo = (\n      <InlineField label=\"Reload log volume\" transparent>\n        <Button size=\"xs\" icon=\"sync\" variant=\"secondary\" onClick={onLoadLogsVolume} id=\"reload-volume\" />\n      </InlineField>\n    );\n  }\n\n  return (\n    <Collapse label=\"Log volume\" isOpen={true} loading={logsVolumeData?.state === LoadingState.Loading}>\n      <div style={{ height }} className={styles.contentContainer}>\n        {LogsVolumePanelContent}\n      </div>\n      <div className={styles.zoomInfoContainer}>{zoomLevelInfo}</div>\n    </Collapse>\n  );\n}\n\nconst getStyles = () => {\n  return {\n    zoomInfoContainer: css`\n      display: flex;\n      justify-content: end;\n      position: absolute;\n      right: 5px;\n      top: 5px;\n    `,\n    contentContainer: css`\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    `,\n  };\n};\n\nfunction logsLevelZoomRatio(\n  logsVolumeData: DataQueryResponse | undefined,\n  selectedTimeRange: AbsoluteTimeRange\n): number | undefined {\n  const dataRange = logsVolumeData && logsVolumeData.data[0] && logsVolumeData.data[0].meta?.custom?.absoluteRange;\n  return dataRange ? (selectedTimeRange.from - selectedTimeRange.to) / (dataRange.from - dataRange.to) : undefined;\n}\n","import React from 'react';\nimport { css } from '@emotion/css';\nimport { SelectableValue } from '@grafana/data';\nimport { RadioButtonGroup } from '@grafana/ui';\nimport { ExploreGraphStyle, EXPLORE_GRAPH_STYLES } from 'app/core/utils/explore';\n\nconst ALL_GRAPH_STYLE_OPTIONS: Array<SelectableValue<ExploreGraphStyle>> = EXPLORE_GRAPH_STYLES.map((style) => ({\n  value: style,\n  // capital-case it and switch `_` to ` `\n  label: style[0].toUpperCase() + style.slice(1).replace(/_/, ' '),\n}));\n\nconst spacing = css({\n  display: 'flex',\n  justifyContent: 'space-between',\n});\n\ntype Props = {\n  graphStyle: ExploreGraphStyle;\n  onChangeGraphStyle: (style: ExploreGraphStyle) => void;\n};\n\nexport function ExploreGraphLabel(props: Props) {\n  const { graphStyle, onChangeGraphStyle } = props;\n  return (\n    <div className={spacing}>\n      Graph\n      <RadioButtonGroup size=\"sm\" options={ALL_GRAPH_STYLE_OPTIONS} value={graphStyle} onChange={onChangeGraphStyle} />\n    </div>\n  );\n}\n","import React from 'react';\nimport { css, cx } from '@emotion/css';\nimport { compose } from 'redux';\nimport { connect, ConnectedProps } from 'react-redux';\nimport AutoSizer from 'react-virtualized-auto-sizer';\nimport memoizeOne from 'memoize-one';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { Collapse, CustomScrollbar, ErrorBoundaryAlert, Themeable2, withTheme2 } from '@grafana/ui';\nimport { AbsoluteTimeRange, DataFrame, DataQuery, GrafanaTheme2, LoadingState, RawTimeRange } from '@grafana/data';\n\nimport LogsContainer from './LogsContainer';\nimport { QueryRows } from './QueryRows';\nimport TableContainer from './TableContainer';\nimport RichHistoryContainer from './RichHistory/RichHistoryContainer';\nimport ExploreQueryInspector from './ExploreQueryInspector';\nimport { splitOpen } from './state/main';\nimport { changeSize, changeGraphStyle } from './state/explorePane';\nimport { updateTimeRange } from './state/time';\nimport { addQueryRow, loadLogsVolumeData, modifyQueries, scanStart, scanStopAction, setQueries } from './state/query';\nimport { ExploreId, ExploreItemState } from 'app/types/explore';\nimport { StoreState } from 'app/types';\nimport { ExploreToolbar } from './ExploreToolbar';\nimport { NoDataSourceCallToAction } from './NoDataSourceCallToAction';\nimport { getTimeZone } from '../profile/state/selectors';\nimport { SecondaryActions } from './SecondaryActions';\nimport { FILTER_FOR_OPERATOR, FILTER_OUT_OPERATOR, FilterItem } from '@grafana/ui/src/components/Table/types';\nimport { NodeGraphContainer } from './NodeGraphContainer';\nimport { ResponseErrorContainer } from './ResponseErrorContainer';\nimport { TraceViewContainer } from './TraceView/TraceViewContainer';\nimport { ExploreGraph } from './ExploreGraph';\nimport { LogsVolumePanel } from './LogsVolumePanel';\nimport { ExploreGraphLabel } from './ExploreGraphLabel';\nimport { ExploreGraphStyle } from 'app/core/utils/explore';\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    exploreMain: css`\n      label: exploreMain;\n      // Is needed for some transition animations to work.\n      position: relative;\n      margin-top: 21px;\n    `,\n    button: css`\n      label: button;\n      margin: 1em 4px 0 0;\n    `,\n    queryContainer: css`\n      label: queryContainer;\n      // Need to override normal css class and don't want to count on ordering of the classes in html.\n      height: auto !important;\n      flex: unset !important;\n      display: unset !important;\n      padding: ${theme.spacing(1)};\n    `,\n  };\n};\n\nexport interface ExploreProps extends Themeable2 {\n  exploreId: ExploreId;\n  theme: GrafanaTheme2;\n}\n\nenum ExploreDrawer {\n  RichHistory,\n  QueryInspector,\n}\n\ninterface ExploreState {\n  openDrawer?: ExploreDrawer;\n}\n\nexport type Props = ExploreProps & ConnectedProps<typeof connector>;\n\n/**\n * Explore provides an area for quick query iteration for a given datasource.\n * Once a datasource is selected it populates the query section at the top.\n * When queries are run, their results are being displayed in the main section.\n * The datasource determines what kind of query editor it brings, and what kind\n * of results viewers it supports. The state is managed entirely in Redux.\n *\n * SPLIT VIEW\n *\n * Explore can have two Explore areas side-by-side. This is handled in `Wrapper.tsx`.\n * Since there can be multiple Explores (e.g., left and right) each action needs\n * the `exploreId` as first parameter so that the reducer knows which Explore state\n * is affected.\n *\n * DATASOURCE REQUESTS\n *\n * A click on Run Query creates transactions for all DataQueries for all expanded\n * result viewers. New runs are discarding previous runs. Upon completion a transaction\n * saves the result. The result viewers construct their data from the currently existing\n * transactions.\n *\n * The result viewers determine some of the query options sent to the datasource, e.g.,\n * `format`, to indicate eventual transformations by the datasources' result transformers.\n */\nexport class Explore extends React.PureComponent<Props, ExploreState> {\n  scrollElement: HTMLDivElement | undefined;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      openDrawer: undefined,\n    };\n  }\n\n  onChangeTime = (rawRange: RawTimeRange) => {\n    const { updateTimeRange, exploreId } = this.props;\n    updateTimeRange({ exploreId, rawRange });\n  };\n\n  // Use this in help pages to set page to a single query\n  onClickExample = (query: DataQuery) => {\n    this.props.setQueries(this.props.exploreId, [query]);\n  };\n\n  onCellFilterAdded = (filter: FilterItem) => {\n    const { value, key, operator } = filter;\n    if (operator === FILTER_FOR_OPERATOR) {\n      this.onClickFilterLabel(key, value);\n    }\n\n    if (operator === FILTER_OUT_OPERATOR) {\n      this.onClickFilterOutLabel(key, value);\n    }\n  };\n\n  onClickFilterLabel = (key: string, value: string) => {\n    this.onModifyQueries({ type: 'ADD_FILTER', key, value });\n  };\n\n  onClickFilterOutLabel = (key: string, value: string) => {\n    this.onModifyQueries({ type: 'ADD_FILTER_OUT', key, value });\n  };\n\n  onClickAddQueryRowButton = () => {\n    const { exploreId, queryKeys } = this.props;\n    this.props.addQueryRow(exploreId, queryKeys.length);\n  };\n\n  onModifyQueries = (action: any, index?: number) => {\n    const { datasourceInstance } = this.props;\n    if (datasourceInstance?.modifyQuery) {\n      const modifier = (queries: DataQuery, modification: any) =>\n        datasourceInstance.modifyQuery!(queries, modification);\n      this.props.modifyQueries(this.props.exploreId, action, modifier, index);\n    }\n  };\n\n  onResize = (size: { height: number; width: number }) => {\n    this.props.changeSize(this.props.exploreId, size);\n  };\n\n  onStartScanning = () => {\n    // Scanner will trigger a query\n    this.props.scanStart(this.props.exploreId);\n  };\n\n  onStopScanning = () => {\n    this.props.scanStopAction({ exploreId: this.props.exploreId });\n  };\n\n  onUpdateTimeRange = (absoluteRange: AbsoluteTimeRange) => {\n    const { exploreId, updateTimeRange } = this.props;\n    updateTimeRange({ exploreId, absoluteRange });\n  };\n\n  onChangeGraphStyle = (graphStyle: ExploreGraphStyle) => {\n    const { exploreId, changeGraphStyle } = this.props;\n    changeGraphStyle(exploreId, graphStyle);\n  };\n\n  toggleShowRichHistory = () => {\n    this.setState((state) => {\n      return {\n        openDrawer: state.openDrawer === ExploreDrawer.RichHistory ? undefined : ExploreDrawer.RichHistory,\n      };\n    });\n  };\n\n  toggleShowQueryInspector = () => {\n    this.setState((state) => {\n      return {\n        openDrawer: state.openDrawer === ExploreDrawer.QueryInspector ? undefined : ExploreDrawer.QueryInspector,\n      };\n    });\n  };\n\n  renderEmptyState() {\n    return (\n      <div className=\"explore-container\">\n        <NoDataSourceCallToAction />\n      </div>\n    );\n  }\n\n  renderGraphPanel(width: number) {\n    const { graphResult, absoluteRange, timeZone, splitOpen, queryResponse, loading, theme, graphStyle } = this.props;\n    const spacing = parseInt(theme.spacing(2).slice(0, -2), 10);\n    const label = <ExploreGraphLabel graphStyle={graphStyle} onChangeGraphStyle={this.onChangeGraphStyle} />;\n    return (\n      <Collapse label={label} loading={loading} isOpen>\n        <ExploreGraph\n          graphStyle={graphStyle}\n          data={graphResult!}\n          height={400}\n          width={width - spacing}\n          absoluteRange={absoluteRange}\n          onChangeTime={this.onUpdateTimeRange}\n          timeZone={timeZone}\n          annotations={queryResponse.annotations}\n          splitOpenFn={splitOpen}\n          loadingState={queryResponse.state}\n        />\n      </Collapse>\n    );\n  }\n\n  renderLogsVolume(width: number) {\n    const { logsVolumeData, exploreId, loadLogsVolumeData, absoluteRange, timeZone, splitOpen } = this.props;\n\n    return (\n      <LogsVolumePanel\n        absoluteRange={absoluteRange}\n        width={width}\n        logsVolumeData={logsVolumeData}\n        onUpdateTimeRange={this.onUpdateTimeRange}\n        timeZone={timeZone}\n        splitOpen={splitOpen}\n        onLoadLogsVolume={() => loadLogsVolumeData(exploreId)}\n      />\n    );\n  }\n\n  renderTablePanel(width: number) {\n    const { exploreId, datasourceInstance, timeZone } = this.props;\n    return (\n      <TableContainer\n        ariaLabel={selectors.pages.Explore.General.table}\n        width={width}\n        exploreId={exploreId}\n        onCellFilterAdded={datasourceInstance?.modifyQuery ? this.onCellFilterAdded : undefined}\n        timeZone={timeZone}\n      />\n    );\n  }\n\n  renderLogsPanel(width: number) {\n    const { exploreId, syncedTimes, theme, queryResponse } = this.props;\n    const spacing = parseInt(theme.spacing(2).slice(0, -2), 10);\n    return (\n      <LogsContainer\n        exploreId={exploreId}\n        loadingState={queryResponse.state}\n        syncedTimes={syncedTimes}\n        width={width - spacing}\n        onClickFilterLabel={this.onClickFilterLabel}\n        onClickFilterOutLabel={this.onClickFilterOutLabel}\n        onStartScanning={this.onStartScanning}\n        onStopScanning={this.onStopScanning}\n      />\n    );\n  }\n\n  renderNodeGraphPanel() {\n    const { exploreId, showTrace, queryResponse } = this.props;\n    return (\n      <NodeGraphContainer\n        dataFrames={this.getNodeGraphDataFrames(queryResponse.series)}\n        exploreId={exploreId}\n        withTraceView={showTrace}\n      />\n    );\n  }\n\n  getNodeGraphDataFrames = memoizeOne((frames: DataFrame[]) => {\n    // TODO: this not in sync with how other types of responses are handled. Other types have a query response\n    //  processing pipeline which ends up populating redux state with proper data. As we move towards more dataFrame\n    //  oriented API it seems like a better direction to move such processing into to visualisations and do minimal\n    //  and lazy processing here. Needs bigger refactor so keeping nodeGraph and Traces as they are for now.\n    return frames.filter((frame) => frame.meta?.preferredVisualisationType === 'nodeGraph');\n  });\n\n  renderTraceViewPanel() {\n    const { queryResponse, splitOpen, exploreId } = this.props;\n    const dataFrames = queryResponse.series.filter((series) => series.meta?.preferredVisualisationType === 'trace');\n\n    return (\n      // If there is no data (like 404) we show a separate error so no need to show anything here\n      dataFrames.length && (\n        <TraceViewContainer\n          exploreId={exploreId}\n          dataFrames={dataFrames}\n          splitOpenFn={splitOpen}\n          scrollElement={this.scrollElement}\n        />\n      )\n    );\n  }\n\n  render() {\n    const {\n      datasourceInstance,\n      datasourceMissing,\n      exploreId,\n      graphResult,\n      queryResponse,\n      isLive,\n      theme,\n      showMetrics,\n      showTable,\n      showLogs,\n      showTrace,\n      showNodeGraph,\n      timeZone,\n    } = this.props;\n    const { openDrawer } = this.state;\n    const styles = getStyles(theme);\n    const showPanels = queryResponse && queryResponse.state !== LoadingState.NotStarted;\n    const showRichHistory = openDrawer === ExploreDrawer.RichHistory;\n    const showQueryInspector = openDrawer === ExploreDrawer.QueryInspector;\n\n    return (\n      <CustomScrollbar\n        autoHeightMin={'100%'}\n        scrollRefCallback={(scrollElement) => (this.scrollElement = scrollElement || undefined)}\n      >\n        <ExploreToolbar exploreId={exploreId} onChangeTime={this.onChangeTime} />\n        {datasourceMissing ? this.renderEmptyState() : null}\n        {datasourceInstance && (\n          <div className=\"explore-container\">\n            <div className={cx('panel-container', styles.queryContainer)}>\n              <QueryRows exploreId={exploreId} />\n              <SecondaryActions\n                addQueryRowButtonDisabled={isLive}\n                // We cannot show multiple traces at the same time right now so we do not show add query button.\n                //TODO:unification\n                addQueryRowButtonHidden={false}\n                richHistoryButtonActive={showRichHistory}\n                queryInspectorButtonActive={showQueryInspector}\n                onClickAddQueryRowButton={this.onClickAddQueryRowButton}\n                onClickRichHistoryButton={this.toggleShowRichHistory}\n                onClickQueryInspectorButton={this.toggleShowQueryInspector}\n              />\n              <ResponseErrorContainer exploreId={exploreId} />\n            </div>\n            <AutoSizer onResize={this.onResize} disableHeight>\n              {({ width }) => {\n                if (width === 0) {\n                  return null;\n                }\n\n                return (\n                  <main className={cx(styles.exploreMain)} style={{ width }}>\n                    <ErrorBoundaryAlert>\n                      {showPanels && (\n                        <>\n                          {showMetrics && graphResult && (\n                            <ErrorBoundaryAlert>{this.renderGraphPanel(width)}</ErrorBoundaryAlert>\n                          )}\n                          {<ErrorBoundaryAlert>{this.renderLogsVolume(width)}</ErrorBoundaryAlert>}\n                          {showTable && <ErrorBoundaryAlert>{this.renderTablePanel(width)}</ErrorBoundaryAlert>}\n                          {showLogs && <ErrorBoundaryAlert>{this.renderLogsPanel(width)}</ErrorBoundaryAlert>}\n                          {showNodeGraph && <ErrorBoundaryAlert>{this.renderNodeGraphPanel()}</ErrorBoundaryAlert>}\n                          {showTrace && <ErrorBoundaryAlert>{this.renderTraceViewPanel()}</ErrorBoundaryAlert>}\n                        </>\n                      )}\n                      {showRichHistory && (\n                        <RichHistoryContainer\n                          width={width}\n                          exploreId={exploreId}\n                          onClose={this.toggleShowRichHistory}\n                        />\n                      )}\n                      {showQueryInspector && (\n                        <ExploreQueryInspector\n                          exploreId={exploreId}\n                          width={width}\n                          onClose={this.toggleShowQueryInspector}\n                          timeZone={timeZone}\n                        />\n                      )}\n                    </ErrorBoundaryAlert>\n                  </main>\n                );\n              }}\n            </AutoSizer>\n          </div>\n        )}\n      </CustomScrollbar>\n    );\n  }\n}\n\nfunction mapStateToProps(state: StoreState, { exploreId }: ExploreProps) {\n  const explore = state.explore;\n  const { syncedTimes } = explore;\n  const item: ExploreItemState = explore[exploreId]!;\n  const timeZone = getTimeZone(state.user);\n  const {\n    datasourceInstance,\n    datasourceMissing,\n    queryKeys,\n    isLive,\n    graphResult,\n    logsVolumeData,\n    logsResult,\n    showLogs,\n    showMetrics,\n    showTable,\n    showTrace,\n    absoluteRange,\n    queryResponse,\n    showNodeGraph,\n    loading,\n    graphStyle,\n  } = item;\n\n  return {\n    datasourceInstance,\n    datasourceMissing,\n    queryKeys,\n    isLive,\n    graphResult,\n    logsVolumeData,\n    logsResult: logsResult ?? undefined,\n    absoluteRange,\n    queryResponse,\n    syncedTimes,\n    timeZone,\n    showLogs,\n    showMetrics,\n    showTable,\n    showTrace,\n    showNodeGraph,\n    loading,\n    graphStyle,\n  };\n}\n\nconst mapDispatchToProps = {\n  changeSize,\n  changeGraphStyle,\n  modifyQueries,\n  scanStart,\n  scanStopAction,\n  setQueries,\n  updateTimeRange,\n  loadLogsVolumeData,\n  addQueryRow,\n  splitOpen,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport default compose(connector, withTheme2)(Explore) as React.ComponentType<{ exploreId: ExploreId }>;\n","import React from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport memoizeOne from 'memoize-one';\nimport { DataQuery, ExploreUrlState, EventBusExtended, EventBusSrv } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport store from 'app/core/store';\nimport { lastSavedUrl, cleanupPaneAction } from './state/main';\nimport { initializeExplore, refreshExplore } from './state/explorePane';\nimport { ExploreId } from 'app/types/explore';\nimport { StoreState } from 'app/types';\nimport {\n  DEFAULT_RANGE,\n  ensureQueries,\n  getTimeRange,\n  getTimeRangeFromUrl,\n  lastUsedDatasourceKeyForOrgId,\n  parseUrlState,\n} from 'app/core/utils/explore';\nimport { getFiscalYearStartMonth, getTimeZone } from '../profile/state/selectors';\nimport Explore from './Explore';\n\ninterface OwnProps {\n  exploreId: ExploreId;\n  urlQuery: string;\n  split: boolean;\n}\n\ninterface Props extends OwnProps, ConnectedProps<typeof connector> {}\n\n/**\n * This component is responsible for handling initialization of an Explore pane and triggering synchronization\n * of state based on URL changes and preventing any infinite loops.\n */\nclass ExplorePaneContainerUnconnected extends React.PureComponent<Props> {\n  el: any;\n  exploreEvents: EventBusExtended;\n\n  constructor(props: Props) {\n    super(props);\n    this.exploreEvents = new EventBusSrv();\n    this.state = {\n      openDrawer: undefined,\n    };\n  }\n\n  componentDidMount() {\n    const { initialized, exploreId, initialDatasource, initialQueries, initialRange, originPanelId } = this.props;\n    const width = this.el?.offsetWidth ?? 0;\n\n    // initialize the whole explore first time we mount and if browser history contains a change in datasource\n    if (!initialized) {\n      this.props.initializeExplore(\n        exploreId,\n        initialDatasource,\n        initialQueries,\n        initialRange,\n        width,\n        this.exploreEvents,\n        originPanelId\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    this.exploreEvents.removeAllListeners();\n    this.props.cleanupPaneAction({ exploreId: this.props.exploreId });\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    this.refreshExplore(prevProps.urlQuery);\n  }\n\n  refreshExplore = (prevUrlQuery: string) => {\n    const { exploreId, urlQuery } = this.props;\n\n    // Update state from url only if it changed and only if the change wasn't initialised by redux to prevent any loops\n    if (urlQuery !== prevUrlQuery && urlQuery !== lastSavedUrl[exploreId]) {\n      this.props.refreshExplore(exploreId, urlQuery);\n    }\n  };\n\n  getRef = (el: any) => {\n    this.el = el;\n  };\n\n  render() {\n    const exploreClass = this.props.split ? 'explore explore-split' : 'explore';\n    return (\n      <div className={exploreClass} ref={this.getRef} data-testid={selectors.pages.Explore.General.container}>\n        {this.props.initialized && <Explore exploreId={this.props.exploreId} />}\n      </div>\n    );\n  }\n}\n\nconst ensureQueriesMemoized = memoizeOne(ensureQueries);\nconst getTimeRangeFromUrlMemoized = memoizeOne(getTimeRangeFromUrl);\n\nfunction mapStateToProps(state: StoreState, props: OwnProps) {\n  const urlState = parseUrlState(props.urlQuery);\n  const timeZone = getTimeZone(state.user);\n  const fiscalYearStartMonth = getFiscalYearStartMonth(state.user);\n\n  const { datasource, queries, range: urlRange, originPanelId } = (urlState || {}) as ExploreUrlState;\n  const initialDatasource = datasource || store.get(lastUsedDatasourceKeyForOrgId(state.user.orgId));\n  const initialQueries: DataQuery[] = ensureQueriesMemoized(queries);\n  const initialRange = urlRange\n    ? getTimeRangeFromUrlMemoized(urlRange, timeZone, fiscalYearStartMonth)\n    : getTimeRange(timeZone, DEFAULT_RANGE, fiscalYearStartMonth);\n\n  return {\n    initialized: state.explore[props.exploreId]?.initialized,\n    initialDatasource,\n    initialQueries,\n    initialRange,\n    originPanelId,\n  };\n}\n\nconst mapDispatchToProps = {\n  initializeExplore,\n  refreshExplore,\n  cleanupPaneAction,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport const ExplorePaneContainer = connector(ExplorePaneContainerUnconnected);\n","import React, { PureComponent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { ExploreId, ExploreQueryParams } from 'app/types/explore';\nimport { ErrorBoundaryAlert } from '@grafana/ui';\nimport { lastSavedUrl, resetExploreAction, richHistoryUpdatedAction } from './state/main';\nimport { getRichHistory } from '../../core/utils/richHistory';\nimport { ExplorePaneContainer } from './ExplorePaneContainer';\nimport { GrafanaRouteComponentProps } from 'app/core/navigation/types';\nimport { Branding } from '../../core/components/Branding/Branding';\n\nimport { getNavModel } from '../../core/selectors/navModel';\nimport { StoreState } from 'app/types';\n\ninterface RouteProps extends GrafanaRouteComponentProps<{}, ExploreQueryParams> {}\ninterface OwnProps {}\n\nconst mapStateToProps = (state: StoreState) => {\n  return {\n    navModel: getNavModel(state.navIndex, 'explore'),\n    exploreState: state.explore,\n  };\n};\n\nconst mapDispatchToProps = {\n  resetExploreAction,\n  richHistoryUpdatedAction,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\ntype Props = OwnProps & RouteProps & ConnectedProps<typeof connector>;\nclass WrapperUnconnected extends PureComponent<Props> {\n  componentWillUnmount() {\n    this.props.resetExploreAction({});\n  }\n\n  componentDidMount() {\n    lastSavedUrl.left = undefined;\n    lastSavedUrl.right = undefined;\n\n    const richHistory = getRichHistory();\n    this.props.richHistoryUpdatedAction({ richHistory });\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { left, right } = this.props.queryParams;\n    const hasSplit = Boolean(left) && Boolean(right);\n    const datasourceTitle = hasSplit\n      ? `${this.props.exploreState.left.datasourceInstance?.name} | ${this.props.exploreState.right?.datasourceInstance?.name}`\n      : `${this.props.exploreState.left.datasourceInstance?.name}`;\n    const documentTitle = `${this.props.navModel.main.text} - ${datasourceTitle} - ${Branding.AppTitle}`;\n    document.title = documentTitle;\n  }\n\n  render() {\n    const { left, right } = this.props.queryParams;\n    const hasSplit = Boolean(left) && Boolean(right);\n\n    return (\n      <div className=\"page-scrollbar-wrapper\">\n        <div className=\"explore-wrapper\">\n          <ErrorBoundaryAlert style=\"page\">\n            <ExplorePaneContainer split={hasSplit} exploreId={ExploreId.left} urlQuery={left} />\n          </ErrorBoundaryAlert>\n          {hasSplit && (\n            <ErrorBoundaryAlert style=\"page\">\n              <ExplorePaneContainer split={hasSplit} exploreId={ExploreId.right} urlQuery={right} />\n            </ErrorBoundaryAlert>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst Wrapper = connector(WrapperUnconnected);\n\nexport default Wrapper;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport PropTypes from 'prop-types';\nimport addOneClass from 'dom-helpers/addClass';\nimport removeOneClass from 'dom-helpers/removeClass';\nimport React from 'react';\nimport Transition from './Transition';\nimport { classNamesShape } from './utils/PropTypes';\n\nvar _addClass = function addClass(node, classes) {\n  return node && classes && classes.split(' ').forEach(function (c) {\n    return addOneClass(node, c);\n  });\n};\n\nvar removeClass = function removeClass(node, classes) {\n  return node && classes && classes.split(' ').forEach(function (c) {\n    return removeOneClass(node, c);\n  });\n};\n/**\n * A transition component inspired by the excellent\n * [ng-animate](https://docs.angularjs.org/api/ngAnimate) library, you should\n * use it if you're using CSS transitions or animations. It's built upon the\n * [`Transition`](https://reactcommunity.org/react-transition-group/transition)\n * component, so it inherits all of its props.\n *\n * `CSSTransition` applies a pair of class names during the `appear`, `enter`,\n * and `exit` states of the transition. The first class is applied and then a\n * second `*-active` class in order to activate the CSS transition. After the\n * transition, matching `*-done` class names are applied to persist the\n * transition state.\n *\n * ```jsx\n * function App() {\n *   const [inProp, setInProp] = useState(false);\n *   return (\n *     <div>\n *       <CSSTransition in={inProp} timeout={200} classNames=\"my-node\">\n *         <div>\n *           {\"I'll receive my-node-* classes\"}\n *         </div>\n *       </CSSTransition>\n *       <button type=\"button\" onClick={() => setInProp(true)}>\n *         Click to Enter\n *       </button>\n *     </div>\n *   );\n * }\n * ```\n *\n * When the `in` prop is set to `true`, the child component will first receive\n * the class `example-enter`, then the `example-enter-active` will be added in\n * the next tick. `CSSTransition` [forces a\n * reflow](https://github.com/reactjs/react-transition-group/blob/5007303e729a74be66a21c3e2205e4916821524b/src/CSSTransition.js#L208-L215)\n * between before adding the `example-enter-active`. This is an important trick\n * because it allows us to transition between `example-enter` and\n * `example-enter-active` even though they were added immediately one after\n * another. Most notably, this is what makes it possible for us to animate\n * _appearance_.\n *\n * ```css\n * .my-node-enter {\n *   opacity: 0;\n * }\n * .my-node-enter-active {\n *   opacity: 1;\n *   transition: opacity 200ms;\n * }\n * .my-node-exit {\n *   opacity: 1;\n * }\n * .my-node-exit-active {\n *   opacity: 0;\n *   transition: opacity 200ms;\n * }\n * ```\n *\n * `*-active` classes represent which styles you want to animate **to**, so it's\n * important to add `transition` declaration only to them, otherwise transitions\n * might not behave as intended! This might not be obvious when the transitions\n * are symmetrical, i.e. when `*-enter-active` is the same as `*-exit`, like in\n * the example above (minus `transition`), but it becomes apparent in more\n * complex transitions.\n *\n * **Note**: If you're using the\n * [`appear`](http://reactcommunity.org/react-transition-group/transition#Transition-prop-appear)\n * prop, make sure to define styles for `.appear-*` classes as well.\n */\n\n\nvar CSSTransition = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(CSSTransition, _React$Component);\n\n  function CSSTransition() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.appliedClasses = {\n      appear: {},\n      enter: {},\n      exit: {}\n    };\n\n    _this.onEnter = function (maybeNode, maybeAppearing) {\n      var _this$resolveArgument = _this.resolveArguments(maybeNode, maybeAppearing),\n          node = _this$resolveArgument[0],\n          appearing = _this$resolveArgument[1];\n\n      _this.removeClasses(node, 'exit');\n\n      _this.addClass(node, appearing ? 'appear' : 'enter', 'base');\n\n      if (_this.props.onEnter) {\n        _this.props.onEnter(maybeNode, maybeAppearing);\n      }\n    };\n\n    _this.onEntering = function (maybeNode, maybeAppearing) {\n      var _this$resolveArgument2 = _this.resolveArguments(maybeNode, maybeAppearing),\n          node = _this$resolveArgument2[0],\n          appearing = _this$resolveArgument2[1];\n\n      var type = appearing ? 'appear' : 'enter';\n\n      _this.addClass(node, type, 'active');\n\n      if (_this.props.onEntering) {\n        _this.props.onEntering(maybeNode, maybeAppearing);\n      }\n    };\n\n    _this.onEntered = function (maybeNode, maybeAppearing) {\n      var _this$resolveArgument3 = _this.resolveArguments(maybeNode, maybeAppearing),\n          node = _this$resolveArgument3[0],\n          appearing = _this$resolveArgument3[1];\n\n      var type = appearing ? 'appear' : 'enter';\n\n      _this.removeClasses(node, type);\n\n      _this.addClass(node, type, 'done');\n\n      if (_this.props.onEntered) {\n        _this.props.onEntered(maybeNode, maybeAppearing);\n      }\n    };\n\n    _this.onExit = function (maybeNode) {\n      var _this$resolveArgument4 = _this.resolveArguments(maybeNode),\n          node = _this$resolveArgument4[0];\n\n      _this.removeClasses(node, 'appear');\n\n      _this.removeClasses(node, 'enter');\n\n      _this.addClass(node, 'exit', 'base');\n\n      if (_this.props.onExit) {\n        _this.props.onExit(maybeNode);\n      }\n    };\n\n    _this.onExiting = function (maybeNode) {\n      var _this$resolveArgument5 = _this.resolveArguments(maybeNode),\n          node = _this$resolveArgument5[0];\n\n      _this.addClass(node, 'exit', 'active');\n\n      if (_this.props.onExiting) {\n        _this.props.onExiting(maybeNode);\n      }\n    };\n\n    _this.onExited = function (maybeNode) {\n      var _this$resolveArgument6 = _this.resolveArguments(maybeNode),\n          node = _this$resolveArgument6[0];\n\n      _this.removeClasses(node, 'exit');\n\n      _this.addClass(node, 'exit', 'done');\n\n      if (_this.props.onExited) {\n        _this.props.onExited(maybeNode);\n      }\n    };\n\n    _this.resolveArguments = function (maybeNode, maybeAppearing) {\n      return _this.props.nodeRef ? [_this.props.nodeRef.current, maybeNode] // here `maybeNode` is actually `appearing`\n      : [maybeNode, maybeAppearing];\n    };\n\n    _this.getClassNames = function (type) {\n      var classNames = _this.props.classNames;\n      var isStringClassNames = typeof classNames === 'string';\n      var prefix = isStringClassNames && classNames ? classNames + \"-\" : '';\n      var baseClassName = isStringClassNames ? \"\" + prefix + type : classNames[type];\n      var activeClassName = isStringClassNames ? baseClassName + \"-active\" : classNames[type + \"Active\"];\n      var doneClassName = isStringClassNames ? baseClassName + \"-done\" : classNames[type + \"Done\"];\n      return {\n        baseClassName: baseClassName,\n        activeClassName: activeClassName,\n        doneClassName: doneClassName\n      };\n    };\n\n    return _this;\n  }\n\n  var _proto = CSSTransition.prototype;\n\n  _proto.addClass = function addClass(node, type, phase) {\n    var className = this.getClassNames(type)[phase + \"ClassName\"];\n\n    var _this$getClassNames = this.getClassNames('enter'),\n        doneClassName = _this$getClassNames.doneClassName;\n\n    if (type === 'appear' && phase === 'done' && doneClassName) {\n      className += \" \" + doneClassName;\n    } // This is for to force a repaint,\n    // which is necessary in order to transition styles when adding a class name.\n\n\n    if (phase === 'active') {\n      /* eslint-disable no-unused-expressions */\n      node && node.scrollTop;\n    }\n\n    if (className) {\n      this.appliedClasses[type][phase] = className;\n\n      _addClass(node, className);\n    }\n  };\n\n  _proto.removeClasses = function removeClasses(node, type) {\n    var _this$appliedClasses$ = this.appliedClasses[type],\n        baseClassName = _this$appliedClasses$.base,\n        activeClassName = _this$appliedClasses$.active,\n        doneClassName = _this$appliedClasses$.done;\n    this.appliedClasses[type] = {};\n\n    if (baseClassName) {\n      removeClass(node, baseClassName);\n    }\n\n    if (activeClassName) {\n      removeClass(node, activeClassName);\n    }\n\n    if (doneClassName) {\n      removeClass(node, doneClassName);\n    }\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        _ = _this$props.classNames,\n        props = _objectWithoutPropertiesLoose(_this$props, [\"classNames\"]);\n\n    return /*#__PURE__*/React.createElement(Transition, _extends({}, props, {\n      onEnter: this.onEnter,\n      onEntered: this.onEntered,\n      onEntering: this.onEntering,\n      onExit: this.onExit,\n      onExiting: this.onExiting,\n      onExited: this.onExited\n    }));\n  };\n\n  return CSSTransition;\n}(React.Component);\n\nCSSTransition.defaultProps = {\n  classNames: ''\n};\nCSSTransition.propTypes = process.env.NODE_ENV !== \"production\" ? _extends({}, Transition.propTypes, {\n  /**\n   * The animation classNames applied to the component as it appears, enters,\n   * exits or has finished the transition. A single name can be provided, which\n   * will be suffixed for each stage, e.g. `classNames=\"fade\"` applies:\n   *\n   * - `fade-appear`, `fade-appear-active`, `fade-appear-done`\n   * - `fade-enter`, `fade-enter-active`, `fade-enter-done`\n   * - `fade-exit`, `fade-exit-active`, `fade-exit-done`\n   *\n   * A few details to note about how these classes are applied:\n   *\n   * 1. They are _joined_ with the ones that are already defined on the child\n   *    component, so if you want to add some base styles, you can use\n   *    `className` without worrying that it will be overridden.\n   *\n   * 2. If the transition component mounts with `in={false}`, no classes are\n   *    applied yet. You might be expecting `*-exit-done`, but if you think\n   *    about it, a component cannot finish exiting if it hasn't entered yet.\n   *\n   * 2. `fade-appear-done` and `fade-enter-done` will _both_ be applied. This\n   *    allows you to define different behavior for when appearing is done and\n   *    when regular entering is done, using selectors like\n   *    `.fade-enter-done:not(.fade-appear-done)`. For example, you could apply\n   *    an epic entrance animation when element first appears in the DOM using\n   *    [Animate.css](https://daneden.github.io/animate.css/). Otherwise you can\n   *    simply use `fade-enter-done` for defining both cases.\n   *\n   * Each individual classNames can also be specified independently like:\n   *\n   * ```js\n   * classNames={{\n   *  appear: 'my-appear',\n   *  appearActive: 'my-active-appear',\n   *  appearDone: 'my-done-appear',\n   *  enter: 'my-enter',\n   *  enterActive: 'my-active-enter',\n   *  enterDone: 'my-done-enter',\n   *  exit: 'my-exit',\n   *  exitActive: 'my-active-exit',\n   *  exitDone: 'my-done-exit',\n   * }}\n   * ```\n   *\n   * If you want to set these classes using CSS Modules:\n   *\n   * ```js\n   * import styles from './styles.css';\n   * ```\n   *\n   * you might want to use camelCase in your CSS file, that way could simply\n   * spread them instead of listing them one by one:\n   *\n   * ```js\n   * classNames={{ ...styles }}\n   * ```\n   *\n   * @type {string | {\n   *  appear?: string,\n   *  appearActive?: string,\n   *  appearDone?: string,\n   *  enter?: string,\n   *  enterActive?: string,\n   *  enterDone?: string,\n   *  exit?: string,\n   *  exitActive?: string,\n   *  exitDone?: string,\n   * }}\n   */\n  classNames: classNamesShape,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'enter' or 'appear' class is\n   * applied.\n   *\n   * **Note**: when `nodeRef` prop is passed, `node` is not passed.\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool)\n   */\n  onEnter: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'enter-active' or\n   * 'appear-active' class is applied.\n   *\n   * **Note**: when `nodeRef` prop is passed, `node` is not passed.\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool)\n   */\n  onEntering: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'enter' or\n   * 'appear' classes are **removed** and the `done` class is added to the DOM node.\n   *\n   * **Note**: when `nodeRef` prop is passed, `node` is not passed.\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool)\n   */\n  onEntered: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'exit' class is\n   * applied.\n   *\n   * **Note**: when `nodeRef` prop is passed, `node` is not passed\n   *\n   * @type Function(node: HtmlElement)\n   */\n  onExit: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'exit-active' is applied.\n   *\n   * **Note**: when `nodeRef` prop is passed, `node` is not passed\n   *\n   * @type Function(node: HtmlElement)\n   */\n  onExiting: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'exit' classes\n   * are **removed** and the `exit-done` class is added to the DOM node.\n   *\n   * **Note**: when `nodeRef` prop is passed, `node` is not passed\n   *\n   * @type Function(node: HtmlElement)\n   */\n  onExited: PropTypes.func\n}) : {};\nexport default CSSTransition;","import { useEffect, useRef } from 'react';\nexport default function usePrevious(state) {\n    var ref = useRef();\n    useEffect(function () {\n        ref.current = state;\n    });\n    return ref.current;\n}\n","//\n// Main\n//\n\nfunction memoize (fn, options) {\n  var cache = options && options.cache\n    ? options.cache\n    : cacheDefault\n\n  var serializer = options && options.serializer\n    ? options.serializer\n    : serializerDefault\n\n  var strategy = options && options.strategy\n    ? options.strategy\n    : strategyDefault\n\n  return strategy(fn, {\n    cache: cache,\n    serializer: serializer\n  })\n}\n\n//\n// Strategy\n//\n\nfunction isPrimitive (value) {\n  return value == null || typeof value === 'number' || typeof value === 'boolean' // || typeof value === \"string\" 'unsafe' primitive for our needs\n}\n\nfunction monadic (fn, cache, serializer, arg) {\n  var cacheKey = isPrimitive(arg) ? arg : serializer(arg)\n\n  var computedValue = cache.get(cacheKey)\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.call(this, arg)\n    cache.set(cacheKey, computedValue)\n  }\n\n  return computedValue\n}\n\nfunction variadic (fn, cache, serializer) {\n  var args = Array.prototype.slice.call(arguments, 3)\n  var cacheKey = serializer(args)\n\n  var computedValue = cache.get(cacheKey)\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.apply(this, args)\n    cache.set(cacheKey, computedValue)\n  }\n\n  return computedValue\n}\n\nfunction assemble (fn, context, strategy, cache, serialize) {\n  return strategy.bind(\n    context,\n    fn,\n    cache,\n    serialize\n  )\n}\n\nfunction strategyDefault (fn, options) {\n  var strategy = fn.length === 1 ? monadic : variadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\nfunction strategyVariadic (fn, options) {\n  var strategy = variadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\nfunction strategyMonadic (fn, options) {\n  var strategy = monadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\n//\n// Serializer\n//\n\nfunction serializerDefault () {\n  return JSON.stringify(arguments)\n}\n\n//\n// Cache\n//\n\nfunction ObjectWithoutPrototypeCache () {\n  this.cache = Object.create(null)\n}\n\nObjectWithoutPrototypeCache.prototype.has = function (key) {\n  return (key in this.cache)\n}\n\nObjectWithoutPrototypeCache.prototype.get = function (key) {\n  return this.cache[key]\n}\n\nObjectWithoutPrototypeCache.prototype.set = function (key, value) {\n  this.cache[key] = value\n}\n\nvar cacheDefault = {\n  create: function create () {\n    return new ObjectWithoutPrototypeCache()\n  }\n}\n\n//\n// API\n//\n\nmodule.exports = memoize\nmodule.exports.strategies = {\n  variadic: strategyVariadic,\n  monadic: strategyMonadic\n}\n"],"names":["callback","delay","savedCallback","useRef","useEffect","current","interval_1","setInterval","clearInterval","Time","timeInMs","className","humanize","formatTime","inSeconds","toFixed","duration","toDuration","hours","minutes","seconds","ElapsedTime","resetKey","elapsed","setElapsed","useState","useInterval","LiveLogs","PureComponent","constructor","props","super","React","event","isPaused","onPause","this","scrollTop","clientHeight","scrollHeight","currentTarget","logRowsToRender","rowsToRender","state","slice","logRows","nextProps","render","theme","timeZone","onResume","styles","logsRowsLive","css","typography","fontFamilyMonospace","bodySmall","fontSize","logsRowFade","colors","text","tinycolor","info","transparent","setAlpha","toString","logsRowsIndicator","h6","spacing","button","fullWidth","getStyles","logsRow","logsRowLocalTime","logsRowMessage","getLogRowStyles","onScroll","undefined","cx","ref","scrollContainerRef","map","row","dateTimeFormat","timeEpochMs","hasAnsi","LogMessageAnsi","value","raw","entry","uid","element","liveEndDiv","scrollTo","Button","variant","onClick","Icon","name","stopLive","size","type","LiveLogsWithTheme","withTheme2","metaContainer","secondary","metaItem","error","metaLabel","fontWeightMedium","metaValue","MetaInfoItem","memo","style","useStyles2","label","MetaInfoText","metaItems","item","index","LogsMetaRow","meta","dedupStrategy","dedupCount","showDetectedFields","clearDetectedFields","hasUnescapedContent","forceEscape","onEscapeNewlines","logsMetaItem","LogsDedupStrategy","push","kind","LogsMetaKind","some","r","length","MAX_CHARACTERS","renderMetaItem","Tooltip","content","placement","LogLabels","labels","LogsNavigationPages","pages","currentPageIndex","oldestLogsFirst","loading","changeTime","time","format","systemDateFormats","createPageContent","page","Spinner","logsRange","from","to","useTheme2","CustomScrollbar","autoHide","pagesWrapper","pagesContainer","queryRange","line","selectedBg","selectedText","displayName","background","primary","main","v1","sm","LogsNavigation","absoluteRange","logsSortOrder","onChangeTime","scrollToTopLogs","visibleRange","queries","clearCache","addResultsToCache","setPages","setCurrentPageIndex","expectedQueriesRef","expectedRangeRef","rangeSpanRef","LogsSortOrder","onFirstPage","onLastPage","newPage","newPages","isEqual","filter","sort","a","b","sortPages","findIndex","olderLogsButton","navButton","indexChange","disabled","navButtonContent","newerLogsButton","navContainer","scrollToTopButton","title","ExploreGraph","data","height","width","loadingState","annotations","onHiddenSeriesChanged","splitOpenFn","graphStyle","tooltipDisplayMode","TooltipDisplayMode","showAllTimeSeries","setShowAllTimeSeries","baseStructureRev","setBaseStructureRev","previousData","usePrevious","structureChangesRef","compareArrayValues","compareDataFrameStructures","structureRev","fieldConfig","setFieldConfig","defaults","color","mode","FieldColorModeId","custom","drawStyle","GraphDrawStyle","fillOpacity","pointSize","overrides","timeRange","dateTime","dataWithConfig","useMemo","registry","createFieldConfigRegistry","getGraphFieldConfig","defaultGraphConfig","styledFieldConfig","config","produce","draft","stacking","group","StackingMode","Error","applyGraphStyle","applyFieldOverrides","replaceVariables","fieldConfigRegistry","hiddenFrames","forEach","frame","fields","field","hideFrom","viz","every","identity","getFrameDisplayName","seriesToShow","panelContext","eventBus","appEvents","onSplitOpen","onToggleSeriesVisibility","seriesVisibilityConfigFactory","PanelContextProvider","timeSeriesDisclaimer","disclaimerIcon","PanelRenderer","series","pluginId","onChangeTimeRange","options","tooltip","legend","displayMode","LegendDisplayMode","calcs","warning","link","SETTINGS_KEYS","UnthemedLogs","createRef","showLabels","store","showTime","wrapLogMessage","prettifyLogMessage","hiddenLogLevels","isFlipping","setState","flipOrderTimer","window","setTimeout","prevState","cancelFlippingTimer","target","checked","hiddenRawLevels","level","LogLevel","preventDefault","onStartScanning","onStopScanning","key","indexOf","concat","k","memoizeOne","dedupedRows","dedupLogRows","reduce","sum","duplicates","filterLogLevels","Set","topLogsRef","scrollIntoView","componentWillUnmount","clearTimeout","logsMeta","logsSeries","onClickFilterLabel","onClickFilterOutLabel","scanning","scanRange","showContextToggle","getFieldLinks","logsQueries","hasData","checkUnescapedContent","filteredLogs","filterRows","dedupRows","scanText","rangeUtil","infoText","onToggleLogLevel","logOptions","InlineFieldRow","InlineField","InlineSwitch","onChange","id","onChangeLabels","onChangewrapLogMessage","onChangePrettifyLogMessage","RadioButtonGroup","Object","values","dedupType","capitalize","description","LogsDedupDescription","onChangeDedup","radioButtons","headerButton","onChangeLogsSortOrder","logsSection","LogRows","deduplicatedRows","getRowContext","enableLogDetails","onClickShowDetectedField","showDetectedField","onClickHideDetectedField","hideDetectedField","noData","fill","onClickScan","onClickStopScan","Logs","shape","borderRadius","border","medium","logsEnter","logsEnterActive","logsExit","logsExitActive","LogsCrossFadeTransition","visible","children","CSSTransition","in","mountOnEnter","unmountOnExit","timeout","transitionDuration","classNames","enter","enterActive","exit","exitActive","LiveTailControls","controls","exploreId","dispatch","useDispatch","pause","useCallback","setPausedStateAction","resume","stop","changeRefreshInterval","RefreshPicker","runQueries","start","useLiveTailControls","LogsContainer","updateTimeRange","async","datasourceInstance","hasLogsContextSupport","getLogRowContext","rowIndex","splitOpen","range","getFieldLinksForExplore","isLive","styleOverridesForStickyNavigation","Collapse","isOpen","mapDispatchToProps","connect","explore","logsResult","logsVolumeDataProvider","logsVolumeData","getTimeZone","user","rows","isSplit","Boolean","ExploreId","QueryRows","getQueries","getDatasourceInstanceSettings","getQueryResponse","getHistory","getEventBridge","exploreItemSelector","getExploreItemSelector","createSelector","s","queryResponse","history","eventBridge","getDatasourceSrv","getInstanceSettings","makeSelectors","useSelector","dsSettings","onRunQueries","newQueries","changeQueriesAction","onAddQuery","query","refId","getNextRefIdChar","QueryEditorRows","onQueriesChange","app","CoreApp","connector","loadingInState","tableResult","TableContainer","getTableHeight","Math","max","min","onCellFilterAdded","ariaLabel","tableWidth","PANEL_BORDER","dataFrame","v","getLinks","valueRowIndex","Table","stylesFactory","container","lg","input","switch","md","retentionPeriodOptions","RichHistorySettings","retentionPeriod","starredTabAsFirstTab","activeDatasourceOnly","onChangeRetentionPeriod","toggleStarredTabAsFirstTab","toggleactiveDatasourceOnly","deleteRichHistory","useTheme","selectedOption","find","Field","MAX_HISTORY_ITEMS","Select","menuShouldPortal","Switch","weight","bold","ShowConfirmModalEvent","yesText","icon","onConfirm","notifyApp","createSuccessNotification","changeDatasource","updateRichHistory","setQueries","isRemoved","rigtColumnWidth","rigtColumnContentWidth","cardColor","bg2","queryCard","border1","radius","palette","orange","cardRow","xs","base","datasourceContainer","semibold","queryActionButtons","queryContainer","queryRow","updateCommentContainer","comment","regular","commentButtonRow","textArea","runButton","dsImg","activeUpdateComment","setActiveUpdateComment","setComment","queryDsInstance","setQueryDsInstance","ds","getDataSourceSrv","get","datasourceName","getQueryDsInstance","onUpdateComment","ts","onCancelUpdateComment","updateComment","TextArea","placeholder","e","IconButton","queriesToCopy","q","createQueryText","join","copyStringToClipboard","createUrlFromRichHistory","createAndCopyShortLink","starred","iconType","onKeyDown","keyEvent","shiftKey","ctrlKey","src","i","queryText","queriesToRun","importQueries","bgColor","isLight","gray5","dark4","sliderHeight","containerContent","containerSlider","slider","selectors","filterInput","multiselect","xxs","sessionName","heading","h4","footer","light","RichHistoryQueriesTab","datasourceFilters","onSelectDatasourceFilters","onChangeSortOrder","sortOrder","timeFilter","setTimeFilter","setData","searchInput","setSearchInput","debouncedSearchInput","setDebouncedSearchInput","useDebounce","datasourcesRetrievedFromQueryHistory","uniqBy","d","listOfDatasources","createDatasourcesList","filterAndSortQueries","filteredQueries","mappedQueriesToHeadings","mapQueriesToHeadings","mapNumbertoTimeInSlider","RangeSlider","tooltipAlwaysVisible","orientation","formatTooltipResult","reverse","onAfterChange","MultiSelect","FilterInput","sortOrderOptions","order","keys","idx","imgUrl","RichHistoryStarredTab","starredQueries","Tabs","SortOrder","UnThemedRichHistory","RICH_HISTORY_SETTING_KEYS","console","updateFilters","activeDatasourceInstance","componentDidMount","componentDidUpdate","prevProps","richHistory","onClose","firstTab","tabs","RichHistory","Starred","Settings","toggleActiveDatasourceOnly","TabbedContainer","defaultTab","closeIconTooltip","withTheme","extendStatics","__extends","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","create","__assign","assign","t","n","arguments","apply","top","left","cursor","right","bottom","topRight","position","bottomRight","bottomLeft","topLeft","Resizer","_super","_this","onMouseDown","onResizeStart","direction","onTouchStart","userSelect","replaceStyles","DEFAULT_SIZE","clamp","snap","round","hasDirection","dir","RegExp","test","isTouchEvent","touches","findClosestSnap","snapArray","snapGap","closestGapIndex","prev","curr","abs","gap","endsWith","str","searchStr","substr","getStringSize","getPixelSize","parentSize","innerWidth","innerHeight","Number","replace","calculateNewMax","maxWidth","maxHeight","minWidth","minHeight","definedProps","baseClassName","Resizable","ratio","resizable","parentLeft","parentTop","resizableLeft","resizableRight","resizableTop","resizableBottom","targetLeft","targetTop","appendBase","parent","parentNode","document","createElement","transform","flex","classList","add","appendChild","removeBase","removeChild","c","isResizing","propsSize","original","x","y","backgroundStyle","backgroundColor","opacity","zIndex","flexBasis","bind","onMouseMove","onMouseUp","defineProperty","enumerable","configurable","ownerDocument","defaultView","defaultSize","orgWidth","offsetWidth","orgHeight","offsetHeight","orgPosition","getSize","getParentSize","wrapChanged","wrap","flexWrap","bindEvents","addEventListener","capture","passive","unbindEvents","removeEventListener","computedStyle","getComputedStyle","createSizeForCssProperty","newSize","calculateNewMaxFromBoundary","boundWidth","boundHeight","boundsByDirection","widthByDirection","heightByDirection","bounds","parent_1","isFinite","calculateNewSizeFromDirection","clientX","clientY","scale","resizeRatio","_a","_b","lockAspectRatio","lockAspectRatioExtraHeight","lockAspectRatioExtraWidth","newWidth","newHeight","extraHeight","extraWidth","calculateNewSizeFromAspectRatio","computedMinWidth","computedMaxWidth","computedMinHeight","computedMaxHeight","extraMinWidth","extraMaxWidth","extraMinHeight","extraMaxHeight","lockedMinWidth","lockedMaxWidth","lockedMinHeight","lockedMaxHeight","setBoundingClientRect","parent_2","parentRect","getBoundingClientRect","targetRect","top_1","nativeEvent","isMouseEvent","parent_3","flexDirection","flexDir","startsWith","TouchEvent","stopPropagation","_c","boundaryMax","grid","newGridWidth","newGridHeight","delta","newState","onResize","onResizeStop","updateSize","renderResizer","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","handleComponent","resizers","extendsProps","acc","sizeStyle","boxSizing","flexShrink","Wrapper","as","defaultProps","drawerSlide","keyframes","weak","shadows","z3","sidemenu","drawerActive","rzHandle","shade","ExploreDrawer","drawerWidth","setHeight","_e","_dir","dataFrames","statsTab","InspectStatsTab","request","timezone","jsonTab","InspectJSONTab","dataTab","InspectDataTab","isLoading","withTransforms","withFieldConfig","QueryInspector","onRefreshQuery","errorTab","InspectErrorTab","TimeSyncButton","isSynced","ToolbarButton","ExploreTimeControls","Component","getShiftedTimeRange","dateTimeForTimeZone","onMoveTimePicker","adjustedFrom","dateMath","adjustedTo","getZoomedTimeRange","fiscalYearStartMonth","splitted","syncedTimes","onChangeTimeSync","hideText","onChangeTimeZone","onChangeFiscalYearStartMonth","timeSyncButton","timePickerCommonProps","onMoveBackward","onMoveBack","onMoveForward","onZoom","TimePickerWithHistory","onChangeTimePicker","LiveTailButton","buttonVariant","onClickMain","ButtonGroup","iconOnly","stopButtonEnter","stopButtonEnterActive","stopButtonExit","stopButtonExitActive","RunButton","isSmall","onRun","onChangeRefreshInterval","refreshInterval","showDropdown","intervals","getTimeSrv","getValidIntervals","defaultIntervals","onIntervalChanged","onRefresh","noIntervalPicker","setDashboardQueriesToUpdateOnLoad","originPanelId","roles","canEdit","contextSrv","withOriginId","isInteger","cleanQueries","context","returnToPanel","withChanges","dash","getDashboardSrv","getCurrent","titleSlug","kbn","panelId","panelInEdit","editPanel","panelInView","viewPanel","locationService","urlUtil","ButtonSelect","UnConnectedExploreToolbar","cancelQueries","syncTimes","datasourceMissing","closeSplit","split","hasLiveOption","containerWidth","showSmallDataSourcePicker","showSmallTimePicker","PageToolbar","pageIcon","leftItems","DashNavButton","location","href","DataSourcePicker","onChangeDatasource","hideTextValue","ToolbarButtonRow","ReturnToDashboardButton","onRunQuery","SetInterval","func","interval","splitClose","updateTimeZoneForSession","updateFiscalYearStartMonthForSession","ExploreToolbar","exploreItem","streaming","getFiscalYearStartMonth","NoDataSourceCallToAction","canCreateDataSource","AccessControlAction","rel","ctaElement","LinkButton","cardClassName","breakpoints","CallToActionCard","callToActionElement","message","SecondaryActions","containerMargin","HorizontalGroup","addQueryRowButtonHidden","onClickAddQueryRowButton","addQueryRowButtonDisabled","richHistoryButtonActive","onClickRichHistoryButton","queryInspectorButtonActive","onClickQueryInspectorButton","warningText","NodeGraphContainer","withTraceView","useLinks","frames","nodes","useCategorizeFrames","open","toggleOpen","useToggle","countWarning","Badge","collapsible","onToggle","NodeGraph","FadeIn","defaultStyle","transition","transitionStyles","exited","display","entering","entered","exiting","Transition","onExited","ErrorContainer","queryError","showError","alertWithTopMargin","Alert","severity","ResponseErrorContainer","LoadingState","createSpanLinkFactory","traceToLogsOptions","f","links","span","dataFrameRowIndex","getTimeRangeFromSpan","datasourceUid","dataSourceSettings","dataLink","url","internal","expr","getLokiQueryFromSpan","mapInternalLinkToExplore","internalLink","scopedVars","startMs","spanStartTimeShift","endMs","spanEndTimeShift","onClickFn","getTemplateSrv","legacyCreateSpanLinkFactory","defaultKeys","tags","filterByTraceID","filterBySpanID","keysToCheck","process","tag","includes","traceID","spanID","timeShift","adjustedStartTime","floor","startTime","spanEndMs","adjustedEndTime","UIElements","Popover","overlayClassName","popoverRef","PopoverController","hideAfter","showPopper","hidePopper","popperProps","referenceElement","wrapperClassName","onMouseLeave","onMouseEnter","Dropdown","Menu","MenuItem","Divider","Input","InputGroup","isDark","shouldDisableCollapse","allSpans","hiddenSpansIds","hasChildren","makeDetailSubsectionToggle","subSection","detailStates","setDetailStates","old","detailState","toggleTags","toggleProcess","toggleWarnings","toggleReferences","toggleStackTraces","toggleLogs","newDetailStates","Map","set","noop","TraceView","expandOne","collapseOne","childrenToggle","collapseAll","childrenHiddenIDs","expandAll","setChildrenHiddenIDs","spans","prevExpandedDepth","expandNextHiddenSpan","newChildrenHiddenIDs","res","depth","has","delete","nearestCollapsedAncestor","curSpan","useChildrenState","toggleDetail","detailLogItemToggle","detailLogsToggle","detailProcessToggle","detailReferencesToggle","detailTagsToggle","detailWarningsToggle","detailStackTracesToggle","DetailState","log","toggleLogItem","useDetailState","removeHoverIndentGuideId","addHoverIndentGuideId","hoverIndentGuideIds","setHoverIndentGuideIds","newHoverIndentGuideIds","useHoverIndentGuide","viewRange","updateViewRangeTime","updateNextViewRangeTime","setViewRange","update","prevRange","end","useViewRange","spanNameColumnWidth","setSpanNameColumnWidth","slim","setSlim","traceProp","view","DataFrameView","processes","serviceName","serviceTags","toArray","processID","flags","references","parentSpanID","refType","logs","l","timestamp","transformTraceDataFrame","transformTraceData","transformDataFrames","search","setSearch","spanFindMatches","filterSpans","useSearch","dataSourceName","jsonData","tracesToLogs","traceTheme","ThemeType","servicesColorPalette","components","TraceName","traceTimeline","shouldScrollToFirstUiFindMatch","createSpanLink","onSlimViewClicked","canCollapse","clearSearch","focusUiFindMatches","hideMap","hideSummary","nextResult","onTraceGraphViewClicked","prevResult","resultCount","slimView","textFilter","trace","traceGraphView","searchValue","onSearchValueChange","hideSearchButtons","registerAccessors","scrollToFirstVisibleSpan","findMatchesIDs","focusSpan","createLinkToExternalSpan","clearShouldScrollToFirstUiFindMatch","detailToggle","setTrace","linksGetter","uiFind","scrollElement","TraceViewContainer","LogsVolumePanel","onUpdateTimeRange","onLoadLogsVolume","parseInt","LogsVolumePanelContent","statusText","zoomRatio","selectedTimeRange","dataRange","logsLevelZoomRatio","zoomLevelInfo","contentContainer","zoomInfoContainer","ALL_GRAPH_STYLE_OPTIONS","EXPLORE_GRAPH_STYLES","toUpperCase","justifyContent","ExploreGraphLabel","onChangeGraphStyle","Explore","rawRange","operator","FILTER_FOR_OPERATOR","FILTER_OUT_OPERATOR","onModifyQueries","queryKeys","addQueryRow","action","modifyQuery","modifier","modification","modifyQueries","changeSize","scanStart","scanStopAction","changeGraphStyle","openDrawer","preferredVisualisationType","renderEmptyState","renderGraphPanel","graphResult","renderLogsVolume","loadLogsVolumeData","renderTablePanel","renderLogsPanel","renderNodeGraphPanel","showTrace","getNodeGraphDataFrames","renderTraceViewPanel","showMetrics","showTable","showLogs","showNodeGraph","exploreMain","showPanels","showRichHistory","showQueryInspector","autoHeightMin","scrollRefCallback","toggleShowRichHistory","toggleShowQueryInspector","disableHeight","ErrorBoundaryAlert","compose","ExplorePaneContainerUnconnected","prevUrlQuery","urlQuery","lastSavedUrl","refreshExplore","el","exploreEvents","EventBusSrv","initialized","initialDatasource","initialQueries","initialRange","initializeExplore","removeAllListeners","cleanupPaneAction","exploreClass","getRef","ensureQueriesMemoized","ensureQueries","getTimeRangeFromUrlMemoized","getTimeRangeFromUrl","urlState","parseUrlState","datasource","urlRange","lastUsedDatasourceKeyForOrgId","orgId","getTimeRange","DEFAULT_RANGE","ExplorePaneContainer","resetExploreAction","richHistoryUpdatedAction","navModel","getNavModel","navIndex","exploreState","WrapperUnconnected","getRichHistory","queryParams","datasourceTitle","documentTitle","Branding","hasSplit","removeClass","node","classes","_React$Component","_len","args","_key","appliedClasses","appear","onEnter","maybeNode","maybeAppearing","_this$resolveArgument","resolveArguments","appearing","removeClasses","addClass","onEntering","_this$resolveArgument2","onEntered","_this$resolveArgument3","onExit","onExiting","nodeRef","getClassNames","isStringClassNames","activeClassName","doneClassName","_proto","phase","_addClass","_this$appliedClasses$","active","done","_this$props","propTypes","monadic","fn","cache","serializer","arg","cacheKey","computedValue","variadic","assemble","strategy","serialize","strategyDefault","serializerDefault","JSON","stringify","ObjectWithoutPrototypeCache","cacheDefault","module","exports","strategies"],"sourceRoot":""}